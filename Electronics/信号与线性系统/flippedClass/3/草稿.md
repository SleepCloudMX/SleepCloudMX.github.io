<h1 align="center">第三次翻转课堂草稿</h1>

$$
% 设置
\newcommand{\aneg}[1]{\hspace{-0.75em}&#1&\hspace{-0.75em}}
\newcommand{\aneq}{\aneg{=}}
% 上述指令用于在使用 array 环境时调整等号左右间距
\newcommand{\eqs}{\quad\;}
% 上述指令用于 align 环境中, &= 的换行对齐时调整第二行位置
\renewcommand{\d}{\displaystyle}

% 字符
\renewcommand{\i}{\mathrm{i}}
\renewcommand{\j}{\mathrm{j}}
\renewcommand{\k}{\mathrm{k}}
\newcommand{\e}{\textup{e}}
\newcommand{\ve}{\varepsilon}
\newcommand{\Beta}{\mathrm{B}}
\newcommand{\omicron}{\mathit{o}}
\newcommand{\Omicron}{\mathit{O}}

% 原本的定义为:
% \newcommand{\cal}[1]{\mathcal{#1}}
\newcommand{\bm}[1]{\boldsymbol{#1}}
\renewcommand{\cal}[1]{\mathcal#1}
\renewcommand{\scr}[1]{\mathscr#1}
\renewcommand{\frak}[1]{\mathfrak#1}
\newcommand{\bb}[1]{\mathbb#1}

% 数集
\newcommand{\D}{\mathbb{D}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\J}{\mathbb{J}}
\newcommand{\K}{\mathbb{K}}
\renewcommand{\L}{\mathbb{L}}

% 上下标
\newcommand{\trans}{^\mathrm{T}}
\newcommand{\inv}{^{-1}}
\newcommand{\madj}[1]{^{\pqty{#1^*}}}	% m 重伴随矩阵
\newcommand{\adj}{^*}
\newcommand{\vector}[1]{\overrightarrow{#1}}
\newcommand{\wavy}[1]{\overset\sim#1}	% \tilde 或 \widetilde 不明显, 容易与 \bar 或 \overline 混淆

% 序列
\newcommand{\ccdots}{\cdot\cdots\cdot}
\newcommand{\oneton}{1,2,\cdots,n}
\newcommand{\oneto}[1]{1,2,\cdots,#1}

\newcommand{\ssto}[3]{#1_1 #3 #1_2 #3 \cdots #3 #1_{#2}}
\newcommand{\ssup}[3]{#1^1 #3 #1^2 #3 \cdots #3 #1^{#2}}
\newcommand{\soneto}[2]{\ssto{#1}{#2}{,}}
\newcommand{\splus}[2]{\ssto{#1}{#2}{+}}

% 括号
\newcommand{\aqty}[1]{\expval{#1}}
\newcommand{\pbqty}[1]{\left(#1\right]}
\newcommand{\bpqty}[1]{\left[#1\right)}
\newcommand{\floor}[1]{\left\lfloor#1\right\rfloor}
\newcommand{\ceil}[1]{\left\lceil#1\right\rceil}

% 矩阵宏简写
\newcommand{\bmatrix}[1]{\begin{bmatrix}#1\end{bmatrix}}
\newcommand{\Bmatrix}[1]{\begin{Bmatrix}#1\end{Bmatrix}}
\newcommand{\vmatrix}[1]{\begin{vmatrix}#1\end{vmatrix}}
\newcommand{\Vmatrix}[1]{\begin{Vmatrix}#1\end{Vmatrix}}

% 常用微分
\newcommand{\dx}{\dd{x}}
\newcommand{\dy}{\dd{y}}
\newcommand{\dz}{\dd{z}}
\newcommand{\dt}{\dd{t}}
\newcommand{\ds}{\dd{s}}
\newcommand{\dr}{\dd{r}}

% 一般的微分
% 如果只使用 \dd{x}\dd{y} 的话, 中间会有多余的间隔.
\newcommand{\df}{\dd}
\newcommand{\ddf}[2]{\,\mathrm{d}#1\mathrm{d}#2}	% 微分形式 differential form
\newcommand{\dddf}[3]{\,\mathrm{d}#1\mathrm{d}#2\mathrm{d}#3}

% 高阶微分
\newcommand{\dxdy}{\ddf{x}{y}}
\newcommand{\dydz}{\ddf{y}{z}}
\newcommand{\dzdx}{\ddf{z}{x}}
\newcommand{\dudv}{\ddf{u}{v}}
\newcommand{\drdt}{\ddf{r}{\theta}}
\newcommand{\dxdydz}{\dddf{x}{y}{z}}

% 矩阵的宏指令
\newcommand{\pmcmn}[3]{\begin{pmatrix}
	#1_{11} & #1_{12} & \cdots & #1_{1#3} \\
	#1_{21} & #1_{22} & \cdots & #1_{n#3} \\
	\vdots & \vdots && \vdots \\
	#1_{#2 1} & #1_{#2 2} & \cdots & #2_{n#3} \\
\end{pmatrix}}

\newcommand{\pmc}[1]{\pmcmn{#1}{n}{n}}
\newcommand{\pvcn}[2]{\begin{pmatrix}
	#1_1 \\ #1_2 \\ \vdots \\ #1_{#2}
\end{pmatrix}}

\newcommand{\pvc}[1]{\pvcn{#1}{n}}
\newcommand{\pto}{\overset{P}{\to}}

% 函数名
\renewcommand{\char}{\operatorname{char}}	% 由于已存在此命令, 不可使用 DeclareMathOperator
\renewcommand{\r}{\operatorname{r}}
\DeclareMathOperator{\st}{s.t.\,}	% 虽然不是函数名, 但用了这个指令就放这儿了.
\DeclareMathOperator{\diag}{diag}	% 不需要定义太多, 一个文件里用到什么定义什么,
\DeclareMathOperator{\Ker}{Ker}		% 毕竟特殊的函数名太多太多了.
\DeclareMathOperator{\Aut}{Aut}		% 便捷与效率的权衡.
\DeclareMathOperator{\Inn}{Inn}
\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\SL}{SL}
\DeclareMathOperator{\stab}{stab}
\DeclareMathOperator{\orb}{orb}
\DeclareMathOperator{\lcm}{lcm}
\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator{\Cov}{Cov}
\DeclareMathOperator{\Corr}{Corr}
\DeclareMathOperator{\rot}{rot}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\Outer}{Outer}
\DeclareMathOperator{\Even}{Even}
\DeclareMathOperator{\Scalar}{Scalar}
\DeclareMathOperator{\Vector}{Vector}
\DeclareMathOperator{\arsh}{arsh}
\DeclareMathOperator{\arch}{arch}
\DeclareMathOperator{\arth}{arth}
\renewcommand{\Re}{\operatorname{Re}}	% 自带 \Re 的效果是 \mathrm{Re}, 前后无空格, 故重写
\renewcommand{\Im}{\operatorname{Im}}
\DeclareMathOperator{\Sa}{Sa}
\DeclareMathOperator{\Si}{Si}

% 运算符
% 可以用 \bigcap, \bigcup, \bigoplus, \bigotimes 替代
\newcommand{\capop}{\displaystyle\mathop\cap\limits}
\newcommand{\cupop}{\displaystyle\mathop\cup\limits}
\newcommand{\oplusop}{\mathop\oplus\limits}
\newcommand{\otimesop}{\mathop\otimes\limits}
\newcommand{\bigoplusop}{\mathop\bigoplus\limits}
\newcommand{\bigotimesop}{\mathop\bigotimes\limits}

% 积分
\newcommand{\dint}{\displaystyle\int}
\newcommand{\inti}{\dint_{-\infty}^{+\infty}}
\newcommand{\intoi}{\dint_0^{+\infty}}

\newcommand{\intl}{\displaystyle\int\limits}
\newcommand{\iintl}{\displaystyle\iint\limits}
\newcommand{\iiintl}{\displaystyle\iiint\limits}

% 求和
\newcommand{\dsum}{\displaystyle\sum}
\newcommand{\csum}[1]{\dsum_{#1=1}^\infty}
\newcommand{\nsum}{\csum{n}}
\newcommand{\ksum}{\csum{k}}
\newcommand{\nosum}{\dsum_{n=0}^\infty}
\newcommand{\insum}{\dsum_{i=1}^n}
\newcommand{\knsum}{\dsum_{k=1}^n}

% 求积
\newcommand{\dprod}{\displaystyle\prod}
\newcommand{\nprod}{\dprod_{n=1}^\infty}
\newcommand{\noprod}{\dprod_{n=0}^\infty}
\newcommand{\inprod}{\dprod_{i=1}^n}

% 极限
\newcommand{\liml}{\lim\limits}
\newcommand{\ulim}{\overline\lim\limits_{n\to\infty}}
\newcommand{\dlim}{\underline\lim\limits_{n\to\infty}}
% 注意这里的 d 是 down, 而不是 displaystyle

\newcommand{\xlim}{\lim\limits_{x\to x_0}}
\newcommand{\nlim}{\lim\limits_{n\to\infty}}
\newcommand{\clim}[1]{\lim\limits_{#1\to\infty}}

% 并集
\newcommand{\incup}{\bigcup_{i=1}^n}
\newcommand{\ncup}{\bigcup_{n=1}^\infty}
\newcommand{\icup}{\bigcup_{i=1}^\infty}

% 交集
\newcommand{\incap}{\bigcap_{i=1}^n}
\newcommand{\ncap}{\bigcap_{n=1}^\infty}
\newcommand{\icap}{\bigcap_{i=1}^\infty}

% 差分
\newcommand{\DD}{\Delta}
\newcommand{\DV}[2]{\dfrac{\DD#1}{\DD#2}}
\newcommand{\nDV}[3]{\dfrac{\DD^{#1}#2}{\DD#3^{#1}}}

% 求导
\newcommand{\ddv}{\displaystyle\dv}
\newcommand{\dpdv}{\displaystyle\pdv}

% 缩写
\newcommand{\LRA}{\Leftrightarrow}
\newcommand{\RLA}{\Leftrightarrow}
\newcommand{\LA}{\Leftarrow}
\newcommand{\RA}{\Rightarrow}

\newcommand{\lra}{\leftrightarrow}
\newcommand{\rla}{\leftrightarrow}
\newcommand{\la}{\leftarrow}
\newcommand{\ra}{\rightarrow}

\newcommand{\QRLA}{\quad\RLA\quad}
\newcommand{\QRA}{\quad\RA\quad}
\newcommand{\LLRA}{\Longleftrightarrow}

\newcommand{\QNRA}{\quad\nRightarrow\quad}
\newcommand{\qnra}{\quad\nrightarrow\quad}

\newcommand{\wt}{\widetilde}

% 图形符号
\newcommand{\qed}{\quad\square}
\renewcommand{\parallel}{\mathrel{/\mskip-2.5mu/}}
\newcommand{\paralleleq}{\hspace{0.5em}{^{^{\parallel}}}\hspace{-1.04em}=}
\newcommand{\rt}{\matrm{Rt}\triangle}

% 分块矩阵
\newenvironment{mat}[1]{
	\begin{array}{#1}
}{
	\end{array}
}

\newenvironment{pmat}[1]{
	\left( \begin{array}{#1}
}{
	\end{array} \right)
}

\newenvironment{bmat}[1]{
	\left[ \begin{array}{#1}
}{
	\end{array} \right]
}

\newenvironment{Bmat}[1]{
	\left\{ \begin{array}{#1}
}{
	\end{array} \right\}
}

\newenvironment{vmat}[1]{
	\left\lvert \begin{array}{#1}
}{
	\end{array} \right\rvert
}

\newenvironment{Vmat}[1]{
	\left\lVert \begin{array}{#1}
}{
	\end{array} \right\rVert
}
$$

#### 思考题

**（1） 为什么信号的通信速度和占有的频带宽度是互相矛盾的？**

由尺度变换, 若 $ f(t) \rla F(\omega) $, 则 $ \forall 0 \ne a \in \R $, 有
$$
f(at) \rla \dfrac{1}{\vqty{a}} F\pqty{\dfrac{\omega}{a}},
$$
以 $ a > 0 $ 为例.

一方面, 为了提高通信速度, 需要增加单位时间内传输的脉冲数, 因此需要压缩脉冲信号的宽度, 即增大上式中的 $a$.

另一方面, 为了减小占有的频带宽度, 需要增大 $ \dfrac{1}{a} $, 即减小 $ a $.

进一步, 可以参考 3b1b 的这期视频:

[【官方双语】直观看待不确定性原理：不只是量子现象哦_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1WW411x7BJ/?spm_id_from=333.999.0.0&vd_source=cc171ffacaec079f01b2a965fd3825f7).

**（2） 信号发生时移后，其频谱如何变化？**

若 $ f(t) \rla F(\omega) $, 则 $ f(t - t_0) \rla F(\omega) \e^{-\j\omega t_0} $.

即正向 (向右) 时移 $ t_0 $, 对应<u>频谱</u>在复平面上顺时针旋转 $ \omega t_0 $.

对于实信号, 将频谱密度函数改写为 $ F(\omega) = \vqty{F(\omega)} \e^{\j \varphi(\omega)} $, 于是
$$
f(t - t_0) \rla \vqty{F(\omega)} \e^{\j\pqty{\varphi(\omega) - \omega t_0}},
$$
即<u>幅度频谱</u>不变, <u>相位频谱</u>减小 $ \omega t_0 $.

**（3） 如何利用频移特性实现信号的频谱搬移？**

频谱搬移即将低频调制信号 $ f(t) $ 搬移到高频载波 $ \cos(\omega_0 t) $ 的频率附近.

调制信号 $ f(t) $ 可展开为傅里叶级数, 于是只需考虑正弦函数的情况.

为了实现正弦函数的调频, 可以用另一正弦函数与之相乘, 由积化和差即得.

由此思路, 我们只需要考虑 $ f(t) \cos(\omega_0 t) $ 和 $ f(t) \sin(\omega_0 t) $,

其中正弦可利用欧拉公式改写为指数形式, 从而由频移特性得到其频谱.

具体来说:

1. $ f(t) \cos \omega_0 t \rla \dfrac{1}{2} \bqty{
   	F(\omega + \omega_0) + F(\omega - \omega_0)
   } $.
2. $ f(t) \sin\omega_0 t \rla \dfrac{\j}{2} \bqty{
   	F(\omega + \omega_0) - F(\omega - \omega_0)
   } $.

**（4） 对信号进行微分运算后，其频谱如何变化？**

由实信号的微分性质: $ f'(t) \rla \j\omega F(\omega) $,

即频谱密度函数逆时针旋转 $ 90^\circ $ 后缩放为原来 $ \omega $ 倍.

上式又可表达为 $ f'(t) \rla \omega \vqty{F(\omega)} \e^{\j \pqty{\varphi(\omega) + \tfrac{\pi}{2}}} $,

于是低频分量幅度减小, 高频分量幅度增加, 并且相位增加 $ \dfrac{\pi}{2} $.

**（5）如何理解信号的时域卷积定理和频域卷积定理？**

时域卷积<u>同构于</u>频域乘法.

**证明**

1. 映射: $ \cal F \colon f(t) \mapsto F(\omega) $.
2. 一对一: $ \cal F[f(t)] = \cal F[g(t)] \RA f(t) = g(t) $.
3. 映上的: $ \forall F(\omega), \exist f(t) = \cal F\inv[F(\omega)](t) \colon \cal F[f(t)](\omega) = F(\omega) $.
4. O.P. 性: $ \cal F[f(t) \cdot g(t)](\omega) = \cal F[f(t)](\omega) * \cal F[g(t)](\omega) $.

证毕.

而频域卷积不同构于时域乘法, 但也可以用于化简运算.

多次应用对称性质, 频域卷积也只是时域卷积的推论.



#### 练习题

1. 由 $  f(at - b) \rla \dfrac{1}{\vqty{a}} F\pqty{\dfrac{\omega}{a}} \e^{-\j\omega\tfrac{b}{a}}  $, 得

$$
f(2t-5) \rla \dfrac{E\tau}{2} \Sa\pqty{\dfrac{\omega\tau}{4}} \e^{-\tfrac{5}{2}\j\omega}.
$$

2. 若图中信号为 $ f(t) = \Sa(\pi(t - 1)) $, 则由 $ \Sa(t) \rla \pi I_\Bqty{-1 < \omega < 1} $, 得

$$
\Sa(\pi(t-1)) \rla \e^{-\j\omega} I_\Bqty{-\pi < \omega < \pi}.
$$

3. 由频域卷积定理, $ f_1(t) f_2(t) \rla \dfrac{1}{2\pi} F_1(\omega) * F_2(\omega) $, 有

$$
\begin{align}
(t - 2) f(t) &\rla \dfrac{1}{2\pi} \cal F[t-2](\omega) * F(\omega)
\\
&= \dfrac{\e^{-2\j\omega}}{2\pi} \cal F[t](\omega) * F(\omega)
\\
&= \j\e^{-2\j\omega} \delta'(\omega) * F(\omega)
\\
&= \pqty{
	\j\delta'(\omega) - 2\delta(\omega)
} * F(\omega)
\\
&= \j F'(\omega) - 2 F(\omega).
\end{align}
$$

其中 $ t $ 的傅里叶变换, 由 $ 1 \rla 2\pi\delta(\omega) $ 和 $ t^n f(t) \rla \j^n F^{(n)}(\omega) $ 给出.

4. 由 $ G_\tau(t) \rla \tau \Sa\pqty{\dfrac{\omega\tau}{2}} $ 和积分性质 $ \dint_{-\infty}^t f(\tau) \dd{\tau} \rla \dfrac{F(\omega)}{\j\omega} + \pi F(0) \delta(\omega) $ 得

$$
\dint_{-\infty}^t G_\tau(t) \dt
\rla \dfrac{\tau}{\j\omega}
\Sa\pqty{\dfrac{\omega \tau}{2}} +
\pi\tau \delta(\omega).
$$

5. 由定义,

$$
\begin{align}
\cal F[f(t)](\omega)
&= \inti \delta'(t-1) \e^{-\j\omega t - 3(t-1)} \dt
\\
&= (\j\omega + 3) \e^{-\j\omega},
\end{align}
$$

题目中的符号是混乱邪恶的, 混乱体现在正斜体不分, 邪恶体现在定义不统一.

6. 记 $ f(t) \rla F(\omega) $, 则由频移与时移性质知

$$
\begin{align}
\e^{\j 4t} f(t-2)
&\rla F(\omega - 4) \e^{-\j 2(\omega - 4)}.
\end{align}
$$

7. 由对称性质, $ \dfrac{1}{\pi t} \rla -\j \sgn(\omega) $.

   由微分性质, $ f'(t) \rla \j\omega F(\omega) $.

   由卷积定理, $ y(t) \rla \omega \sgn(\omega) F(\omega) $.

8. 由 $ x''(t) = \delta'(t+2) + \delta(t+2) - 2\delta(t) + \delta(t-2) - \delta'(t-2) $, 得

$$
\cal F[x''(t)](\omega)
= \j\omega \e^{2\j\omega} + \e^{2\j\omega} - 2 +
\e^{-2\j\omega} - \j\omega \e^{-2\j\omega},
$$

于是由时域积分性质 (注意不是微分性质),
$$
\begin{align}
\cal F[x'(t)](\omega)
&= \e^{2\j\omega} - \e^{-2\j\omega} + \dfrac{
	\e^{2\j\omega} + \e^{-2\j\omega} - 2
}{\j\omega},
\\
\cal F[x(t)](\omega)
&= \dfrac{2}{\omega} \sin 2\omega + \dfrac{2\cos 2\omega - 2}{\j^2\omega^2}
\\
% &= \dfrac{2}{\omega} \sin 2\omega + \dfrac{4}{\omega^2} \sin^2 \omega \\
&= 4 \Sa\omega (\Sa\omega + \cos\omega)
\\
&= 4 \Sa^2\omega + 4 \Sa2\omega.
\end{align}
$$
随手化简, 没想到还挺简洁.



#### 上述练习题的代码

1. 注意到 $ f(t) = E G_\tau(t) = \dfrac{E}{2} \bqty{u\pqty{\dfrac{\tau}{2} - t} + u\pqty{\dfrac{\tau}{2} + t}} $,

```mathematica
(* 
注释中涉及的非代码语言, 仅供参考.

注意这里的 HeavisidePi[t] = I_{-1/2 < t < 1/2},
于是 G_\tau = HeavisidePi[t/\tau].

此外对于纯数学与系统工程中常用的傅里叶变换,
需要将傅里叶参数设置为 {1, -1}, 注意不要写成 {-1, 1} 或其它值.
参考: https://reference.wolfram.com/language/ref/FourierTransform?view=all#15513

这里的 Sinc[t] 即信号书中的 Sa(t), 而我们学的 Sinc[t] 被定义为 Sa(\pi t)
注意区分软件里的 Sinc 与书中的 Sinc.

最后, 注意软件里的 E 指自然常数, 因此不能以此为变量名.
不过系数不必考虑, 算出来之后再加上就好了.
*)

FourierTransform[
	HeavisidePi[(2 t - 5)/\[Tau]], t, \[Omega], 
	FourierParameters -> {1, -1},
	Assumptions -> \[Tau] > 0
]
(* 真不知道为什么计算量这么小的式子, mathematica 怎么算不出来... *)
```

2. 下述代码的结果中, 注意到 $ I_\Bqty{-\pi < \omega < \pi} = G_{2\pi}(t) = \dfrac{\sgn(\pi - \omega) + \sgn(\pi + \omega)}{2} $.

```mathematica
FourierTransform[
	Sinc[Pi (t - 1)], t, \[Omega], 
	FourierParameters -> {1, -1}
]
```

3. 我们只需要算 $ \cal F[t-2](\omega) $.

```mathematica
FourierTransform[
	t-2, t, \[Omega],
	FourierParameters -> {1, -1}
]
```

5. 计算 $ \cal F[f(t)](\omega) $.

```mathematica
FourierTransform[
	E^(-3 (t - 1)) DiracDelta'[t - 1], t, \[Omega], 
	FourierParameters -> {1, -1}
]
```

7. 用卷积定理后再用软件求解:

```mathematica
FourierTransform[
	1 / (Pi t), t, \[Omega], 
	FourierParameters -> {1, -1}
] FourierTransform[
	f'[t], t, \[Omega], 
	FourierParameters -> {1, -1}
]
```

8. 注意 `HeavisidePi[t]` 和 `HeavisideLambda[t]` 图像上的区别.

```mathematica
Plot[
	HeavisidePi[t/4] + 2 HeavisideLambda[t/2],
	{t, -2.5, 2.5}
]
FourierTransform[
	HeavisidePi[t/4] + 2 HeavisideLambda[t/2], t, \[Omega], 
	FourierParameters -> {1, -1}
]
```

