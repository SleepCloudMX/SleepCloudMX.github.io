<h1 align="center">第七次翻转课堂草稿</h1>

$$
% 设置
\newcommand{\aneg}[1]{\hspace{-0.75em}&#1&\hspace{-0.75em}}
\newcommand{\aneq}{\aneg{=}}
% 上述指令用于在使用 array 环境时调整等号左右间距
\newcommand{\noeq}{&\hspace{1.3em}}
% 上述指令用于 align 环境中, 类似与 &= 但不显示等号.
\renewcommand{\d}{\displaystyle}

% 字符
\renewcommand{\i}{\mathrm{i}}
\renewcommand{\j}{\mathrm{j}}
\renewcommand{\k}{\mathrm{k}}
\newcommand{\e}{\textup{e}}
\newcommand{\ve}{\varepsilon}
\newcommand{\Beta}{\mathrm{B}}
\newcommand{\omicron}{\mathit{o}}
\newcommand{\Omicron}{\mathrm{O}}

% 简写与重定义
\newcommand{\bm}[1]{\boldsymbol{#1}}
\renewcommand{\cal}[1]{\mathcal{#1}}
\renewcommand{\scr}[1]{\mathscr{#1}}
\renewcommand{\frak}[1]{\mathfrak{#1}}
\renewcommand{\rm}[1]{\mathrm{#1}}
\newcommand{\bb}[1]{\mathbb{#1}}

% 数集
\newcommand{\D}{\mathbb{D}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\J}{\mathbb{J}}
\newcommand{\K}{\mathbb{K}}
\renewcommand{\L}{\mathbb{L}}

% 上下标
\newcommand{\trans}{^\mathrm{T}}
\newcommand{\inv}{^{-1}}
\newcommand{\madj}[1]{^{\pqty{#1^*}}}	% m 重伴随矩阵
\newcommand{\adj}{^*}
\newcommand{\vector}[1]{\overrightarrow{#1}}
\newcommand{\wavy}[1]{\overset\sim#1}	% \tilde 或 \widetilde 不明显, 容易与 \bar 或 \overline 混淆

% 序列
\newcommand{\ccdots}{\cdot\cdots\cdot}
\newcommand{\oneton}{1,2,\cdots,n}
\newcommand{\oneto}[1]{1,2,\cdots,#1}

\newcommand{\ssto}[3]{#1_1 #3 #1_2 #3 \cdots #3 #1_{#2}}
\newcommand{\ssup}[3]{#1^1 #3 #1^2 #3 \cdots #3 #1^{#2}}
\newcommand{\soneto}[2]{\ssto{#1}{#2}{,}}
\newcommand{\splus}[2]{\ssto{#1}{#2}{+}}

% 括号
\newcommand{\aqty}[1]{\expval{#1}}
\newcommand{\pbqty}[1]{\left(#1\right]}
\newcommand{\bpqty}[1]{\left[#1\right)}
\newcommand{\floor}[1]{\left\lfloor#1\right\rfloor}
\newcommand{\ceil}[1]{\left\lceil#1\right\rceil}

% 矩阵宏简写
\newcommand{\bmatrix}[1]{\begin{bmatrix}#1\end{bmatrix}}
\newcommand{\Bmatrix}[1]{\begin{Bmatrix}#1\end{Bmatrix}}
\newcommand{\vmatrix}[1]{\begin{vmatrix}#1\end{vmatrix}}
\newcommand{\Vmatrix}[1]{\begin{Vmatrix}#1\end{Vmatrix}}

% 常用微分
\newcommand{\dx}{\dd{x}}
\newcommand{\dy}{\dd{y}}
\newcommand{\dz}{\dd{z}}
\newcommand{\dt}{\dd{t}}
\newcommand{\ds}{\dd{s}}
\newcommand{\dr}{\dd{r}}

% 一般的微分
% 如果只使用 \dd{x}\dd{y} 的话, 中间会有多余的间隔.
\newcommand{\df}{\dd}
\newcommand{\ddf}[2]{\,\mathrm{d}#1\mathrm{d}#2}	% 微分形式 differential form
\newcommand{\dddf}[3]{\,\mathrm{d}#1\mathrm{d}#2\mathrm{d}#3}

% 高阶微分
\newcommand{\dxdy}{\ddf{x}{y}}
\newcommand{\dydz}{\ddf{y}{z}}
\newcommand{\dzdx}{\ddf{z}{x}}
\newcommand{\dudv}{\ddf{u}{v}}
\newcommand{\drdt}{\ddf{r}{\theta}}
\newcommand{\dxdydz}{\dddf{x}{y}{z}}

% 矩阵的宏指令
\newcommand{\pmcmn}[3]{\begin{pmatrix}
	#1_{11} & #1_{12} & \cdots & #1_{1#3} \\
	#1_{21} & #1_{22} & \cdots & #1_{n#3} \\
	\vdots & \vdots && \vdots \\
	#1_{#2 1} & #1_{#2 2} & \cdots & #2_{n#3} \\
\end{pmatrix}}

\newcommand{\pmc}[1]{\pmcmn{#1}{n}{n}}
\newcommand{\pvcn}[2]{\begin{pmatrix}
	#1_1 \\ #1_2 \\ \vdots \\ #1_{#2}
\end{pmatrix}}

\newcommand{\pvc}[1]{\pvcn{#1}{n}}
\newcommand{\pto}{\overset{P}{\to}}

% 函数名
\renewcommand{\char}{\operatorname{char}}	% 由于已存在此命令, 不可使用 DeclareMathOperator
\renewcommand{\r}{\operatorname{r}}
\DeclareMathOperator{\st}{s.t.\,}	% 虽然不是函数名, 但用了这个指令就放这儿了.
\DeclareMathOperator{\diag}{diag}	% 不需要定义太多, 一个文件里用到什么定义什么,
\DeclareMathOperator{\Ker}{Ker}		% 毕竟特殊的函数名太多太多了.
\DeclareMathOperator{\Aut}{Aut}		% 便捷与效率的权衡.
\DeclareMathOperator{\Inn}{Inn}
\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\SL}{SL}
\DeclareMathOperator{\stab}{stab}
\DeclareMathOperator{\orb}{orb}
\DeclareMathOperator{\lcm}{lcm}
\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator{\Cov}{Cov}
\DeclareMathOperator{\Corr}{Corr}
\DeclareMathOperator{\rot}{rot}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\Outer}{Outer}
\DeclareMathOperator{\Even}{Even}
\DeclareMathOperator{\Scalar}{Scalar}
\DeclareMathOperator{\Vector}{Vector}
\DeclareMathOperator{\arsh}{arsh}
\DeclareMathOperator{\arch}{arch}
\DeclareMathOperator{\arth}{arth}
\renewcommand{\Re}{\operatorname{Re}}	% 自带 \Re 的效果是 \mathrm{Re}, 前后无空格, 故重写
\renewcommand{\Im}{\operatorname{Im}}
\DeclareMathOperator{\Sa}{Sa}
\DeclareMathOperator{\Si}{Si}

% 运算符
% 可以用 \bigcap, \bigcup, \bigoplus, \bigotimes 替代
\newcommand{\capop}{\displaystyle\mathop\cap\limits}
\newcommand{\cupop}{\displaystyle\mathop\cup\limits}
\newcommand{\oplusop}{\mathop\oplus\limits}
\newcommand{\otimesop}{\mathop\otimes\limits}
\newcommand{\bigoplusop}{\mathop\bigoplus\limits}
\newcommand{\bigotimesop}{\mathop\bigotimes\limits}

% 积分
\newcommand{\dint}{\displaystyle\int}
\newcommand{\inti}{\dint_{-\infty}^{+\infty}}
\newcommand{\intoi}{\dint_0^{+\infty}}

\newcommand{\intl}{\displaystyle\int\limits}
\newcommand{\iintl}{\displaystyle\iint\limits}
\newcommand{\iiintl}{\displaystyle\iiint\limits}

% 求和
\newcommand{\dsum}{\displaystyle\sum}
\newcommand{\csum}[1]{\dsum_{#1=1}^\infty}
\newcommand{\nsum}{\csum{n}}
\newcommand{\ksum}{\csum{k}}
\newcommand{\nosum}{\dsum_{n=0}^\infty}
\newcommand{\insum}{\dsum_{i=1}^n}
\newcommand{\knsum}{\dsum_{k=1}^n}
\newcommand{\csuminf}[1]{\dsum_{#1=-\infty}^{+\infty}}
\newcommand{\nsuminf}{\csuminf{n}}

% 求积
\newcommand{\dprod}{\displaystyle\prod}
\newcommand{\nprod}{\dprod_{n=1}^\infty}
\newcommand{\noprod}{\dprod_{n=0}^\infty}
\newcommand{\inprod}{\dprod_{i=1}^n}

% 极限
\newcommand{\liml}{\lim\limits}
\newcommand{\ulim}{\overline\lim\limits_{n\to\infty}}
\newcommand{\dlim}{\underline\lim\limits_{n\to\infty}}
% 注意这里的 d 是 down, 而不是 displaystyle

\newcommand{\xlim}{\lim\limits_{x\to x_0}}
\newcommand{\nlim}{\lim\limits_{n\to\infty}}
\newcommand{\clim}[1]{\lim\limits_{#1\to\infty}}

% 并集
\newcommand{\incup}{\bigcup_{i=1}^n}
\newcommand{\ncup}{\bigcup_{n=1}^\infty}
\newcommand{\icup}{\bigcup_{i=1}^\infty}

% 交集
\newcommand{\incap}{\bigcap_{i=1}^n}
\newcommand{\ncap}{\bigcap_{n=1}^\infty}
\newcommand{\icap}{\bigcap_{i=1}^\infty}

% 差分
\newcommand{\DD}{\Delta}
\newcommand{\DV}[2]{\dfrac{\DD#1}{\DD#2}}
\newcommand{\nDV}[3]{\dfrac{\DD^{#1}#2}{\DD#3^{#1}}}

% 求导
\newcommand{\ddv}{\displaystyle\dv}
\newcommand{\dpdv}{\displaystyle\pdv}

% 最值 (返回参数); 暂时先这么凑合着用吧
\newcommand{\argmax}[1]{\underset{#1}{\operatorname{argmax}}}
\newcommand{\argmin}[1]{\underset{#1}{\operatorname{argmin}}}

% 缩写
\newcommand{\LRA}{\Leftrightarrow}
\newcommand{\RLA}{\Leftrightarrow}
\newcommand{\LA}{\Leftarrow}
\newcommand{\RA}{\Rightarrow}

\newcommand{\lra}{\leftrightarrow}
\newcommand{\rla}{\leftrightarrow}
\newcommand{\la}{\leftarrow}
\newcommand{\ra}{\rightarrow}

\newcommand{\QRLA}{\quad\RLA\quad}
\newcommand{\QRA}{\quad\RA\quad}
\newcommand{\LLRA}{\Longleftrightarrow}

\newcommand{\QNRA}{\quad\nRightarrow\quad}
\newcommand{\qnra}{\quad\nrightarrow\quad}

\newcommand{\wt}{\widetilde}

% 图形符号
\newcommand{\qed}{\quad\square}
\renewcommand{\parallel}{\mathrel{/\mskip-2.5mu/}}
\newcommand{\paralleleq}{\hspace{0.5em}{^{^{\parallel}}}\hspace{-1.04em}=}
\newcommand{\rt}{\matrm{Rt}\triangle}

% 分块矩阵
\newenvironment{mat}[1]{
	\begin{array}{#1}
}{
	\end{array}
}

\newenvironment{pmat}[1]{
	\left( \begin{array}{#1}
}{
	\end{array} \right)
}

\newenvironment{bmat}[1]{
	\left[ \begin{array}{#1}
}{
	\end{array} \right]
}

\newenvironment{Bmat}[1]{
	\left\{ \begin{array}{#1}
}{
	\end{array} \right\}
}

\newenvironment{vmat}[1]{
	\left\lvert \begin{array}{#1}
}{
	\end{array} \right\rvert
}

\newenvironment{Vmat}[1]{
	\left\lVert \begin{array}{#1}
}{
	\end{array} \right\rVert
}

% 积分变换
\newcommand{\ft}{\overset{\cal F}{\rla}}
\newcommand{\lt}{\overset{\cal L}{\rla}}
\newcommand{\bt}{\overset{\cal B}{\rla}}
\newcommand{\zt}{\overset{\cal Z}{\rla}}
\newcommand{\bzt}{\overset{\cal Z_B}{\rla}}
\newcommand{\lzt}{\overset{\cal Z_L}{\rla}}
\newcommand{\rzt}{\overset{\cal Z_R}{\rla}}
$$

[TOC]

### 1  思考题

#### 1.1  单边 z 变换和双边 z 变换都是如何定义的？z 和 s 的关系是什么？

- z 变换的引入、z 和 s 的关系
  - $ f_\text s(t) = f(t) \delta_T(t) = \nsuminf f(nT) \delta(t - n_T) $.
  - $ F_\text s(s) = \inti \nsuminf f(nT) \delta(t - nT) \e^{-st} \dt = \nsuminf f(nT) \e^{-snT} $.
  - 令 $ z = \e^{sT} $，于是有 $ F(z) := F_\text s(s) = \nsuminf f(nT) z^{-n} $.
- 单边 z 变换
  - 右边 z 变换：$ \cal Z\bqty{f(n)} = \cal Z_R\bqty{f(n)} = \nosum f(n) z^{-n} $.
  - 左边 z 变换：$ \cal Z_L\bqty{f(n)} = \dsum_{n=-\infty}^{-1} f(n) z^{-n} = \nsum f(-n) z^n $.
- 双边 z 变换
  - $ F(z) = \cal Z_B \bqty{f(n)} = \nsuminf f(n) z^{-n} $.
  - $ \cal Z_B\bqty{f(n)} = \cal Z\bqty{f(n)} + \cal Z_L\bqty{f(n)} $.



#### 1.2  收敛域是如何定义的？对应于不同的序列，z 变换的收敛域有哪几种情况？

使 z 变换的级数收敛的点集称为收敛域（region of convergence, ROC）

- 无限长右边序列（因果序列）
  - $ a^n u(n) \bzt \dfrac{z}{z - a} $.
  - $ \rm{ROC} \colon \vqty{z} > \vqty{a} $.
- 无限长左边序列（反因果序列）
  - $ -a^n u(-n - 1) \bzt \dfrac{z}{z - a} $.
  - $ \rm{ROC} \colon \vqty{z} < \vqty{a} $.
- 无限长双边序列
  - $ a^n u(n) - b^n u(-n-1) \bzt \dfrac{z (a - b)}{(z - a) (z - b)} $.
  - $ \rm{ROC} \colon \vqty{a} < \vqty{z} < \vqty{b} $.
- 有限长序列
  - $ f(n) \bzt \dsum_{n=n_1}^{n_2} f(n) z^{-n} $.
  - $ \rm{ROC} \colon \begin{cases}
    	0 < \vqty{z} < \infty, & n_1 < 0 < n_2, \\
    	\vqty{z} > 0, & 0 \le n_1 < n_2, \\
    	\vqty{z} < \infty, & n_1 < n_2 \le 0.
    \end{cases} $ 



#### 1.3  给出几种典型序列的 z 变换。

1. 常用的离散序列

|   序列 $ f(n) $    |               z 变换 $ F(z) $               |          收敛域          |   参数说明   |
| :----------------: | :-----------------------------------------: | :----------------------: | :----------: |
|   $ \delta(n) $    |                    $ 1 $                    |          $ \C $          |              |
|      $ u(n) $      |            $ \dfrac{z}{z - 1} $             |     $ \vqty{z} < 1 $     |              |
|    $ a^n u(n) $    |            $ \dfrac{z}{z - a} $             | $ \vqty{z} > \vqty{a} $  | $ a \in \C $ |
|  $ n \cdot u(n) $  |          $ \dfrac{z}{(z - 1)^2} $           |     $ \vqty{z} < 1 $     |              |
| $ n^2 \cdot u(n) $ |      $ \dfrac{z (z + 1)}{(z - 1)^3} $       |     $ \vqty{z} < 1 $     |              |
|   $ a^\vqty{n} $   | $ \dfrac{z}{z - a} + \dfrac{a}{z\inv - a} $ | $ a < \vqty{z} < a\inv $ |  $ a < 1 $   |

2. 三角与双曲三角

|       序列 $ f(n) $        |                       z 变换 $ F(z) $                        |      收敛域      |      参数说明       |
| :------------------------: | :----------------------------------------------------------: | :--------------: | :-----------------: |
| $ \cos(\omega_0 n) u(n) $  | $ \dfrac{z (z - \cos\omega_0)}{z^2 - 2z \cos\omega_0 + 1} $  | $ \vqty{z} > 1 $ | $ \omega_0 \in \R $ |
| $ \sin(\omega_0 n) u(n) $  |    $ \dfrac{z \sin\omega_0}{z^2 - 2z \cos\omega_0 + 1} $     | $ \vqty{z} > 1 $ | $ \omega_0 \in \R $ |
| $ \cosh(\omega_0 n) u(n) $ | $ \dfrac{z (z - \cosh\omega_0)}{z^2 - 2z \cosh\omega_0 + 1} $ | $ \vqty{z} > 1 $ | $ \omega_0 \in \R $ |
| $ \sinh(\omega_0 n) u(n) $ |   $ \dfrac{z \sinh\omega_0}{z^2 - 2z \cosh\omega_0 + 1} $    | $ \vqty{z} > 1 $ | $ \omega_0 \in \R $ |
|                            |                                                              |                  |                     |

3. 逆变换常用公式（当 $ \vqty{z} > \vqty{a} $ 时）

$$
\begin{array}{rclrcl}
\dfrac{z}{z - a} \aneg\zt a^n u(n), &\hspace{3em}
\dfrac{1}{z - a} \aneg\zt a^{n-1} u(n-1), \\
\dfrac{z}{(z - a)^2} \aneg\zt a^{n-1} n \cdot u(n), &
\dfrac{1}{(z - a)^2} \aneg\zt a^{n-2} (n-1) u(n-1), \\
\dfrac{z}{(z - a)^{k+1}} \aneg\zt a^{n-k} \dbinom{n}{k} u(n), &
\dfrac{1}{(z - a)^k} \aneg\zt a^{n-k} \dbinom{n-1}{k-1} u(n - 1) \\
\\
\pqty{\dfrac{z}{z - a}}^k \aneg\zt a^{n} \dfrac{(n+k)_{(k)}}{n!} u(n), &
\pqty{\dfrac{z+a}{z}}^k \aneg\zt a^n \dbinom{k}{n} u(n-k).
\end{array}
$$



#### 1.4  z 变换有哪些基本性质？

**性质 1 (线性性质)**	若 $ f_1(t) \zt F_1(z), f_2(t) \zt F_2(z) $，则对于 $ \forall k_1, k_2 \in \C $，有
$$
k_1 f_1(t) + k_2 f_2(t) \zt k_1 F_1(z) + k_2 F_2(z).
$$
**备注**	

- 该性质对于双边、左边、右边 z 变换都是成立的.
- 叠加后的收敛域一般为原收敛域的重叠部分；当零极点相消时，收敛域也可能扩大.

---

**性质 2.1 (双边位移性质)**	若 $ f(n) \bzt F(z) $，则对于 $ \forall m \in \Z $，有
$$
f(n - m) \bzt z^{-m} F(z).
$$
**双边性质推论**	若因果序列 $ f(n) \bzt F(z) $，则对于 $ \forall m \in \N $，有
$$
f(n - m) = f(n - m) u(n - m) \zt z^{-m} F(z).
$$
**性质 2.2 (单边位移性质)**	若 $ f(n) u(n) \zt F(z) $，则

1. $ f(n + 1) u(n) \zt z \bqty{F(z) - f(0)} $.
2. $ f(n - 1) u(n) \zt z\inv F(z) + f(-1) $.

**推论 1**	若 $ f(n) u(n) \zt F(z) $，则对于 $ \forall m \in \N $，有

1. $ f(n + m) u(n) \zt z^m F(z) - \dsum_{k=0}^{m-1} f(k) z^{m-k} $.
2. $ f(n - m) u(n) \zt z^{-m} F(z) + \dsum_{k=0}^{m-1} f(k - m) z^{-k} $.
3. $ f(n - m) u(n) \zt z^{-m} F(z) + \dsum_{k=-m}^{-1} f(k) z^{-m-k} $.
4. $ f(n - m) u(n) \zt z^{-m} F(z) + \dsum_{k=1}^{m} f(-k) z^{-(m-k)} $.

**推论 2**	对于因果序列 $ f(n) $ 和 $ \forall m \in \N $，有 $ f(n - m) u(n) \zt \dfrac{F(z)}{z^m} $.

**例子**

1. $ f(n + 2) u(n) \zt z^2 F(z) - z^2 f(0) - z f(1) $.
2. $ f(n-2) u(n) \zt z^{-2} F(z) + z\inv f(-1) + f(-2) $.

---

**性质 3 (尺度性质 / 序列指数加权)**	若 $ f(n) \zt F(z) $，则对于 $ \forall a \ne 0 $，有
$$
a^n f(n) \zt F\pqty{\dfrac{z}{a}}.
$$
**备注**	该性质对于双边、左边、右边 z 变换均成立.

**推论**	

1. $ a^{-n} f(n) \zt F(az) $.
2. $ (-1)^n f(n) \zt F(-z) $.

---

**性质 4 (微分性质 / 序列线性加权)**	若 $ f(n) \zt F(z) $，则
$$
n f(n) \zt -z \dv{z} F(z).
$$
**备注**	该性质对于双边、左边、右边 z 变换均成立.

---

**性质 5.1 (时域卷积)**	若 $ f_1(n) \zt F_1(z), f_2(n) \zt F_2(z) $，则
$$
f_1(n) * f_2(n) \zt F_1(z) \cdot F_2(z).
$$
**备注**	该性质对于双边、左边、右边 z 变换均成立.

**性质 5.2 (频域卷积)**	若 $ f_1(n) \zt F_1(z), f_2(n) \zt F_2(z) $，则
$$
\begin{align}
f_1(n) f_2(n) &\zt \dfrac{1}{2\pi\j}
\oint_{C_1} F_1\pqty{\dfrac{z}{v}} F_2(v) \dfrac{\dd{v}}{v} \\
&= \dfrac{1}{2\pi\j}
\oint_{C_2} F_1(v) F_1\pqty{\dfrac{z}{v}} \dfrac{\dd{v}}{v}. \\
\end{align}
$$
其中 $ C_1 $ 为 $ F_1\pqty{\dfrac{z}{v}} $ 和 $ F_2(v) $ 收敛域重叠部分内逆时针旋转的围线.

---

**性质 6 (特值定理)**	设因果序列 $ f(n) \zt F(z) $ 且满足 $ f(\infty) $ 收敛，则

1. 初值定理：$ f(0) = \clim z F(z) $.
2. 终值定理：$ f(\infty) = \liml_{z \to 1} (z - 1) F(z) $.

**备注**

- 此外还有 $ \nlim \dfrac{1}{n} \knsum f(k) = f(\infty) $，证明见[随机过程笔记定理 3.3.6 的引理](https://sleepcloudmx.github.io/Math/概统/随机过程/c3-马尔科夫链.html#337--平均回转时间).
- 终值定理连同上述等式为实分析中的结果，由 Hardy 与 Littlewood 给出.
- 终值定理的另一种形式，可用于证明[马尔科夫链笔记中的定理 3.3.5](https://sleepcloudmx.github.io/Math/概统/随机过程/c3-马尔科夫链.html#336--平均到达时间).



#### 1.5  可以利用 z 变换的哪一种性质求解差分方程？

求解零状态系统的差分方程可分为两步：

1. 求解单位样值响应：利用线性性质和时移性质；
2. 求解零状态响应：利用时域卷积定理.

此外也可直接对差分方程两边作 z 变换，于是只需要用到时移性质.

而在求解序列的 z 变换时，可能还会用到其它性质辅助求解.



#### 1.6  序列指数加权和序列线性加权分别是指什么？

见问题四，这里简述如下：

1. 序列指数加权：即尺度性质，$ a^n f(n) \zt F\pqty{\dfrac{z}{a}} $.
2. 序列线性加权：即微分性质，$ n f(n) \zt -z \ddv{z} F(z) $.



#### 1.7  简述 z 变换的初值定理和终值定理？

设因果序列 $ f(n) \zt F(z) $ 且满足 $ f(\infty) $ 收敛，则

1. 初值定理：$ f(0) = \clim z F(z) $.
2. 终值定理：$ f(\infty) = \liml_{z \to 1} (z - 1) F(z) $.



#### 1.8  终值定理的应用条件是什么？

要求 $ f(\infty) $ 收敛.



### 2  练习题

#### 2.1

这里不使用结论，而从定义出发，在推导的过程中得出收敛域：
$$
f(n) \zt \sum_{n=0}^{+\infty} \dfrac{1}{(3z)^n} = \dfrac{3z}{3z - 1},
\quad \rm{ROC}\colon \vqty{z} > \dfrac{1}{3}.
$$

---

#### 2.2

同上：
$$
f(n) \zt \dsum_{n=-\infty}^{-1} \pqty{\dfrac{z}{2}}^{-n} = \dfrac{z}{2-z},
\quad \rm{ROC} \colon \vqty{z} < 2.
$$

---

#### 2.3

即 2.1 和 2.2 的交集：
$$
\begin{align}
x(n) &\zt \dsum_{n=0}^{+\infty} \dfrac{1}{(3z)^n} +
\dsum_{n=-\infty}^{-1} \pqty{\dfrac{z}{2}}^n
\\
&= \dfrac{3z}{3z - 1} + \dfrac{z}{2 - z},
\quad \rm{ROC} \colon \dfrac{1}{3} < \vqty{z} < 2.
\end{align}
$$

---

#### 2.4

先推导指数序列的 z 变换及其收敛域：
$$
\begin{array}{rcll}
a^n u(n) \aneg\zt \nosum \pqty{\dfrac{a}{z}}^n = \dfrac{z}{z - a},
\quad \rm{ROC}\colon \vqty{z} > \vqty{a},
\\
\cos(\omega_0 n) u(n) \aneq \dfrac{\e^{\j\omega_0 n} + \e^{-\j\omega_0 n}}{2}
\zt \dfrac{1}{2} \pqty{
	\dfrac{z}{z - \e^{\j\omega_0}} + \dfrac{z}{z - \e^{-\j\omega_0}}
} \\
\aneq \dfrac{z (z - \cos\omega_0)}{z^2 - 2z \cos\omega_0 + 1},
\quad \rm{ROC} \colon \vqty{z} > 1,
\\
\sin(\omega_0 n) u(n) \aneq \dfrac{\e^{\j\omega_0 n} - \e^{-\j\omega_0 n}}{2}
\zt \dfrac{1}{2} \pqty{
	\dfrac{z}{z - \e^{\j\omega_0}} - \dfrac{z}{z - \e^{-\j\omega_0}}
} \\
\aneq \dfrac{z \sin\omega_0}{z^2 - 2z \cos\omega_0 + 1},
\quad \rm{ROC} \colon \vqty{z} > 1.
\end{array}
$$

---

#### 2.5

由尺度性质（序列指数加权），$ a^n f(n) \zt F\pqty{\dfrac{z}{a}} $，有
$$
\begin{align}
\beta^n \cos(n \omega_0) u(n)
&\zt \dfrac{z (z - \beta \cos\omega_0)}{
	z^2 - 2\beta z \cos\omega_0 + \beta^2
}, \quad \rm{ROC} \colon \vqty{z} > \vqty{\beta},
\\
\beta^n \sin(n \omega_0) u(n)
&\zt \dfrac{\beta z \sin \omega_0}{
	z^2 - 2\beta z \cos\omega_0 + \beta^2
}, \quad \rm{ROC} \colon \vqty{z} > \vqty{\beta}.
\end{align}
$$

---

#### 2.6

思路一：已知 $ a^n u(n) \zt \dfrac{z}{z - a}, \vqty{z} > \vqty{a} $（等比数列求和公式）

由微分性质（序列线性加权），$ n f(n) \zt -z \ddv{z} F(z) $，有
$$
n a^n u(n) \zt \dfrac{az}{(z - a)^2},
\quad \rm{ROC} \colon \vqty{z} > \vqty{a}.
$$
思路二：已知 $ n \cdot u(n) \zt \dfrac{z}{(z - 1)^2}, \vqty{z} > 1 $（差比数列求和公式；或者使用幂级数逐项求导法）

由尺度性质（序列指数加权），$ a^n f(n) \zt F\pqty{\dfrac{z}{a}} $，有
$$
n a^n u(n) \zt \dfrac{az}{(z - a)^2},
\quad \rm{ROC} \colon \vqty{z} > \vqty{a}.
$$

---

#### 2.7

思路一：部分分式展开后计算 z 逆变换（计算量大，根式繁多）

思路二：利用 z 变换定义和幂级数展开（求导法）

思路三：利用 z 变换定义和幂级数展开（长除法）

这里使用计算量最小的思路三，并假定 $ x(n) $ 为因果序列，于是由长除法得到 $ x(0) = 0, x(1) = 1 $.



### 3  代码

#### 3.1.3

```mathematica
flist = {
	{UnitStep[n], n, z},
	{E^(-\[Alpha] n), n, z},
	{Sin[\[Alpha] n], n, z},
	{n^3 + 3 n + 1, n, z},
	{n^k, n, z},
	{ChebyshevU[n, x], n, z},
	{a^n Cos[Pi n], n, z},
	{(m + 1) (n - m), {m, n}, {u, v}},
	{a^n m^3, {m, n}, {u, v}}
};
Grid[
	Join[
		{{f, Text["Z-Transform"]}},
		Transpose[{
			flist[[;; , 1]],
			Map[ZTransform @@ # &, flist]
		}]
	], 
	Background -> {
		None, {{None, GrayLevel[.9]}}, {
			{1, 1} -> Hue[.6, .4, 1],
			{1, 2} -> Hue[.6, .4, 1]
		}
	},
	BaseStyle -> {FontFamily -> Times, FontSize -> 12},
	Dividers -> All,
	FrameStyle -> Hue[.6, .4, .8], 
	Spacings -> {2, 1}
] // TraditionalForm
```

$$
\begin{array}{|c|c|}
\hline
 f & \text{Z-Transform} \\
\hline
 \theta (n) & \frac{z}{z-1} \\
\hline
 e^{\alpha  (-n)} & \frac{e^{\alpha } z}{e^{\alpha } z-1} \\
\hline
 \sin  (\alpha  n) & \frac{z (\alpha  \sin )}{z^2-2 z (\alpha  \cos )+1} \\
\hline
 n^3+3 n+1 & \frac{z \left(z^3+z^2+z+3\right)}{(z-1)^4} \\
\hline
 n^k & \Phi \left(\frac{1}{z},-k,0\right) \\
\hline
 U_n(x) & \frac{z^2}{-2 x z+z^2+1} \\
\hline
 a^n ((\pi  n) \cos ) & \frac{z}{a+z} \\
\hline
 (m+1) (n-m) & \frac{u^3 v-2 u^2 v^2+u^2 v}{(u-1)^3 (v-1)^2} \\
\hline
 m^3 a^n & \frac{u \left(u^2+4 u+1\right) v}{(u-1)^4 (v-a)} \\
\hline
\end{array}
$$

---

#### 3.2.1

```mathematica
(* 求解 z 变换及其收敛域 *)
X[z_] := ZTransform[3^-n UnitStep[n], n, z, GenerateConditions -> True]
(* 绘制收敛域的图像 *)
With[{z = u + I v}, RegionPlot[Abs[z] > 1/3, {u, -1, 1}, {v, -1, 1}]]
(* 绘制函数的幅角图 *)
ComplexPlot[X[z], {z, -1 - I, 1 + I}, ImageSize -> Small]
```

$$
\fbox{$\frac{3 z}{3 z-1}\text{ if }| z| >\frac{1}{3}$}
$$

<center class="half">
	<img src='image\3.2.1.1.png' width=250 />&emsp;&emsp;&emsp;
	<img src='image\3.2.1.2.png' width=250 />
</center>

---

#### 3.2.2

```mathematica
(* 定义序列 *)
x[n_] := Which[
	n >= 0, 0,
	n < 0, 2^n
]
(* 求解 z 变换 *)
X[z_] := BilateralZTransform[
	x[n], n, z,
	GenerateConditions -> True
]
(* 绘制收敛域的图像 *)
With[
	{z = u + I v}, RegionPlot[Abs[z] < 2,
	{u, -3, 3}, {v, -3, 3}]
]
(* 绘制函数的幅角图 *)
ComplexPlot[X[z], {z, -1 - I, 1 + I}, ImageSize -> Small]
```

$$
\fbox{$-\frac{z}{z-2}\text{ if }| z| <2$}
$$

<center class="half">
	<img src='image\3.2.2.1.png' width=250 />&emsp;&emsp;&emsp;
	<img src='image\3.2.2.2.png' width=250 />
</center>

---

#### 3.2.3

```mathematica
(* 定义序列 *)
x[n_] := Which[
	n >= 0, 3^-n,
	n < 0, 2^n
]
(* 求解 z 变换 *)
X[z_] := BilateralZTransform[
	x[n], n, z,
	GenerateConditions -> True
]
(* 绘制收敛域 *)
With[
	{z = u + I v}, RegionPlot[1/3 < Abs[z] < 2,
	{u, -3, 3}, {v, -3, 3}]
]
(* 绘制函数幅角图 *)
ComplexPlot[X[z], {z, -3 - 3 I, 3 + 3 I}, ImageSize -> Small]
```

$$
\fbox{$-\frac{5 z}{3 z^2-7 z+2}\text{ if }\frac{1}{3}<| z| <2$}
$$

<center class="half">
	<img src='image\3.2.3.1.png' width=250 />&emsp;&emsp;&emsp;
	<img src='image\3.2.3.2.png' width=250 />
</center>

---

#### 3.2.4

```mathematica
ZTransform[
	Cos[n Subscript[\[Omega], 0]], n, z,
	GenerateConditions -> True
]
```

$$
\fbox{$\frac{z \left(z-\cos \left(\omega _0\right)\right)}{z^2-2 z \cos \left(\omega _0\right)+1}\text{ if }\Im\left(\omega _0\right)=0\land | z| >1$}
$$

---

#### 3.2.5

```mathematica
ZTransform[
	\[Beta]^n Cos[n Subscript[\[Omega], 0]], n, z,
	GenerateConditions -> True
]
```

$$
\fbox{$\frac{z \left(z-\beta  \cos \left(\omega _0\right)\right)}{\beta ^2+z^2-2 \beta  z \cos \left(\omega _0\right)}\text{ if }\Im\left(\omega _0\right)=0\land | z| >| \beta | $}
$$

---

#### 3.2.6

```mathematica
ZTransform[n a^n UnitStep[n], n, z, GenerateConditions -> True]
```

$$
\fbox{$\frac{a z}{(a-z)^2}\text{ if }| z| >| a| $}
$$

---

#### 3.2.7

1. 使用思路一的 mathematica 代码

```mathematica
Table[InverseZTransform[(z^2 + 2 z)/(z^3 + 0.5 z^2 - z + 7), z, n], {n, 0, 1}]
```

2. 使用思路二的 mathematica 代码

```mathematica
Table[Series[(2 z^2 + z)/(7 z^3 - z^2 + 0.5 z + 1), {z, 0, n}], {n, 0, 1}]
```

前两种思路的计算机求解在误差范围内与[第三种方法](# 2.7)是相同的.

