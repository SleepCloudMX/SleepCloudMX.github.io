# ç”µå­ç§¯æœ¨



è½¯ä»¶: Arduino IDE, ç³»ç»Ÿ: Arduino UNO, è¯­è¨€: Arduino Language.

å‚è€ƒèµ„æ–™: Arduino å¼€å‘, ä»é›¶å¼€å§‹å­¦.

å‚è€ƒç½‘ç«™: www.arduino.cc



![image-20220831184750861](E:\Notes\Electronics\ç”µå­ç§¯æœ¨\image\image-20220831184750861.png)

æ•°å­—å¼•è„šï¼š0-13ï¼Œ

æ¨¡æ‹Ÿå¼•è„šï¼š14-19.

è¾“å‡º: 3, 9, 10, 11



**å˜é‡ç±»å‹**

| ç±»å‹    | å­—èŠ‚ | ä¿¡æ¯        |
| ------- | ---- | ----------- |
| byte    | 1    | 0-255       |
| word    | 2    | 0-65536     |
| boolean | 1    | false, true |
| string  | -    |             |
| String  | -    |             |
| array   |      |             |
| void    | 0    | ä¸€ä¸ªæ ‡è¯†ç¬¦  |



æˆ‘çš„ç”µè„‘:

å³è¾¹æ˜¯ COM6.



proteus é‡Œçš„å…ƒä»¶å

- ç”µé˜» resistor

- è™šæ‹Ÿä¸²å£ç›‘è§†å™¨ COMPIM

  Arduino æ¿å­ 0 å·ä¸ 1 å·ä¸ä¹‹ 2 å·å’Œ 3 å·è¿æ¥.

- å¼€å…³: switch

- æŒ‰é’®: button

- WS2812

  - å¼•è„š: VDD ä¸ºç”µæº, DOUT ä¸ºæ•°æ®è¾“å‡º, VSS ä¸ºåœ°, DIN ä¸ºæ•°æ®è¾“å…¥.
  - FastLED.h

- å…‰æ•ç”µé˜» torch_ldr

- æ¸©åº¦ä¼ æ„Ÿå™¨ LM35

- èœ‚é¸£å™¨: sounder, <u>speaker</u>

- æ•°ç ç®¡: 7seg-com-anode

- çƒ­æ•ç”µé˜»: NTC

- æ¶²æ™¶æ˜¾ç¤ºå™¨: LCD, AGM1232G.

- å…±é˜´æ•°ç ç®¡é©±åŠ¨èŠ¯ç‰‡ MAX 7219.

- æ¶²æ™¶æ˜¾ç¤ºå™¨: SSD1306 (æ˜¾ç¤ºçš„æ›´å¤š)

- ç›´æµç”µæœºé©±åŠ¨èŠ¯ç‰‡ L293D.



HC-SR501




LED ç¯ "é•¿æ­£çŸ­è´Ÿ"



å…±é˜³å‹ LED æ•°ç ç®¡ä½äº®é«˜ç­, å…«æ®µéœ€è¦ä¹ä¸ªå¼•è„š.

---

## D1

### æ•°ç ç®¡

ä¸ƒæ®µæ•°ç ç®¡: abcdefgh

å…«æ®µæ•°ç ç®¡: å¤šäº†ä¸€ä¸ªæ˜¾ç¤ºå°æ•°ç‚¹çš„å‘å…‰äºŒæç®¡å•å…ƒ DP (Decimal Point)

å…±é˜³æ: åªå¼•å‡ºä¸¤ä¸ªé˜³æå’Œå„ä¸ªé˜´æå¼•è„š.

å…±é˜´æ GND

![image-20221028160546654](E:\Notes\Electronics\ç”µå­ç§¯æœ¨\image\image-20221028160546654.png)

å¤šä½æ•°ç ç®¡: MAX7219 (Proteus å…ƒä»¶) æ˜¯å…±é˜´æ•°ç ç®¡é©±åŠ¨èŠ¯ç‰‡, å¯ä»¥åŒæ—¶é©±åŠ¨ 8 ä¸ªå…±é˜´æ•°ç ç®¡æˆ– LED ç‚¹é˜µ, æ§åˆ¶æ¥å£æ˜¯ä¸²è¡Œæ¥å£.

- MAX7219 ç¤ºä¾‹

```cpp
#include <max7219.h>
MAX7219 max7219;
void setup() {
	Serial.begin(9600);
	max7219.Begin();	// æ³¨æ„é¦–å­—æ¯å¤§å†™
}
void loop() {
	String temp;		// é¦–å­—æ¯å¤§å†™
    char temp2[8];
    int y;
    
    // æ˜¾ç¤ºæ•°å­—æˆ–å­—æ¯
    max7219.DisplayText("95.67F", 1);	// 1 ä¸ºå³å¯¹é½
    delay(3000);
    max7219.Clear();	// æ¸…å±, æ³¨æ„å¤§å†™
    max7219.DisplayText("95.67F", 0);	// 0 ä¸ºå·¦å¯¹é½
    delay(3000);
    max7219.Clear();
    
    // åè¿›åˆ¶æ•°æ•° (è®¡æ—¶)
    for (float x = 0; x < 1; x += 0.1) {
        temp = String(x);	// è½¬ä¸º String ç±»å‹
        temp.toCharArray(temp2, temp.length());	// è½¬ä¸ºå­—ç¬¦æ•°ç»„
        // è‹¥åŒ…å« <stdio.h>, ä¸Šä¸¤è¡Œå¯ä»¥ç›´æ¥ç”¨ sprintf()
        max7219.DisplayText(temp2, 1);
        Serial.println(x);
        delay(500);
    } // ä¸ delay çš„è¯é€Ÿåº¦å¿«, ä½†ä¹Ÿä¸æ˜¯å¿«çš„ç¦»è°±
    max7219.Clear();
    
    // é€ä½æ˜¾ç¤ºå­—æ¯
    max7219.DisplayChar(7, 'H', 0);		// å·¦æ•°ç¬¬ 7 ä½, ä» 0 å¼€å§‹
    max7219.DisplayChar(6, 'E', 0);
    max7219.DisplayChar(5, 'L', 0);
    max7219.DisplayChar(4, 'L', 0);
    max7219.DisplayChar(3, 'O', 0);
    delay(1000);
    max7219.Clear();
    max7219.DisplayText("World", 0);
}
```

- MAX7219 ç”¨æ³•æ€»ç»“

```cpp
#include <max7219.h>
#define LEFT 0		// è¿™æ ·æ›´æ¸…æ™°
#define RIGHT 1
Max7219 max7219;	// å®šä¹‰å®ä¾‹, å…¶æˆå‘˜å‡½æ•°é¦–å­—æ¯å¤§å†™
max7219.Begin();	// åœ¨ setup() ä¸­
max7219.Clear();	// æ¸…å±
max7219.DisplayText(chars, justify);	// justify ä¸º 0 (å·¦) æˆ– 1 (å³)
max7219.DisplayChar(pos, ch, justify);	// pos æ˜¾ç¤ºçš„ä½ç½®, ä» 0 è®¡æ•°

// å…¶å®ƒå¯èƒ½ä¼šç”¨åˆ°çš„å‡½æ•°
float x = 32;
str = String(x);	// è½¬ä¸º String ç±»å‹
str.toCharArray(s, str.length());	// è½¬ä¸ºå­—ç¬¦æ•°ç»„å¹¶å­˜å‚¨è‡³ s ä¸­
```

### æ¶²æ™¶æ˜¾ç¤ºå™¨

LCD (Liquid Crystal Display), åœ¨ Proteus ä¸­çš„å…ƒä»¶ä¸º LCD1602.

![image-20221028162940839](E:\Notes\Electronics\ç”µå­ç§¯æœ¨\image\image-20221028162940839.png)

| **LCD1602** | **â€”>** | **Arduino UNO** | **è¯´æ˜**                          |
| ----------- | ------ | --------------- | --------------------------------- |
| GND         | â€”>     | GND             | æ¥åœ°                              |
| VCC         | â€”>     | 5V              | 5Vç”µæº                            |
| V0          | â€”>     |                 | è¿æ¥3è„šç»§ç”µå™¨ä¸­é—´ï¼Œç”¨äºè°ƒèŠ‚å¯¹æ¯”åº¦ |
| RS          | â€”>     | 12              | éšä¾¿æ¥ä¸€ä¸ªè¾“å‡ºå£ï¼Œæ–¹ä¾¿æ¥çº¿ã€ç”»å›¾  |
| R/W         | â€”>     | GND             | æ¥åœ°ï¼Œå†™æ¨¡å¼                      |
| EN          | â€”>     | 11              | éšä¾¿æ¥ä¸€ä¸ªè¾“å‡ºå£ï¼Œæ–¹ä¾¿æ¥çº¿ã€ç”»å›¾  |
| D0~D3       | â€”>     |                 | 4ä½å·¥ä½œæ¨¡å¼ï¼Œä¸ä½¿ç”¨               |
| D4~D7       | â€”>     | 5ã€4ã€3ã€2      | å…¶å®ƒå£ä¹Ÿè¡Œï¼Œæ–¹ä¾¿æ¥çº¿ã€ç”»å›¾        |
| BLA         | â€”>     |                 | èƒŒå…‰ï¼Œç”µæºæ­£æï¼Œå¯é€‰              |
| BLK         | â€”>     |                 | èƒŒå…‰ï¼Œæ¥åœ°ï¼Œå¯é€‰                  |

- LCD1602 å®ä¾‹

```cpp
#include <LiquidCrystal.h>
const int rs = 12, en = 11, d4 = 5, d5 = 4, d6 = 3, d7 = 2;	// å¼•è„š
LiquidCrystal lcd(rs, en, d4, d5, d6, d7);
void setup() {
    lcd.begin(16, 2);	// LCD çš„åˆ—æ•°ä¸è¡Œæ•°
    lcd.println("Hello, world!");
}
void loop() {
    lcd.noDisplay();	// å…³é—­
    delay(500);
    lcd.display();		// å¼€å¯
    delay(500);
}
```

### Arduino å®ä¾‹

- é”®ç›˜
- æŒ‰é”®
- è®¡ç®—å™¨
- æ—¶é’Ÿ
- æ•°å­—æ¸©åº¦è®¡
- ç›´æµç”µæœº / é©¬è¾¾æ§åˆ¶
- æ­¥è¿›ç”µæœº
- ä¼ºæœç”µæœº

### æ—¶é’Ÿ

- AdvDS1307Clockbasic

```cpp
#include <Wire.h>
#include "DS1307.h"
DS1307 clock;
void setup() {
    Serial.begin(9600);
    clock.begin();	// å¼€å§‹è®¡æ—¶
    clock.fillByYMD(2022, 10, 22);
    clock.fillByHMS(19, 23, 30);
    clock.fillDayOfWeek(THU);
    clock.setTime();	// å†™å…¥æ—¶é—´è‡³ RTC èŠ¯ç‰‡
}
void loop() {
    printTime();	// è‡ªå·±å†™çš„å‡½æ•°
    delay(1000);
}
void printTime() {
    clock.getTime();
    Serial.print(clock.hour, DEC);
    Serial.print(":");
    Serial.print(clock.minute, DEC);
    Serial.print(":");
    Serial.print(clock.second, DEC);
    Serial.print(" ");
    Serial.print(clock.month, DEC);
    Serial.print("/");
    Serial.print(clock.dayOfMonth, DEC);
    Serial.print("/");
    Serial.print(clock.year + 2000, DEC);
    Serial.print(" ");
	switch (clock.dayOfWeek) {
        case MON: Serial.print("MON"); break;
        case TUE: Serial.print("TUE"); break;
        case WED: Serial.print("WED"); break;
        case THU: Serial.print("FRI"); break;
        case SAT: Serial.print("SAT"); break;
        case SUN: Serial.print("SUN"); break;
    }
    Serial.println(" ");
}
```

- AdvDS1307ClockLCD

```cpp
#include <Wire.h>
#include "DS1307.h"
#include "HD44780_LCD_PCF8574.h"
DS1307 clock;
HD44780LCD lcdTime(2, 16, 0x27);
void setup() {
	Serial.begin(9600);
    clock.begin();
    clock.fillByYMD(2022,10, 19);
    clock.fillByHMS(19, 12, 35);
    clock.fillDayOfWeek(THU);
    clock.setTime();	// å†™å…¥æ—¶é—´
    lcdTime.PCF8574_LCDInit(LCDCursorTypeOff);	// å»é™¤å…‰æ ‡
    lcdTime.PCF8574_LCDClearScreen();		// æ¸…å±
    lcdTime.PCF8574_LCDBackLightSet();	// LCD åˆå§‹è®¾ç½®
}
void loop() {
    printTime();
    delay(500);
}

void printTime() {
    char hour[3], minute[3], second[3];
    char month[3], dayOfMonth[3], year[5];
    
    clock.getTime();
    sprintf(hour, "%02d", clock.hour);
    sprintf(minute, "%02d", clock.minute);
    sprintf(second, "02d", clock.second);
    sprintf(month, "02d", clock.month);
    sprintf(dayOfMonth, "%02d", clock.dayOfMonth);
    sprintf(year, "%d", clock.year + 2000);
    
    lcdTime.PCF8574_LCDGOTO(2, 4);
    lcdTime.PCF8574_LCDSendString(hour);
    lcdTime.PCF8574_LCDSendChar(':');
    lcdTime.PCF8574_LCDSendString(minute);
    lcdTime.PCF8574_LCDSendChar(':');
    lcdTime.PCF8574_LCDSendString(year); 
    lcdTime.PCF8574_LCDSendChar('-'); 
    lcdTime.PCF8574_LCDSendString(month);
    lcdTime.PCF8574_LCDSendChar('-'); 
    lcdTime.PCF8574_LCDSendString(dayOfMonth);
    
    Serial.print(clock.hour, DEC);
    ..... // åŒä¸Š
}
```

- ç”¨æ³•æ€»ç»“

```cpp
#include <Wire.h>
#include "DS1307.h"
#include "HD44780_LCD_PCF8574.h"
DS1307 clock;
HD44780LCD lcdTime(2, 16, 0x27);

// åˆå§‹åŒ– clock å®ä¾‹, ç”¨äºè·å–æ—¶é—´
clock.begin();
clock.fillByYMD(2022,10,19);
clock.fillByHMS(19,12,35);
clock.fillDayOfWeek(THU);
clock.setTime();

// åˆå§‹åŒ– lcdTime å®ä¾‹, ç”¨äºæ˜¾ç¤ºæ—¶é—´
lcdTime.PCF8574_LCDInit(LCDCursorTypeOff);
lcdTime.PCF8574_LCDClearScreen();
lcdTime.PCF8574_LCDBackLightSet(true);

// è·å–æ—¶é—´
clock.getTime();

// ä½¿ç”¨ lcdTime
lcdTime.PCF8574_LCDGOTO(2, 4);			// ç§»åŠ¨å…‰æ ‡è‡³ç¬¬ 2 è¡Œç¬¬ 4 åˆ—
lcdTime.PCF8574_LCDSendString(s);		// è¾“å‡ºå­—ç¬¦æ•°ç»„
lcdTime.PCF8574_LCDSendChar(ch);		// è¾“å‡ºå­—ç¬¦
```



å‚è€ƒç¤ºä¾‹

[LCD æ¶²æ™¶æ˜¾ç¤ºå™¨](D:\AppData\Proteus\tutorial\LCDDisplay1602)

[MAX7912 è‡ªå¸¦ç¤ºä¾‹åŠå…¶ç”µè·¯](D:\AppData\Proteus\tutorial\AdvSegment8Bits)

[æ—¶é’ŸåŸºç¡€](D:\AppData\Proteus\tutorial\AdvDS1307Clockbasic)

[æ—¶é’Ÿ](D:\AppData\Proteus\tutorial\AdvDS1307ClockLCD)



æˆ‘å·²ç»å®Œå…¨ä¸ä¼š cpp äº†, åˆšæ‰æµ‹è¯•äº†ç‚¹ä¸œè¥¿, æ”¾è¿™å„¿äº†

```cpp
#include <iostream>
#include <cmath>
using namespace std;

class Test
{
public:
  Test(int a = 0): a(a) {}
  virtual void show() {cout << a << endl;}
protected:
  int a;
};

class Test2: public Test
{
public:
  Test2(int a = 0, char b = 0): Test(a), b(b) {}
  void show() {cout << a << ' ' << b << endl;}
protected:
  int b;
};

typedef struct testS {
    int a = 1;
} testS;

int main()
{
    Test t(1);
    t.show();
    Test2 t2(2, 3);
    t2.show();						// protected çš„ç”¨æ³•
    struct testS ts1, ts2 = {2};	// è¦ç”¨å¤§æ‹¬å·
    ts1 = testS{2};					// è¿™æ ·ä¹Ÿå¯ä»¥å“¦
    cout << ts1.a;
    return 0;
}
```





















### æ—¶é’Ÿè®¾è®¡: RTC

**ä½¿ç”¨å™¨ä»¶**

1. ä½¿ç”¨ä¸²å£ç›‘è§†å™¨ (å¯ä»¥æ²¡æœ‰).
2. ä½¿ç”¨ DS1307 è·å–æ—¶é—´ (å®ä¾‹å clock).
3. ä½¿ç”¨ HD44780LCD æ˜¾ç¤ºæ—¶é—´ (å®ä¾‹å lcdTime).
4. ä½¿ç”¨ LiquidCrystal æ˜¾ç¤ºå…¶å®ƒä¿¡æ¯ (å®ä¾‹åä¸º lcdInfo), å¦‚æ˜ŸæœŸå‡ , å½“å‰æ‰€åœ¨æ¨¡å¼, é—¹é’Ÿæ˜¯å¦æ‰“å¼€.

**æ³¨**	å°è¯•è¿‡äº†, ä¸èƒ½ä½¿ç”¨ max7219 æ˜¾ç¤ºæ˜ŸæœŸ, ä¸€æ–¹é¢å®Œæ•´å•æ¬¡æœ€å¤šæœ‰ 9 ä¸ªå­—æ¯, å¦ä¸€æ–¹é¢å¾ˆå¤šå­—æ¯éƒ½æ— æ³•æ˜¾ç¤º, æˆ–è€…è¾ƒéš¾è¾¨è®¤. æ˜ŸæœŸçš„å•è¯ä¸­æœ‰äº›å°±æ— æ³•æ˜¾ç¤º.

---

**å¼•è„šæ•°**

1. ä¸²å£ç›‘è§†å™¨: 2 ä¸ªæ•°å­—å¼•è„š.
2. clock: 2 ä¸ªæ•°å­—å¼•è„š, 2 ä¸ªæ¨¡æ‹Ÿå¼•è„š.
3. lcdTime: 6 ä¸ªæ•°å­—å¼•è„š, å…¶ä¸­æœ‰ 2 ä¸ªä¸ DS1307 å…±ç”¨
4. æŒ‰é’®: 4 ä¸ªæ•°å­—å¼•è„š (ä¸èƒ½ä¸å…¶å®ƒçš„é‡äº†).
5. lcdInfo: 6 ä¸ªæ•°å­—å¼•è„š, å‡ä¸ lcdTime å…±ç”¨.

å…±èŠ±å» 2 ä¸ªæ¨¡æ‹Ÿå¼•è„šå’Œ 12 ä¸ªæ•°å­—å¼•è„š.

---

**æ•°å­—é’ŸåŠŸèƒ½**

æœ‰äº”ä¸ªåŠŸèƒ½æ¨¡å—

1. æ˜¾ç¤ºæ—¶é—´, æ—¥æœŸä¸æ˜ŸæœŸ.
2. è®¾ç½®æ—¶é—´, æ—¥æœŸ (é—ªçƒ).
3. é—¹é’Ÿæ¨¡å¼.
4. å€’è®¡æ—¶æ¨¡å¼.
5. è®¡æ—¶æ¨¡å¼.

ä¹‹åå¯ä»¥è€ƒè™‘ am, pm.

---

**é€»è¾‘æ€è·¯**

æ²¡æœ‰ ctime ç­‰åº“å‡½æ•° (è‡ªå·±å®‰è£…å‘¢?), æ‰€ä»¥æ‰“ç®—è‡ªå·±é€ è½®å­.

ç”± clock è·å–å½“å‰æ—¶é—´ currentTime, å†åŠ ä¸Šè®¾ç½®æ—¶é—´è€Œæ”¹å˜çš„æ—¶é—´ deltaTime, å¾—åˆ°æ ¡æ­£åçš„æ—¶é—´ correctedTime.

å…¶ä¸­ deltaTime åŒ…å«ä¸¤ä¸ªæ•´å‹æ•°æ®, ä¸€å¤©å†…çš„ç§’æ•° (0 - 86400) å’Œå¤©æ•° (-3660000 - 3660000). ç”±äºé—°å¹´ç¨æœ‰å¤æ‚, è¿™é‡Œä¸å†æ·±å…¥ä¼˜åŒ–, ä¸€ä¸ªæœˆä¸€ä¸ªæœˆçš„å¤„ç†.

---

**æŒ‰é”®ç®€ä»‹**

buttonSet: è¿›å…¥è®¾ç½®; ä¸‹ä¸€è®¾ç½®

buttonEnter: ç¡®å®š, è¿›å…¥ / é€€å‡º.

buttonPlus: åŠ ; è®¡æ¬¡

buttonMinus: å‡; é‡ç½®

---

**å…·ä½“é€»è¾‘**

- (buttonSet) - æ˜¾ç¤ºæ—¶é—´ (mode = 0)

- buttonSet - æ—¶é—´è®¾ç½® (mode = 1)

  - buttonEnter - è®¾ç½®å¹´ (submode = 1)

    <span style='background-color: #eeeeee; color: #777777'>æ³¨æ„ 0 çš„ä½ç½®ç•™ç»™äº† "æ— è®¾ç½®", æˆ‘è®¤ä¸ºè¿™å¯¹äºå‡å°‘ç–‘æƒ‘ã€å¿«é€Ÿä¸Šæ‰‹ã€ä¾¿äºä½¿ç”¨æ¥è¯´, æ˜¯æœ‰å¿…è¦çš„.</span>

    - buttonPlus - åŠ ä¸€å¹´
    - buttonMinus - å‡ä¸€å¹´

  - buttonEnter - è®¾ç½®æœˆ (submode = 2)

  - buttonEnter - è®¾ç½®æ—¥ (submode = 3)

  - buttonEnter - è®¾ç½®æ—¶ (submode = 4)

  - buttonEnter - è®¾ç½®åˆ† (submode = 5)

  - buttonEnter  - é‡ç½®ç§’ (submode = 6)
    - buttonPlus / buttonMinus - é‡ç½®ç§’
    
  - buttonEnter - é€€å‡ºæ—¶é—´è®¾ç½® (submode = 0)

- buttonSet - é—¹é’Ÿè®¾ç½® (mode =2)
  - buttonEnter - é—¹é’Ÿè®¾ç½®æ—¶ (submode = 1)
    - buttonPlus - åŠ ä¸€å°æ—¶
    - buttonMinus - å‡ä¸€å°æ—¶
    - buttonSet - å¯ç”¨é—¹é’Ÿ (å¯æ˜¾ç¤ºç‚¹) (isAlarmOn = true)
    - buttonSet - ç¦ç”¨é—¹é’Ÿ (ä¸æ˜¾ç¤ºç‚¹) (isAlarmOn = false)
  - buttonEnter - é—¹é’Ÿè®¾ç½®åˆ† (submode = 2, æ²¡æœ‰å¿…è¦ç²¾ç¡®åˆ°ç§’)
  - buttonEnter - é€€å‡ºé—¹é’Ÿè®¾ç½® (submode = 0)

- buttonSet - å€’è®¡æ—¶æ¨¡å¼ (mode = 3)
  - buttonEnter - å€’è®¡æ—¶è®¾ç½® (submode = 1)
    - buttonSet - è®¾ç½®å°æ—¶ (subsubmode = 1)
      - buttonPlus - åŠ ä¸€å°æ—¶
      - buttonMinus - å‡ä¸€å°æ—¶
    - buttonSet - è®¾ç½®åˆ† (subsubmode = 2)
    - buttonSet - è®¾ç½®ç§’ (subsubmode = 3)
  - buttonEnter - å€’è®¡æ—¶ (submode = 2)
    - buttonSet - å¼€å§‹å€’è®¡æ—¶ (subsubmode = 1)
    - buttonSet - åœæ­¢å€’è®¡æ—¶ (subsubmode = 2)
    - buttonMinus - ç»“æŸå€’è®¡æ—¶ (subsubmode = 3)
    - buttonPlus - é‡ç½®å€’è®¡æ—¶ (subsubmode = 0)
  - buttonEnter - é€€å‡ºå€’è®¡æ—¶ (submode = 0)
  - ~~buttonEnter - è¿›å…¥å€’è®¡æ—¶æ¨¡å¼ (submode = 0)~~
    - ~~buttonSet - å€’è®¡æ—¶è®¾ç½® (submode = 1)~~
      - ~~buttonEnter - è®¾ç½®å°æ—¶ (subsubmode = 1)~~
        - ~~buttonPlus - åŠ ä¸€å°æ—¶~~
        - ~~buttonMinus - å‡ä¸€å°æ—¶~~
      - ~~buttonEnter - è®¾ç½®åˆ† (subsubmode = 2)~~
      - ~~buttonEnter - è®¾ç½®ç§’ (subsubmode = 3)~~
    - ~~buttonSet - å€’è®¡æ—¶ (submode = 2)~~
      - ~~buttonEnter - å¼€å§‹å€’è®¡æ—¶ (subsubmode = 1)~~
      - ~~buttonEnter - åœæ­¢å€’è®¡æ—¶ (subsubmode = 2)~~
      - ~~buttonMinus - ç»“æŸå€’è®¡æ—¶ (subsubmode = 3)~~
      - ~~buttonPlus - é‡ç½®å€’è®¡æ—¶ (subsubmode = 0)~~
  - ~~buttonEnter - é€€å‡ºå€’è®¡æ—¶ (submode = 0)~~
  
- buttonSet - è®¡æ—¶æ¨¡å¼ (mode = 4)

  - buttonEnter - å¼€å§‹è®¡æ—¶ (submode = 1)
  - buttonPlus - è®¡æ¬¡
  - buttonEnter - åœæ­¢è®¡æ—¶ (submode = 2)
  - buttonMinus - å¤ä½ (submode = 0)

- buttonSet - æ˜¾ç¤ºæ—¶é—´ (mode = 0)

---

```cpp
// æ¨¡å¼
0 SHOW TIME
1 SET TIME
    0 NULL
    1 YEAR
    2 MONTH
    3 DAY
    4 HOUR
    5 MINUTE
    6 SECOND
2 ALARM MODE
    0 NULL
    1 HOUR
    2 MINUTE
3 COUNT DOWN
    0 NULL
    1 SET
    	1 HOUR
    	2 MIN
    2 WORK
    	0 READY
    	1 START
    	2 STOP
    	3 END
4 TIMER MODE
	0 NULL
	1 START
	2 STOP


// æ˜ŸæœŸ
MON
TUE
WED
THU
FRI
SAT
SUN

// æ—¶é—´
Morning (06:00 - 11:00)
Noon (11:00 - 14:00)
Afternoon (14:00 - 17:00)
Evening (17:00 - 20:00)
Night (20:00 - 06:00)

// é—¹é’Ÿ
ALARM ON
ALARM OFF
```

**å˜é‡å®šä¹‰**

```cpp
#include <Wire.h>
#include <LiquidCrystal.h>
#include "DS1307.h"
#include "HD44780_LCD_PCF8574.h"

//--------------------ç±», å˜é‡, ç»“æ„ä½“çš„å®šä¹‰-----------------------
// æŒ‰é”®å¼•è„šä¸å®ä¾‹å®šä¹‰
// ä¸²å£ç›‘è§†å™¨æ¥æ•°å­—å¼•è„š 0 å’Œ 1

const int sounderPin = 1;

const int buttonPin[4] = {6, 7, 8, 9};
// 0: buttonSet å¼•è„š 6
// 1: buttonEnter å¼•è„š 7
// 2: buttonPlus å¼•è„š 8
// 3: buttonMinus å¼•è„š 9

// å…³é—­æ˜¯ä½ç”µå¹³, æŠ¬èµ·æ˜¯é«˜ç”µå¹³
int buttonState[4] = {HIGH, HIGH, HIGH, HIGH};
bool isButtonClicked[4] = {false, false, false, false};
int reading[4] = {HIGH, HIGH, HIGH, HIGH};
int lastReading[4] = {HIGH, HIGH, HIGH, HIGH};

// ä¸ºäº†ä»£ç çš„æ˜“è¯»æ€§, å®šä¹‰å¦‚ä¸‹å¼•ç”¨
bool &buttonSet = isButtonClicked[0];
bool &buttonEnter = isButtonClicked[1];
bool &buttonPlus = isButtonClicked[2];
bool &buttonMinus = isButtonClicked[3];

// æŒ‰é’®çš„é˜²æŠ–åŠ¨æœºåˆ¶
unsigned long lastDebounceTime[4] = {0, 0, 0, 0};
unsigned long debounceDelay = 50;

// è·å–æ—¶é—´ä¸æ˜¾ç¤ºæ—¶é—´
DS1307 clock;  // æ¨¡æ‹Ÿå¼•è„š A4, A5, å…±ç”¨æ•°å­—å¼•è„š 11, 12
HD44780LCD lcdTime(2, 16, 0x27);  // å…±ç”¨æ•°å­—å¼•è„š 11, 12

// æ˜¾ç¤ºå…¶å®ƒä¿¡æ¯
const int rs = 13,en = 10;  // æ•°å­—å¼•è„š 10, 13
const int d4 = 5,d5 = 4,d6 = 3,d7 = 2;  // æ•°å­—å¼•è„š 2, 3, 4, 5
LiquidCrystal lcdInfo(rs, en, d4, d5, d6, d7);

// çŠ¶æ€è®¾ç½® (currentState å’Œ alarmMode)
// åªç”¨ä¸€æ¬¡, å°±ç›´æ¥ç”¨ struct äº†, ä¹Ÿä¸ typedef äº†
// ä¹Ÿå¯ä»¥åœ¨ç»“æ„ä½“å®šä¹‰æ—¶ç›´æ¥åˆå§‹åŒ–
struct ClockState {
    int mode;
    int submode;
    int subsubmode;
} currentState = {0, 0, 0};

bool isAlarmOn = false;

// æ—¶é—´è®°å½•
class Time {
public:
    Time(int hour = 0, int minute = 0, int second = 0)
        : hour(hour), minute(minute), second(second) {}
public:
    int hour;
    int minute;
    int second;
} adtime, ddtime, alarmTime, countDownTime, countTime;
// å³è®¡æ—¶ä¸Šå‡çš„ ascending time, å€’è®¡æ—¶ä¸‹é™çš„ descending time å’Œé—¹é’Ÿæ—¶é—´

class TimeWithDate: public Time {
public:
    TimeWithDate(int year = 0, int month = 0, int day = 0, int hour = 0, int minute = 0, int second = 0)
        : year(year), month(month), day(day), Time(hour, minute, second) {}
protected:
    int year;
    int month;
    int weekday;
    int day;
} currentTime, correctedTime;

class DayAndSecond {
public:
    DayAndSecond(int day = 0, int second = 0)
        : day(day), second(second) {}
    void addDay(int deltaDay) {day += deltaDay;}
    void addSecond(int deltaSecond) {
        second += deltaSecond;
        day += second / (3600 * 24);
        second %= 3600 * 24;
    }
    int getDay() {return day;}
    int getSecond() {return second;}
protected:
    int day;
    int second;
} deltaTime;

int daysOfMonth[12] = {31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
//               month: 1   2   3   4   5   6   7   8   9  10  11  12
```





**å€’è®¡æ—¶çš„å¼ƒç”¨è®¾è®¡**

buttonEnter

buttonExit

buttonNext

buttonLast

---

- buttonEnter - è¿›å…¥è®¾ç½® (è®¾ç½®æ—¶é—´)
  - buttonEnter - è®¾ç½®å¹´
  - buttonNext - è®¾ç½®æœˆ
  - buttonNext - è®¾ç½®æ—¥
  - buttonNext - è®¾ç½®æ—¶
  - buttonNext - è®¾ç½®åˆ†
  - buttonNext - é‡ç½®ç§’
  - buttonExit - é€€å‡ºæ—¶é—´è®¾ç½®
- buttonNext - é—¹é’Ÿ
- buttonNext - å€’è®¡æ—¶
- buttonNext - è®¡æ—¶
- buttonExit - é€€å‡º













### è¯¾ç¨‹å‚è€ƒ

[proteusèœ‚é¸£å™¨ä¸å“-ç™¾åº¦ç»éªŒ (baidu.com)](https://jingyan.baidu.com/article/c1a3101e90b2e59f656debfd.html#:~:text=Proteusä»¿çœŸèœ‚é¸£å™¨ä¸å“åŸå› å¯èƒ½æ˜¯æ²¡æœ‰é€‰å¯¹èœ‚é¸£å™¨æˆ–è€…é€‰æˆäº†æ‰¬å£°å™¨ã€‚ èœ‚é¸£å™¨åˆ†æœ‰æºå’Œæ— æºï¼Œé©±åŠ¨æ–¹å¼ä¸ä¸€æ ·ï¼Œè¿˜æœ‰å°±æ˜¯å¯èƒ½èœ‚é¸£å™¨å‚æ•°è®¾ç½®ä¸æ­£ç¡®ã€‚,è¯¦ç»†å¦‚ä¸‹ã€‚ ã€1ã€‘é¦–å…ˆå¯¹ç…§æ£€æŸ¥ç”µè·¯æ˜¯å¦æ­£ç¡®ï¼Œä¸‹å›¾æ˜¯é«˜ç”µå¹³é©±åŠ¨æœ‰æºèœ‚é¸£å™¨çš„ç”µè·¯ã€‚ ä½ç”µå¹³é©±åŠ¨éœ€è¦æ¢æˆPNPä¸‰æç®¡ã€‚)

[(14æ¡æ¶ˆæ¯) Arduinoå­¦ä¹ (äº”) èœ‚é¸£å™¨å®éªŒ_JoStudioçš„åšå®¢-CSDNåšå®¢_arduinoèœ‚é¸£å™¨åœæ­¢å‘å£°](https://blog.csdn.net/c80486/article/details/52620972)

[(14æ¡æ¶ˆæ¯) proteus èœ‚é¸£å™¨ç³»åˆ—_weixin_41980642çš„åšå®¢-CSDNåšå®¢_proteusèœ‚é¸£å™¨](https://blog.csdn.net/weixin_41980642/article/details/106626133)

[(14æ¡æ¶ˆæ¯) proteusä»¿çœŸæœ‰æº/æ— æºèœ‚é¸£å™¨_Doee hcçš„åšå®¢-CSDNåšå®¢_proteusèœ‚é¸£å™¨æ€ä¹ˆæ‰¾](https://blog.csdn.net/weixin_44578655/article/details/107093364)

[RGBé¢œè‰²ä»£ç è¡¨ğŸ¨ (rapidtables.org)](https://www.rapidtables.org/zh-CN/web/color/RGB_Color.html)

å•ƒèŠå£«çš„è§†é¢‘. :star: 

[(14æ¡æ¶ˆæ¯) Arduino ide tabç¼©è¿›å’Œè‡ªåŠ¨ç¼©è¿› 4 å­—èŠ‚ è®¾ç½®_Yangs_noerrçš„åšå®¢-CSDNåšå®¢_arduino tab](https://blog.csdn.net/weixin_38897481/article/details/125622877)

