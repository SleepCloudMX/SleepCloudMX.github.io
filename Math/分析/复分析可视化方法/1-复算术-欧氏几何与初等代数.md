<h1 align=center>复算术-欧氏几何与初等代数</h1>

$$
% 设置
\newcommand{\aneg}[1]{\hspace{-0.75em}&#1&\hspace{-0.75em}}
\newcommand{\aneq}{\aneg{=}}
% 上述指令用于在使用 array 环境时调整等号左右间距
\newcommand{\eqs}{\quad\;}
% 上述指令用于 align 环境中, &= 的换行对齐时调整第二行位置
\renewcommand{\d}{\displaystyle}

% 字符
\renewcommand{\i}{\mathrm{i}}
\renewcommand{\j}{\mathrm{j}}
\renewcommand{\k}{\mathrm{k}}
\newcommand{\e}{\textup{e}}
\newcommand{\ve}{\varepsilon}
\newcommand{\Beta}{\mathit{B}}
\newcommand{\omicron}{\mathit{o}}
\newcommand{\Omicron}{\mathit{O}}

% 原本的定义为:
% \newcommand{\cal}[1]{\mathcal{#1}}
\renewcommand{\cal}[1]{\mathcal#1}
\renewcommand{\scr}[1]{\mathscr#1}
\renewcommand{\frak}[1]{\mathfrak#1}
\newcommand{\bb}[1]{\mathbb#1}

% 数集
\newcommand{\D}{\mathbb{D}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\J}{\mathbb{J}}
\newcommand{\K}{\mathbb{K}}
\renewcommand{\L}{\mathbb{L}}

% 上下标
\newcommand{\trans}{^\mathrm{T}}
\newcommand{\inv}{^{-1}}
\newcommand{\madj}[1]{^{\pqty{#1^*}}}	% m 重伴随矩阵
\newcommand{\adj}{^*}
\newcommand{\vector}[1]{\overrightarrow{#1}}
% \newcommand{\wavy}[1]{\overset\sim#1}	% \tilde 或 \widetilde 不明显, 容易与 \bar 或 \overline 混淆
\newcommand{\wavy}[1]{\widetilde{#1}}

% 序列
\newcommand{\ccdots}{\cdot\cdots\cdot}
\newcommand{\oneton}{1,2,\cdots,n}
\newcommand{\oneto}[1]{1,2,\cdots,#1}

\newcommand{\ssto}[3]{#1_1 #3 #1_2 #3 \cdots #3 #1_{#2}}
\newcommand{\ssup}[3]{#1^1 #3 #1^2 #3 \cdots #3 #1^{#2}}
\newcommand{\soneto}[2]{\ssto{#1}{#2}{,}}
\newcommand{\splus}[2]{\ssto{#1}{#2}{+}}

% 括号
\newcommand{\aqty}[1]{\expval{#1}}
\newcommand{\pbqty}[1]{\left(#1\right]}
\newcommand{\bpqty}[1]{\left[#1\right)}
\newcommand{\floor}[1]{\left\lfloor#1\right\rfloor}
\newcommand{\ceil}[1]{\left\lceil#1\right\rceil}

% 矩阵宏简写
\newcommand{\bmatrix}[1]{\begin{bmatrix}#1\end{bmatrix}}
\newcommand{\Bmatrix}[1]{\begin{Bmatrix}#1\end{Bmatrix}}
\newcommand{\vmatrix}[1]{\begin{vmatrix}#1\end{vmatrix}}
\newcommand{\Vmatrix}[1]{\begin{Vmatrix}#1\end{Vmatrix}}

% 常用微分
\newcommand{\dx}{\dd{x}}
\newcommand{\dy}{\dd{y}}
\newcommand{\dz}{\dd{z}}
\newcommand{\dt}{\dd{t}}
\newcommand{\ds}{\dd{s}}
\newcommand{\dr}{\dd{r}}

% 一般的微分
% 如果只使用 \dd{x}\dd{y} 的话, 中间会有多余的间隔.
\newcommand{\df}{\dd}
\newcommand{\ddf}[2]{\,\mathrm{d}#1\mathrm{d}#2}	% 微分形式 differential form
\newcommand{\dddf}[3]{\,\mathrm{d}#1\mathrm{d}#2\mathrm{d}#3}

% 高阶微分
\newcommand{\dxdy}{\ddf{x}{y}}
\newcommand{\dydz}{\ddf{y}{z}}
\newcommand{\dzdx}{\ddf{z}{x}}
\newcommand{\dudv}{\ddf{u}{v}}
\newcommand{\drdt}{\ddf{r}{\theta}}
\newcommand{\dxdydz}{\dddf{x}{y}{z}}

% 矩阵的宏指令
\newcommand{\pmcmn}[3]{\begin{pmatrix}
	#1_{11} & #1_{12} & \cdots & #1_{1#3} \\
	#1_{21} & #1_{22} & \cdots & #1_{n#3} \\
	\vdots & \vdots && \vdots \\
	#1_{#2 1} & #1_{#2 2} & \cdots & #2_{n#3} \\
\end{pmatrix}}

\newcommand{\pmc}[1]{\pmcmn{#1}{n}{n}}
\newcommand{\pvcn}[2]{\begin{pmatrix}
	#1_1 \\ #1_2 \\ \vdots \\ #1_{#2}
\end{pmatrix}}

\newcommand{\pvc}[1]{\pvcn{#1}{n}}
\newcommand{\pto}{\overset{P}{\to}}

% 函数名
\renewcommand{\char}{\operatorname{char}}	% 由于已存在此命令, 不可使用 DeclareMathOperator
\renewcommand{\r}{\operatorname{r}}
\DeclareMathOperator{\st}{s.t.\,}	% 虽然不是函数名, 但用了这个指令就放这儿了.
\DeclareMathOperator{\diag}{diag}	% 不需要定义太多, 一个文件里用到什么定义什么,
\DeclareMathOperator{\Ker}{Ker}		% 毕竟特殊的函数名太多太多了.
\DeclareMathOperator{\Aut}{Aut}		% 便捷与效率的权衡.
\DeclareMathOperator{\Inn}{Inn}
\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\SL}{SL}
\DeclareMathOperator{\stab}{stab}
\DeclareMathOperator{\orb}{orb}
\DeclareMathOperator{\lcm}{lcm}
\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator{\Cov}{Cov}
\DeclareMathOperator{\Corr}{Corr}
\DeclareMathOperator{\rot}{rot}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\Outer}{Outer}
\DeclareMathOperator{\Even}{Even}
\DeclareMathOperator{\Scalar}{Scalar}
\DeclareMathOperator{\Vector}{Vector}
\DeclareMathOperator{\arsh}{arsh}
\DeclareMathOperator{\arch}{arch}
\DeclareMathOperator{\arth}{arth}
\renewcommand{\Re}{\operatorname{Re}}	% 自带 \Re 的效果是 \mathrm{Re}, 前后无空格, 故重写
\renewcommand{\Im}{\operatorname{Im}}

% 运算符
% 可以用 \bigcap, \bigcup, \bigoplus, \bigotimes 替代
\newcommand{\capop}{\displaystyle\mathop\cap\limits}
\newcommand{\cupop}{\displaystyle\mathop\cup\limits}
\newcommand{\oplusop}{\mathop\oplus\limits}
\newcommand{\otimesop}{\mathop\otimes\limits}
\newcommand{\bigoplusop}{\mathop\bigoplus\limits}
\newcommand{\bigotimesop}{\mathop\bigotimes\limits}

% 积分
\newcommand{\dint}{\displaystyle\int}
\newcommand{\inti}{\dint_{-\infty}^{+\infty}}
\newcommand{\intoi}{\dint_0^{+\infty}}

\newcommand{\intl}{\displaystyle\int\limits}
\newcommand{\iintl}{\displaystyle\iint\limits}
\newcommand{\iiintl}{\displaystyle\iiint\limits}

% 求和
\newcommand{\dsum}{\displaystyle\sum}
\newcommand{\csum}[1]{\dsum_{#1=1}^\infty}
\newcommand{\nsum}{\csum{n}}
\newcommand{\ksum}{\csum{k}}
\newcommand{\nosum}{\dsum_{n=0}^\infty}
\newcommand{\insum}{\dsum_{i=1}^n}
\newcommand{\knsum}{\dsum_{k=1}^n}

% 求积
\newcommand{\dprod}{\displaystyle\prod}
\newcommand{\nprod}{\dprod_{n=1}^\infty}
\newcommand{\noprod}{\dprod_{n=0}^\infty}
\newcommand{\inprod}{\dprod_{i=1}^n}

% 极限
\newcommand{\liml}{\lim\limits}
\newcommand{\ulim}{\overline\lim\limits_{n\to\infty}}
\newcommand{\dlim}{\underline\lim\limits_{n\to\infty}}
% 注意这里的 d 是 down, 而不是 displaystyle

\newcommand{\xlim}{\lim\limits_{x\to x_0}}
\newcommand{\nlim}{\lim\limits_{n\to\infty}}
\newcommand{\clim}[1]{\lim\limits_{#1\to\infty}}

% 差分
\newcommand{\DD}{\Delta}
\newcommand{\DV}[2]{\dfrac{\DD#1}{\DD#2}}
\newcommand{\nDV}[3]{\dfrac{\DD^{#1}#2}{\DD#3^{#1}}}

% 求导
\newcommand{\ddv}{\displaystyle\dv}
\newcommand{\dpdv}{\displaystyle\pdv}

% 缩写
\newcommand{\bm}[1]{\boldsymbol{#1}}
\newcommand{\LRA}{\Leftrightarrow}
\newcommand{\RLA}{\Leftrightarrow}
\newcommand{\LA}{\Leftarrow}
\newcommand{\RA}{\Rightarrow}

\newcommand{\lra}{\leftrightarrow}
\newcommand{\rla}{\leftrightarrow}
\newcommand{\la}{\leftarrow}
\newcommand{\ra}{\rightarrow}

\newcommand{\QRLA}{\quad\RLA\quad}
\newcommand{\QRA}{\quad\RA\quad}
\newcommand{\LLRA}{\Longleftrightarrow}

\newcommand{\QNRA}{\quad\nRightarrow\quad}
\newcommand{\qnra}{\quad\nrightarrow\quad}

\newcommand{\wt}{\widetilde}

% 图形符号
\newcommand{\qed}{\quad\square}
\renewcommand{\parallel}{\mathrel{/\mskip-2.5mu/}}
\newcommand{\paralleleq}{\hspace{0.5em}{^{^{\parallel}}}\hspace{-1.04em}=}
\newcommand{\rt}{\matrm{Rt}\triangle}
$$

[TOC]

## 第 1 章	几何和复算术

### 1.1	复数的性质

#### 1.1.1	复数的运算

见[复分析笔记](../复分析/复分析.html#11-复数代数).

##### 1	几何解释

- 复数加法: 平移变换.
- 复数乘法: 伸缩旋转.
  - 不用三角恒等式证明复数乘法的几何法则: 考虑变换 $ z \mapsto \i z $, 构造直角.

##### 2	指数加减

$$
\begin{align}
\e^{\i \theta} + \e^{\i \phi} &= 2 \cos \dfrac{\theta - \phi}{2} \cdot \e^{\tfrac{\i (\theta + \phi)}{2}}, \\
\e^{\i \theta} - \e^{\i \phi} &= 2\i \sin \dfrac{\theta - \phi}{2} \cdot \e^{\tfrac{\i (\theta + \phi)}{2}}.
\end{align}
$$

<div style="background-color: #f3f2ee">
    <details>
        <summary><b>证明</b>
        </summary>
        <iframe src="ifsrc\1.1.1 指数加减.html" height=225></iframe>
    </details>
</div>

#### 1.1.2	前置的知识

<div style="border-left: 4px solid #dfe2e5; padding: 0 15px; color: #777777; padding-right: 0;">这部分是为了求出本初单位根的个数, 以及推导分圆多项式相关的几个公式而学的, 跳过对复分析的理解影响不大. <a href="#113">空降下一节</a></div>

**定义 1 (莫比乌斯函数)**	将 $ n $ 质因数分解为 $ p_1^{\alpha_1} p_2^{\alpha_2} \cdots p_k^{\alpha_k}, \alpha_i \ge 1 $, 定义 **莫比乌斯函数** 为:
$$
% 设置
\newcommand{\aneg}[1]{\hspace{-0.75em}&#1&\hspace{-0.75em}}
\newcommand{\aneq}{\aneg{=}}
% 上述指令用于在使用 array 环境时调整等号左右间距
\newcommand{\eqs}{\quad\;}
% 上述指令用于 align 环境中, &= 的换行对齐时调整第二行位置
\renewcommand{\d}{\displaystyle}

% 字符
\renewcommand{\i}{\mathrm{i}}
\renewcommand{\j}{\mathrm{j}}
\renewcommand{\k}{\mathrm{k}}
\newcommand{\e}{\textup{e}}
\newcommand{\ve}{\varepsilon}
\newcommand{\Beta}{\mathit{B}}
\newcommand{\omicron}{\mathit{o}}
\newcommand{\Omicron}{\mathit{O}}

% 原本的定义为:
% \newcommand{\cal}[1]{\mathcal{#1}}
\renewcommand{\cal}[1]{\mathcal#1}
\renewcommand{\scr}[1]{\mathscr#1}
\renewcommand{\frak}[1]{\mathfrak#1}
\newcommand{\bb}[1]{\mathbb#1}

% 数集
\newcommand{\D}{\mathbb{D}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\J}{\mathbb{J}}
\newcommand{\K}{\mathbb{K}}
\renewcommand{\L}{\mathbb{L}}

% 上下标
\newcommand{\trans}{^\mathrm{T}}
\newcommand{\inv}{^{-1}}
\newcommand{\madj}[1]{^{\pqty{#1^*}}}	% m 重伴随矩阵
\newcommand{\adj}{^*}
\newcommand{\vector}[1]{\overrightarrow{#1}}
\newcommand{\wavy}[1]{\overset\sim#1}	% \tilde 或 \widetilde 不明显, 容易与 \bar 或 \overline 混淆

% 序列
\newcommand{\ccdots}{\cdot\cdots\cdot}
\newcommand{\oneton}{1,2,\cdots,n}
\newcommand{\oneto}[1]{1,2,\cdots,#1}

\newcommand{\ssto}[3]{#1_1 #3 #1_2 #3 \cdots #3 #1_{#2}}
\newcommand{\ssup}[3]{#1^1 #3 #1^2 #3 \cdots #3 #1^{#2}}
\newcommand{\soneto}[2]{\ssto{#1}{#2}{,}}
\newcommand{\splus}[2]{\ssto{#1}{#2}{+}}

% 括号
\newcommand{\aqty}[1]{\expval{#1}}
\newcommand{\pbqty}[1]{\left(#1\right]}
\newcommand{\bpqty}[1]{\left[#1\right)}
\newcommand{\floor}[1]{\left\lfloor#1\right\rfloor}
\newcommand{\ceil}[1]{\left\lceil#1\right\rceil}

% 矩阵宏简写
\newcommand{\bmatrix}[1]{\begin{bmatrix}#1\end{bmatrix}}
\newcommand{\Bmatrix}[1]{\begin{Bmatrix}#1\end{Bmatrix}}
\newcommand{\vmatrix}[1]{\begin{vmatrix}#1\end{vmatrix}}
\newcommand{\Vmatrix}[1]{\begin{Vmatrix}#1\end{Vmatrix}}

% 常用微分
\newcommand{\dx}{\dd{x}}
\newcommand{\dy}{\dd{y}}
\newcommand{\dz}{\dd{z}}
\newcommand{\dt}{\dd{t}}
\newcommand{\ds}{\dd{s}}
\newcommand{\dr}{\dd{r}}

% 一般的微分
% 如果只使用 \dd{x}\dd{y} 的话, 中间会有多余的间隔.
\newcommand{\df}{\dd}
\newcommand{\ddf}[2]{\,\mathrm{d}#1\mathrm{d}#2}	% 微分形式 differential form
\newcommand{\dddf}[3]{\,\mathrm{d}#1\mathrm{d}#2\mathrm{d}#3}

% 高阶微分
\newcommand{\dxdy}{\ddf{x}{y}}
\newcommand{\dydz}{\ddf{y}{z}}
\newcommand{\dzdx}{\ddf{z}{x}}
\newcommand{\dudv}{\ddf{u}{v}}
\newcommand{\drdt}{\ddf{r}{\theta}}
\newcommand{\dxdydz}{\dddf{x}{y}{z}}

% 矩阵的宏指令
\newcommand{\pmcmn}[3]{\begin{pmatrix}
	#1_{11} & #1_{12} & \cdots & #1_{1#3} \\
	#1_{21} & #1_{22} & \cdots & #1_{n#3} \\
	\vdots & \vdots && \vdots \\
	#1_{#2 1} & #1_{#2 2} & \cdots & #2_{n#3} \\
\end{pmatrix}}

\newcommand{\pmc}[1]{\pmcmn{#1}{n}{n}}
\newcommand{\pvcn}[2]{\begin{pmatrix}
	#1_1 \\ #1_2 \\ \vdots \\ #1_{#2}
\end{pmatrix}}

\newcommand{\pvc}[1]{\pvcn{#1}{n}}
\newcommand{\pto}{\overset{P}{\to}}

% 函数名
\renewcommand{\char}{\operatorname{char}}	% 由于已存在此命令, 不可使用 DeclareMathOperator
\renewcommand{\r}{\operatorname{r}}
\DeclareMathOperator{\st}{s.t.\,}	% 虽然不是函数名, 但用了这个指令就放这儿了.
\DeclareMathOperator{\diag}{diag}	% 不需要定义太多, 一个文件里用到什么定义什么,
\DeclareMathOperator{\Ker}{Ker}		% 毕竟特殊的函数名太多太多了.
\DeclareMathOperator{\Aut}{Aut}		% 便捷与效率的权衡.
\DeclareMathOperator{\Inn}{Inn}
\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\SL}{SL}
\DeclareMathOperator{\stab}{stab}
\DeclareMathOperator{\orb}{orb}
\DeclareMathOperator{\lcm}{lcm}
\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator{\Cov}{Cov}
\DeclareMathOperator{\Corr}{Corr}
\DeclareMathOperator{\rot}{rot}
\DeclareMathOperator{\sgn}{sgn}
\renewcommand{\Re}{\operatorname{Re}}	% 自带 \Re 的效果是 \mathrm{Re}, 前后无空格, 故重写
\renewcommand{\Im}{\operatorname{Im}}

\def\arsh{\ensuremath{\operatorname{arsh}}}
\def\arch{\ensuremath{\operatorname{arch}}}
\def\arth{\ensuremath{\operatorname{arth}}}

% 运算符
% 可以用 \bigcap, \bigcup, \bigoplus, \bigotimes 替代
\newcommand{\capop}{\displaystyle\mathop\cap\limits}
\newcommand{\cupop}{\displaystyle\mathop\cup\limits}
\newcommand{\oplusop}{\mathop\oplus\limits}
\newcommand{\otimesop}{\mathop\otimes\limits}
\newcommand{\bigoplusop}{\mathop\bigoplus\limits}
\newcommand{\bigotimesop}{\mathop\bigotimes\limits}

% 积分
\newcommand{\dint}{\displaystyle\int}
\newcommand{\inti}{\dint_{-\infty}^{+\infty}}
\newcommand{\intoi}{\dint_0^{+\infty}}

\newcommand{\intl}{\displaystyle\int\limits}
\newcommand{\iintl}{\displaystyle\iint\limits}
\newcommand{\iiintl}{\displaystyle\iiint\limits}

% 求和
\newcommand{\dsum}{\displaystyle\sum}
\newcommand{\csum}[1]{\dsum_{#1=1}^\infty}
\newcommand{\nsum}{\csum{n}}
\newcommand{\ksum}{\csum{k}}
\newcommand{\nosum}{\dsum_{n=0}^\infty}
\newcommand{\insum}{\dsum_{i=1}^n}
\newcommand{\knsum}{\dsum_{k=1}^n}

% 求积
\newcommand{\dprod}{\displaystyle\prod}
\newcommand{\nprod}{\dprod_{n=1}^\infty}
\newcommand{\noprod}{\dprod_{n=0}^\infty}
\newcommand{\inprod}{\dprod_{i=1}^n}

% 极限
\newcommand{\liml}{\lim\limits}
\newcommand{\ulim}{\overline\lim\limits_{n\to\infty}}
\newcommand{\dlim}{\underline\lim\limits_{n\to\infty}}
% 注意这里的 d 是 down, 而不是 displaystyle

\newcommand{\xlim}{\lim\limits_{x\to x_0}}
\newcommand{\nlim}{\lim\limits_{n\to\infty}}
\newcommand{\clim}[1]{\lim\limits_{#1\to\infty}}

% 差分
\newcommand{\DD}{\Delta}
\newcommand{\DV}[2]{\dfrac{\DD#1}{\DD#2}}
\newcommand{\nDV}[3]{\dfrac{\DD^{#1}#2}{\DD#3^{#1}}}

% 求导
\newcommand{\ddv}{\displaystyle\dv}
\newcommand{\dpdv}{\displaystyle\pdv}

% 缩写
\newcommand{\bm}[1]{\boldsymbol{#1}}
\newcommand{\LRA}{\Leftrightarrow}
\newcommand{\RLA}{\Leftrightarrow}
\newcommand{\LA}{\Leftarrow}
\newcommand{\RA}{\Rightarrow}

\newcommand{\lra}{\leftrightarrow}
\newcommand{\rla}{\leftrightarrow}
\newcommand{\la}{\leftarrow}
\newcommand{\ra}{\rightarrow}

\newcommand{\QRLA}{\quad\RLA\quad}
\newcommand{\QRA}{\quad\RA\quad}
\newcommand{\LLRA}{\Longleftrightarrow}

\newcommand{\QNRA}{\quad\nRightarrow\quad}
\newcommand{\qnra}{\quad\nrightarrow\quad}

\newcommand{\wt}{\widetilde}

% 图形符号
\newcommand{\qed}{\quad\square}
\renewcommand{\parallel}{\mathrel{/\mskip-2.5mu/}}
\newcommand{\paralleleq}{\hspace{0.5em}{^{^{\parallel}}}\hspace{-1.04em}=}
\newcommand{\rt}{\matrm{Rt}\triangle}

% 分块矩阵
\newenvironment{mat}[1]{
	\begin{array}{#1}
}{
	\end{array}
}

\newenvironment{pmat}[1]{
	\left( \begin{array}{#1}
}{
	\end{array} \right)
}

\newenvironment{bmat}[1]{
	\left[ \begin{array}{#1}
}{
	\end{array} \right]
}

\newenvironment{Bmat}[1]{
	\left\{ \begin{array}{#1}
}{
	\end{array} \right\}
}

\newenvironment{vmat}[1]{
	\left\lvert \begin{array}{#1}
}{
	\end{array} \right\rvert
}

\newenvironment{Vmat}[1]{
	\left\lVert \begin{array}{#1}
}{
	\end{array} \right\rVert
}



\mu(n) := \begin{cases}
	0, & \exist i: \alpha_i \ge 2, \\
	(-1)^k, & \forall i: \alpha_i = 1.
\end{cases}
$$

**备注**	当 $ n = 1 $ 时, $ k = 0 $, 则 $ \alpha_i $ 的集合为空集, 由于假命题可以推出任何命题, $ (\forall x \in \varnothing: x = 1) $ 是真命题, 从而 $ \mu(1) = 1 $, 可以不用额外定义.

---

**定义 2 (单位数论函数)**	并称 $ I(n) = S(n) = \dsum_{d \mid n} \mu(d) $ 为 **单位数论函数**.

**备注**	定义域为正整数、陪域为复数的函数称为 **数论函数** (**算术函数**). 单位数论函数命名的缘由可以参考定理 8.

---

**定理 1**	单位数论函数可表示为
$$
\begin{align}
S(n) &= \sum_{d \mid n} \mu(d)
= \sum_{d \mid n} \mu\pqty{\dfrac{n}{d}}
\\
&= \floor{\dfrac{1}{n}} = \begin{cases}
	1, & n = 1, \\
	0, & n > 1.
\end{cases}
\end{align}
$$
**证明**	$ d \mid n \Leftrightarrow \dfrac{n}{d} \mid n $, 故等式第一行成立, 下证第二行.

1. 当 $ n = 1 $ 时, $ S(1) = \mu(1) = 1 $.
2. 当 $ n > 1 $ 时, $ S(n) = \dsum_{i = 1}^k \mathrm{C}_k^i (-1)^i = (1-1)^k = 0 $.

**推论**	$ [\gcd(i, j) = 1] = \dsum_{d \mid \gcd(i, j)} \mu(d) $, 这个看似无用的结论将在后文求解欧拉函数时用到.

**备注**	$ \dsum_{d \mid n} f(d) = \dsum_{d \mid n} f\pqty{\dfrac{n}{d}} $ 这个显然的事实很有用.

---

**定理 2 (莫比乌斯反演定理)**
$$
F(n) = \dsum_{d \mid n} f(d)
\QRLA
f(n) = \dsum_{d \mid n} F\pqty{\dfrac{n}{d}} \mu(d).
$$
**证明**

1. 充分性

$$
\begin{align}
\dsum_{d \mid n} \mu(d) F\pqty{\dfrac{n}{d}}
&= \dsum_{d \mid n} \mu(d) \dsum_{i \mid \frac{n}{d}} f(i)
= \dsum_{id \mid n} \mu(d) f(i)
\\
&= \dsum_{i \mid n} f(i) \dsum_{d \mid \frac{n}{i}} \mu(d)
= \dsum_{i \mid n} f(i) S\pqty{\dfrac{n}{i}}
= f(n).
\end{align}
$$

2. 必要性

$$
\begin{align}
\dsum_{d \mid n} f(d)
% &= \dsum_{d \mid n} f\pqty{\dfrac{n}{d}}
% = \dsum_{d \mid n} \dsum_{i \mid \tfrac{n}{d}} \mu(i) F\pqty{\dfrac{n}{id}}
% \\
% &= \dsum_{i \mid n} \dsum_{d \mid \tfrac{n}{i}} \mu(i) F\pqty{\dfrac{n}{id}}
% \\
&= \dsum_{d \mid n} \dsum_{i \mid d} F(i) \mu\pqty{\dfrac{d}{i}}
= \dsum_{i \mid d, d \mid n} F(i) \mu\pqty{\dfrac{d}{i}}
\\
&= \dsum_{i \mid n} \dsum_{i \mid d, \frac{d}{i} \mid \frac{n}{i}} F(i) \mu\pqty{\dfrac{d}{i}}
= \dsum_{i \mid n} F(i) S\pqty{\dfrac{n}{i}} = F(n).
\end{align}
$$

**备注**	上述交换求和的方式称为富比尼原理.

---

**定理 3 (莫比乌斯反演定理的乘积形式)**
$$
F(n) = \dprod_{d \mid n} f(d)
\QRLA
f(n) = \dprod_{d \mid n} F(d)^{\mu\pqty{\tfrac{n}{d}}}.
$$
**证明**

1. 充分性

$$
\begin{align}
\dprod_{d \mid n} F(d)^{\mu\pqty{\frac{n}{d}}}
&= \dprod_{d \mid n} F\pqty{\dfrac{n}{d}}^{\mu\pqty{d}}
= \prod_{d \mid n} \prod_{i \mid \frac{n}{d}} f(i)^{\mu(d)}
= \dprod_{id \mid n} f(i)^{\mu(d)}
\\
&= \prod_{i \mid n} \prod_{d \mid \frac{n}{i}} f(i)^{\mu(d)}
= \prod_{i \mid n} f(i)^{S\pqty{\frac{n}{i}}}
= f(n).
\end{align}
$$

2. 必要性

$$
\begin{align}
\prod_{d \mid n} f(d)
&= \prod_{d \mid n} \prod_{i \mid d} F(i)^{\mu\pqty{\frac{d}{i}}}
= \prod_{i \mid n} \prod_{i \mid d, \frac{d}{i} \mid \frac{n}{i}} F(i)^{\mu\pqty{\frac{d}{i}}}
\\
&= \prod_{i \mid n} F(i)^{\sum \mu\pqty{\frac{d}{i}}}
= \prod_{i \mid n} F(i)^{S\pqty{\frac{n}{i}}} = f(n)
\end{align}
$$

---

**推论**	若 $ F(n) = \dsum_{n \mid m} f(m) $, 则 $ f(n) = \dsum_{n \mid d} \mu\pqty{\dfrac{d}{n}} F(d) $.

**证明**
$$
\begin{align}
\dsum_{n \mid d} \mu\pqty{\dfrac{d}{n}} F(d)
&= \dsum_{n \mid d} \mu\pqty{\dfrac{d}{n}} \dsum_{d \mid i} f(i)
= \dsum_{n \mid i} f(i) \dsum_{d' \mid \tfrac{i}{n}} \mu(d')
\\
&= \dsum_{n \mid i} f(i) S\pqty{\dfrac{i}{n}} = f(n)
\end{align}
$$

---

**定理 4 (富比尼原理的应用)**	
$$
\dsum_{d = 1}^n \mu(d) \floor{\dfrac{n}{d}} = 1.
$$
**证明**
$$
\begin{align}
\dsum_{d = 1}^n \mu(d) \floor{\dfrac{n}{d}}
&= \dsum_{d = 1}^n \mu(d)
\dsum_{d \mid l, l \le n} 1
= \dsum_{l = 1}^n \dsum_{d \mid l} \mu(d)
= 1.
\end{align}
$$

---

**定理 5 (欧拉函数的性质)**	
$$
\varphi(n) = n\dsum_{d \mid n} \dfrac{\mu(d)}{d}.
$$
**证明**
$$
\begin{align}
\varphi(n) &= \dsum_{m \le n, (m, n) = 1} 1
= \dsum_{m = 1}^n \dsum_{d \mid (m, n)}\mu(d)
\\
&= \dsum_{d \mid n} \mu(d) \dsum_{d \mid m, m \le n} 1
= \dsum_{d \mid n} \dfrac{n}{d} \mu(d).
\end{align}
$$
**推论**	将 $ n $ 质因数分解为 $ p_1^{\alpha_1} p_2^{\alpha_2} \cdots p_k^{\alpha_k}, \alpha_i \ge 1 $, 则
$$
\begin{align}
\varphi(n) &= n \dsum_{d \mid p_1^{\alpha_1} \cdots p_k^{\alpha_k}} \dfrac{\mu(d)}{d}
= n \dsum_{d \mid p_1 \cdots p_k} \dfrac{\mu(d)}{d}.
\end{align}
$$

---

**定理 6 (欧拉函数的计算)**	将 $ n $ 质因数分解为 $ p_1^{\alpha_1} p_2^{\alpha_2} \cdots p_k^{\alpha_k}, \alpha_i \ge 1 $, 则
$$
\varphi(n) = n \prod_{i = 1}^k \pqty{1 - \dfrac{1}{p_i}}
= \prod_{i = 1}^k p_i^{\alpha_i - 1} \pqty{p_i - 1}.
$$
**证明**	显然. 但我不知道如何由定理 5 推得.

---

**定义 3 (狄利克雷卷积)**	$ (f * g) (n) := f(n) * g(n) := \dsum_{d \mid n} f(d) g\pqty{\dfrac{n}{d}} $.

**备注**	另一常用形式是 $ f(n) * g(n) = \dsum_{ab = n} f(a) g(b) $.

---

**定理 7**	狄利克雷卷积满足 **交换律** 和 **结合律**.

**证明**	交换律由定理 1 的备注即得, 下证结合律.
$$
\begin{align}
f(n) * [g(n) * h(n)]
&= \dsum_{ad = n} f(a) \dsum_{bc = d} g(b) h(c)
= \dsum_{abc = n} f(a) g(b) h(c)
\\
&= \dsum_{dc = n} \pqty{
	\dsum_{ab = d} f(a) g(b)
} h(c)
= [f(n) * g(n)] * h(n).
\end{align}
$$

---

**定理 8**	单位数论函数是卷积单位元, 即
$$
f(n) * I(n) = I(n) * f(n) = f(n).
$$
**证明**
$$
f(n) * I(n) = \dsum_{d \mid n} f(d) I\pqty{\dfrac{n}{d}}
= \dsum_{d \mid n} f(d) \floor{\dfrac{d}{n}} = f(n).
$$
**备注**	可利用狄利克雷卷积证明莫比乌斯反演公式.

---

**定义 4 (狄利克雷逆)**	若数论函数满足 $ f * g = g * f = I $, 则称 $f$ 和 $g$ 互为对方的 **狄利克雷逆**.

**备注**	后文的 $ f\inv $ 一律指狄利克雷逆; 在代数中 $ f\inv $ 一般指逆函数; 在分析中 $ f\inv $ 一般指倒数.

**例子**

- $ \mu\inv(n) = U(n) \equiv 1 $.
- $ \varphi\inv(n) = \dsum_{d \mid n} d \mu(d) $.

---

**定理 9**	狄利克雷卷积在 $ G = \Bqty{f(n) \mid f\ 是数论函数, 且\ f(1) \ne 0} $ 上构成阿贝尔群.

**证明**	由上可知, 该代数系统是封闭的、结合的、交换的, 且具有幺元, 下证逆元存在.

由定义代入 $ n = 1 $ 得 $ f\inv(1) = \dfrac{1}{f(1)} $, 将此式代入定义, 得
$$
f\inv(n) = \dfrac{-1}{f(1)} \dsum_{d \mid n, d < n} f\pqty{\dfrac{n}{d}} f\inv(d),\quad (n > 1)
$$
因此狄利克雷逆元存在且唯一, 因此 $ \aqty{G, *} $ 是阿贝尔群.

**备注**	进一步, $ \aqty{G, +, *} $ 还是阿贝尔环.

---

**定理 10**	若数论函数 $ f(n), g(n) $ 满足 $ f(1) \ne 0, g(1) \ne 0 $, 则
$$
(f * g)\inv = f\inv * g\inv.
$$
**证明**	$ f\inv * (f * g) = I * g = g $, 这是阿贝尔群的直接推论.

---

**定义 5 (积性函数)**	若任意 $ \gcd(m, n) = 1 $, 有 $ f(mn) = f(m) f(n) $, 则数论函数 $ f(n) $ 称为 **积性函数**.

**定义 6 (完全积性函数)**	若 $ \forall m, n \in \Z $, 有 $ f(mn) = f(m) f(n) $, 则称数论函数 $ f(n) $ 为 **完全积性函数**.

**例子**

- 积性函数: $ \mu(n) $, $ \varphi(n) $, $ \sigma_\lambda(n) $.
- 非积性函数
  - 冯·曼戈尔特函数: 当 $ n $ 是质数 $p$ 的整数幂时 $ \Lambda(n) = \ln(p) $, 否则 $ \Lambda(n) = 0 $.
  - 不大于正整数 $n$ 的质数的数量 $ \pi(n) $.
  - 整数拆分的数目 $ P(n) $.

---

**定理 11 (积性函数的性质)**

1. 若积性函数 $ f(n) $ 非恒等于 0, 则 $ f(1) = 1 $.
2. 若 $ f(n) $ 和 $ g(n) $ 都是积性函数, 则 $ f(n) * g(n) $ 也是积性函数.
3. 若 $ f(n) $ 是积性函数, 则 $ f\inv(n) $ 也是积性函数.
4. 若 $ f(n) * g(n) $ 和 $ g(n) $ 都是积性函数, 则 $ f(n) $ 也是积性函数.

**证明**

1. 记 $ f(a) \ne 0 $, 则由 $ f(1) f(a) = f(a) $ 可推出 $ f(1) = 1 $.

2. $$
   \begin{align}
   (f*g)(mn) &= \dsum_{d \mid mn} f(d) g\pqty{\dfrac{mn}{d}}
   = \dsum_{a \mid m, b \mid n} f(ab) g\pqty{\dfrac{mn}{ab}}
   \\
   &= \pqty{
   	\dsum_{a \mid m} f(a) g\pqty{\dfrac{m}{a}}
   } \pqty{
   	\dsum_{b \mid n} f(b) g\pqty{\dfrac{n}{b}}
   } \\
   &= [(f*g)(m)] \cdot [(f*g)(n)].
   \end{align}
   $$

3. 利用递推表达式, 使用数学归纳法.

   1. 当 $ mn = 1 $ 时, $ f\inv(1) = \dfrac{1}{f(1)} = 1 $.

   2. 当 $ mn > 1 $ 时,
      $$
      \begin{align}
      f\inv(mn) &= \dfrac{-1}{f(1)} \dsum_{d \mid mn, d < mn} f\pqty{\dfrac{mn}{d}} f\inv(d)
      \\
      &= -\dsum_{a \mid m, b \mid n, ab < mn} f\pqty{\dfrac{m}{a}} f\inv(a) f\pqty{\dfrac{n}{b}} f\inv(b)
      \\
      &= -\pqty{
      	\dsum_{a \mid m, a < m} \dsum_{b \mid n, b < n} + \dsum_{a = m, b \mid n, b < n} + \dsum_{b = n, a \mid m, a < m}
      } \\ &\quad\quad\quad
      f\pqty{\dfrac{m}{a}} f\inv(a) f\pqty{\dfrac{n}{b}} f\inv(b)
      \\
      &= - \bqty{
      	f\inv(m) f\inv (n) - f\inv(m) f\inv (n) - f\inv(m) f\inv (n)
      } \\
      &= f\inv(m) f\inv (n).
      \end{align}
      $$

4. 由 $ f = (f*g) * g\inv $ 知其为积性函数.

#### 1.1.3	本初单位根

<span id="113">记</span> $n$ 次单位根为 $ \omega_n = \e^{\tfrac{2\pi\i}{n}} $, 若其集合 $ S_n = \Bqty{\omega_n^k \mid k \in \Z_n} $ 可由 $ \omega_k $ 生成, 即 $ S_n = \aqty{\omega_k} $, 则称 $ \omega_n^k $ 为**本初 $\bm n$ 次单位根** (或 $n$ 次本原单位根).

- 当且仅当 $ \gcd(k, n) = 1 $ 时, $ \omega_n^k $ 为本初 $n$ 次单位根.

- 若 $ \omega $ 是一个本初 $n$ 次单位根, 则

  - 它的复共轭 $ \overline\omega $ 也是本初 $n$ 次单位根.
  - 当且仅当 $ \gcd(m, n) = 1, 1 \le m < n $ 时, $ \omega^m $ 也是本初 $n$ 次单位根.
  - $ \mathrm{Gal} (\Q(\omega) / \Q) \cong U(n) $.

- 本初 $n$ 次单位根的个数为欧拉函数 $ \varphi(n) $.

  - 将 $n$ 质因数分解为 $ p_1^{\alpha_{p_1}} p_2^{\alpha_{p_2}} \cdots p_k^{\alpha_{p_k}} $, 则

    $ \varphi(n) = \dprod_{p \mid n} p^{\alpha_p - 1} (p - 1) = n \dprod_{p \mid n} \pqty{1 - \dfrac{1}{p}} $.

  - 关于欧拉函数更多的性质可以参考[前置知识](# 1.1.2	前置的知识).

#### 1.1.4	分圆多项式

根为所有本初 $n$ 次单位根的最小多项式为 $ \varPhi_n(z) $, 称为 **$ \bm n $ 阶分圆多项式**.

- 例子

  - $ \varPhi_1(z) = z - 1 $.
  - $ \varPhi_2(z) = z + 1 $.
  - $ \varPhi_3(z) = z^2 + z + 1 $.
  - $ \varPhi_4(z) = z^2 + 1 $.
  - $ \varPhi_6(z) = z^2 - z + 1 $.
  - $ \varPhi_{8}(z) = (z^2 + \sqrt 2 z + 1)(z^2 - \sqrt 2 z + 1) = z^4 + 1 $.
  - $ \varPhi_{12}(z) = (z^2 + \sqrt 3 z + 1)(z^2 - \sqrt 3 z + 1) = z^4 - z^2 + 1 $.

- 次数与系数

  - 由本初单位根性质得, $ \varPhi_n(z)\ (n > 2) $ 次数必为偶数, 且有实系数.
  - 进一步, $ \varPhi_n(z) $ 是整系数不可约多项式, 且 $ \deg(\varPhi_n(z)) = \varphi(n) $.
  - 推论: $ \cos\dfrac{2\pi}{n} $ 是有理数, 当且仅当 $ n = 1, 2, 3, 4, 6 $.

- $ \dprod_{d \mid n} \varPhi_d(z) = z^n - 1 $.

  - 特殊值

    - 数归可得 $ \varPhi(0) = 1\ (n > 1) $.

    - 若 $ n = p^m $, 则 $ \varPhi_{n}(1) = p $.

      否则 $ \varPhi_{n}(1) = 1 $.

    - 由下文可知, $ \varPhi_n(-1) = \varphi_{2n}(1) $.

  - 欧拉函数

    - 比较两端次数可得 $ \dsum_{d \mid n} \varphi(d) = n $.

    - 由莫比乌斯反演公式得: $ \varphi(n) = n \dsum_{d \mid n} \dfrac{\mu(d)}{d} $.

      <span style="border-left: 4px solid #dfe2e5; padding: 0 15px; color: #777777; padding-right: 0;">[前置知识](#) 1.1.2	前置的知识中提供了另一种证法.</span>

  - 分圆多项式

    - 由莫比乌斯反演公式得 $ \varPhi_n(z) = \dprod_{d \mid n} (z^d - 1)^{\mu\pqty{\tfrac{n}{d}}} $.
    - 进一步, 质因数分解后有 $ \varPhi_n(z) = \dprod_{d \mid p_1p_2\cdots p_k} \pqty{z^{\tfrac{n}{d}} - 1}^{\mu(d)} $.

- 若 $ p $ 为素数, 则

  - $ \varPhi_p(z) = \dfrac{z^p - 1}{z - 1} = 1 + z + z^2 + \cdots + z^{p-1} $.

  - 比较次数与根, 得
    - $ \varPhi_{2n}(z) = \varPhi_n(-z)\ (n > 1) $.

    - $ \varPhi_{p^k}(z) = \varPhi_p(z^{p^{k-1}}) $.

  - 进一步, 若 $ p \nmid n $, 则
    - $ \varPhi_{pn}(z) = \varPhi_n(z^p) / \varPhi_n(z) $.
    - $ \varPhi_{p^k n}(z) = \varPhi_n(z^{p^k}) / \varPhi_n(z^{p^{k-1}}) $.

  - 由此可以由容斥原理同样推得 $ \varPhi_n(z) = \dprod_{d \mid p_1p_2\cdots p_k} \pqty{z^{\tfrac{n}{d}} - 1}^{\mu(d)} $.

- 设 $ d $ 是 $n$ 的真因子, $p$ 为素数, 若存在 $ x \ne \pm 1 $, 满足 $ p \mid (\varPhi_d(x), \varPhi_n(x)) $, 则 $ p \mid n $.

<div style="background-color: #f3f2ee">
    <details>
        <summary>证明
        </summary>
        <iframe src="ifsrc\1.1.3 分圆多项式的一个定理.html" height=150></iframe>
    </details>
</div>

- 若存在整数 $x$ 满足 $ (\varPhi_a(x), \varPhi_b(x)) > 1 $, 则 $ \dfrac{a}{b} $ 是一个素数幂.

### 1.2	复数的变换

#### 1.2.1	保向变换

- **恒等变换**: $ \mathcal{E} (z) = z $.

- **平移变换**: $ \mathcal{T}_v (z) = z + v $.

  - 复合: $ \mathcal{T}_w \circ \mathcal{T}_v = \mathcal{T}_{w + v} $.
  - 逆元: $ \mathcal{T}_v\inv = \mathcal{T}_{-v} $.

- **旋转变换**: $ \mathcal{R}_a^\theta $.

  - 复合: $ \mathcal{R}_a^\phi \circ \mathcal{R}_a^\theta = \mathcal{R}_a^{\phi + \theta} $.

  - 逆元: $ (\mathcal{R}_a^\theta)\inv = \mathcal{R}_a^{-\theta} $.

  - 分解:

    - $ \mathcal{R}_a^\theta(z)
      = (\mathcal{T}_a \circ \mathcal{R}_0^\theta \circ \mathcal{T}_a\inv)(z)
      = \e^{\i \theta} (z - a) + a $.
    - $ \mathcal{R}_a^\theta
      = \cal T_k \circ \cal R_0^\theta $, 其中  $ k = a (1 -\e^{\i\theta}) $.

  - 复合:

    - $ \cal T_v \circ \cal R_a^\theta = \cal R_c^\theta $, 其中 $ c = a + \dfrac{v}{1 - \e^{\i\theta}} $.

    - $ \cal R_a^\theta \circ \cal T_v = \cal R_c^\theta $, 其中 $ c = a + \dfrac{v \e^{\i\theta}}{1 - \e^{\i\theta}} $.

    - $ (\cal R_b^\beta \circ \cal R_a^\alpha)(z) = \e^{\i (\alpha + \beta)} z + a (1 - \e^{\i\alpha}) \e^{\i \beta} + b(1 - \e^{\i\beta}) $.

      - 当 $ \alpha + \beta \ne 2k\pi $ 时, $ \cal R_b^\beta \circ \cal R_a^\alpha = \cal R_c^{\alpha + \beta} $, 其中 $ c = \dfrac{a (1 - \e^{\i\alpha}) \e^{\i \beta} + b(1 - \e^{\i\beta})}{1 - \e^{\i (\alpha + \beta)}} $.
      - 当 $ \alpha + \beta = 2k\pi $ 时, $ \cal R_b^\beta \circ \cal R_a^\alpha = \cal T_k $. 其中 $ k = (b - a) (1 - \e^{\i\beta}) $.

      <span style="border-left: 4px solid #dfe2e5; padding: 0 15px; color: #777777; padding-right: 0;">上式可推广至 n 次旋转的组合, 不再赘述.</span>


#### 1.2.2	反向变换

- **反射变换**: $ \frak R_L $. (非分式线性变换)
  - 逆元: $ \frak R_L\inv = \frak R_L $.
  - 复合
    - 若 $ L_1 $ 与 $L_2$ 交于点 $O$, 夹角为 $ \phi $, 则 $ \frak R_{L_2} \circ \frak R_{L_1} = \cal R_o^{2\phi} $.
    - 若 $ L_1 $ 与 $L_2$ 平行, 由 $L_1$ 垂直连接到 $L_2$ 的向量为 $V$, 则 $ \frak R_{L_2} \circ \frak R_{L_1} = \cal T_{2V} $.
  - 对合 (自逆): $ \frak R_L \circ \frak R_L = \cal E $.
- **滑动反射**: $ \cal T_v \circ \frak R_L = \frak R_L \circ \cal T_v $.


#### 1.2.3	相似变换

- **中心伸缩 (位似变换)**: $ \cal D_a^r %= \cal D_a^{r, 0} $.

- **伸缩旋转 (相似变换)**: $ \cal D_a^{r, \theta} \equiv \cal R_a^\theta \circ \cal D_a^r \equiv \cal D_a^r \circ \cal R_a^\theta $.
  - 复合: $ \cal D_o^{R, \phi} \circ \cal D_o^{r, \theta} = \cal D_o^{r, \theta} \circ \cal D_o^{R, \phi} = \cal D_o^{Rr, \theta + \phi} $.
  - 逆元: $ (\cal D_a^{r, \theta})\inv = \cal D_a^{1 / r, -\theta} $.

  - 分解
    - $ \cal D_a^{r, \theta}(z) = (\cal T_a \circ \cal D_o^{r, \theta} \circ \cal T_a\inv) (z) = r\e^{\i\theta} (z - a) + a $.
    - $ \cal D_a^{r, \theta} = \cal T_k \circ \cal D_o^{r, \theta} $, 其中 $ k = a (1 - r\e^{\i\theta}) $.

  - 复合
    - $ (\cal D_b^{R, \beta} \circ \cal D_a^{r, \alpha})(z) = Rr \e^{\i(\alpha + \beta)} + a(1 - r\e^{\i\alpha}) \e^{\i\beta} + b(1 - R\e^{\i\beta}) $.
      - 当 $ r\e^{\i(\alpha + \beta)} \ne 0 $ 时, $ \cal D_b^{R, \beta} \circ \cal D_a^{r, \alpha} = \cal D_c^{Rr, \alpha + \beta} $, 其中 $ c = \dfrac{a (1 - r\e^{\i\alpha}) R\e^{\i \beta} + b(1 - R\e^{\i\beta})}{1 - Rr\e^{\i (\alpha + \beta)}} $.
      - 当 $ r\e^{\i(\alpha + \beta)} = 0 $ 时, $ \cal D_b^{R, \beta} \circ \cal D_a^{r, \alpha} = \cal T_k $, 其中 $ k = a(\e^{\i\beta} - r) + b(1 - R\e^{\i\beta}) $.

- [几何反演](# 3.2.2	几何反演)

### 1.3	复数的应用

#### 1.3.1	几何

##### 1	三角函数

- $ \cos n\theta = \Re{(\e^{\i \theta})^n} %,\, \sin n\theta = \Im{(\e^{\i \theta})^n} $, 从而可以用 $ \cos\theta,\, \sin\theta $ 表示.

- $ \cos^n \theta = \pqty{\dfrac{\e^{\i\theta} + \e^{-\i\theta}}{2}}^n $, 从而可以用 $ \cos k\theta,\, \sin k\theta $ 表示.

- $ \tan n\theta = \arg(1 + \i\tan\theta)^n % \dfrac{\Im{(1 + \i\tan\theta)^n}}{\Re{(1 + \i\tan\theta)^n}} $, 从而可以用 $ \tan\theta $ 表示.

  <span style="border-left: 4px solid #dfe2e5; padding: 0 15px; color: #777777; padding-right: 0;">也可以用欧拉公式求出正余弦的 $ n $ 倍角公式, 再推得正切的.</span>

---

$$
\insum \cos(an + b) = \dfrac{
	\sin\pqty{
		a_n + \cfrac{a}{2}
	} - \sin\pqty{
		\cfrac{a}{2} + b
	}
}{
	2 \sin\cfrac{a}{2}
} \\
\insum \sin(an + b) = \dfrac{
	\cos\pqty{
		a_n + \cfrac{a}{2}
	} - \cos\pqty{
		\cfrac{a}{2} + b
	}
}{
	-2 \sin\cfrac{a}{2}
}
$$

法一: 积化和差, 裂项相消.

法二: 化为复数, 等比求和.

##### 2	欧氏几何

**Thebault 第一问题**: 在任意一个四边形的四个边上各做一个正方形, 则连接相对的正方形中心的线段互相垂直等长.

![image-20230112150354010](image/1.3.3 Thebault 第一问题.png)

<div style="background-color: #f3f2ee">
    <details>
        <summary>证法一 (复数法)
        </summary>
        <iframe src="ifsrc\1.3.1 Thebault 第一问题-证法一.html" height=300></iframe>
    </details>
</div>


<div style="background-color: #f3f2ee">
    <details>
        <summary>证法二 (变换法)
        </summary>
        <iframe src="ifsrc\1.3.1 Thebault 第一问题-证法二.html" height=500></iframe>
    </details>
</div>


---

对于任意三角形, 各边向外做一个等边三角形,则这些等边三角形重心成一等边三角形.

<img src="image\1.3.1 三角形与正三角形.png" width=250>

---

若 $ A, B, C, D $ 为单位圆上的四点, 且 $ A + B + C + D = 0 $, 则该四点必成一矩形.

<div style="background-color: #f3f2ee">
    <details>
        <summary>证明
        </summary>
        <iframe src="ifsrc\1.3.1 四点成矩形.html" height=100></iframe>
    </details>
</div>


##### 3	平面向量

- $ \bm a \cdot \bm b := \vqty{a} \cdot \vqty{b} \cos \theta $.
- $ \bm a \cp \bm b := \vqty{a} \cdot \vqty{b} \sin\theta = -(\bm b \cp \bm a) $.
- $ \overline a b = \bm a \cdot \bm b + \i (\bm a \cp \bm b) $.

#### 1.3.2	代数

##### 1	因式分解

<div style="background-color: #f3f2ee">
    <details>
        <summary>实系数多项式可以分解为实线性因式和实二次因式.
        </summary>
        <iframe src="ifsrc\1.3.2 实系数多项式因式分解.html" height=270></iframe>
    </details>
</div>


##### 2	恒等式

若两个整数可写成两个平方之和, 则其积亦然, 因为
$$
\vqty{(a + \i b) (c + \i d)}^2
% = (a^2 + b^2) (c^2 + d^2)
= \vqty{(ac - bd) + \i (ad + bc)}^2.
$$

##### 3	高斯系鞋带定理

记任意的 $n$ 边形各个顶点为 $ a_i,\, i = \oneton $, 并且令 $ a_{n+1} = a_1 $, 则其面积为
$$
\begin{align}
\cal A &= \sum_{i=1}^n \dfrac{\bm a_i \cp \bm a_{i+1}}{2}
= \Im \insum \dfrac{\overline a_i a_{i+1}}{2}
= \insum \dfrac{x_i y_{i+1} - x_{i+1} y_i}{2}.
\end{align}
$$

#### 1.3.3	分析

##### 1	求导

由 $ \ddv[n]{t} \e^{(a + \i b) t}
= (a + \i b)^n \e^{(a + \i b) t} $ 得,

- $ \ddv[n]{t} \pqty{
  	\e^{at} \sin bt
  } = (a^2 + b^2)^{\tfrac{n}{2}}
  \e^{at} \sin\pqty{
  	bt + n \arctan\dfrac{b}{a}
  } $.
- $ \ddv[n]{t} \pqty{
  	\e^{at} \cos bt
  } = (a^2 + b^2)^{\tfrac{n}{2}}
  \e^{at} \cos\pqty{
  	bt + n \arctan\dfrac{b}{a}
  }  $.

##### 2	积分

由 $ \dint \e^{(a + \i b) x} \dx = \dfrac{a - \i b}{a^2 + b^2} \e^{(a + \i b) x} + C $ 得,

- $ \dint \e^{ax} \cos bx \dx = \dfrac{a \cos bx + b \sin bx}{a^2 + b^2} \e^{ax} + C $.
- $ \dint \e^{ax} \sin bx \dx = \dfrac{a \sin bx - b \cos bx}{a^2 + b^2} \e^{ax} + C $.

#### 1.3.4	组合

由 $ (a + b)^n = \dsum_{r=0}^n \dbinom{n}{r} a^{n-r} b^r $ 代入 $ a = 1, b = \i, n = 2m $ 得

- $ \d \binom{2m}{1} - \binom{2m}{3} + \binom{2m}{5} - \cdots + (-1)^{m+1} \binom{2m}{2m-1} = 2^m \sin\dfrac{m\pi}{2} $.
- $ \d\binom{2m}{0} - \binom{2m}{2} + \binom{2m}{4} - \cdots + (-1)^{m} \binom{2m}{2m} = 2^m \cos\dfrac{m\pi}{2} $.

### 1.4	变换与几何

- **运动**: 运动就是平面到其自身的一个映射且使任两点 $ A, B $ 的距离与其象 $ A' = \cal M(A) $, $ B' = \cal M(B) $ 的距离相等.

  - 满足群的条件: 封闭性, 结合律, 幺元 (恒等变换), 逆元.
  - 分类: 保向运动, 反向运动.
  - 性质
    - 一个运动可以由它对任意三角形（即任意三个非共线的点）的 效果唯一确定.
    - 恰好存在一个保向运动 $ \cal M $（以及恰好一个反向运动 $ \widetilde {\cal M} $）将一 已给线段 $AB$ 映为另一个等长线段 $A'B'$. 此外, $ \widetilde {\cal M} $ 即（${\cal M}$ 再继以对 $A'B'$ 的一个反射）.
    - 每个保向运动都可以表示为 $ \cal M(z) = \e^{\i \theta} z + v $.

- **全等**: 如果存在一个运动 $ \cal M $, 使得 $ F' = \cal M(F) $, 就说 $ F $ 全等于 $ F' $, 记作 $ F \cong F' $.

  - 满足等价关系： 反身性, 对称性, 传递性.

- **三反射定理**

  - 每个保向运动均为两个反射的复合,
  - 每个反向运动均为三个反射的复合.
  - 推论: 每个运动都有一个逆, 因为一串反射的逆就是把这些反射以相反的次序再做一次.

- **相似**: 把一平面映至自身且保持距离之比的映射.

  <span style="border-left: 4px solid #dfe2e5; padding: 0 15px; color: #777777; padding-right: 0;">几何学就是研究运动的集合的不变式 (不变量). ——克莱因</span>

  - 任一相似必可分解为 $ \cal S^r = \cal M \circ \cal D_p^r $.

  - 分类: 保向相似, 反向相似.

  - 每个保向相似都是一个伸缩旋转, 其特例是平移 (以无穷远点为旋转中心).

    <span style="border-left: 4px solid #dfe2e5; padding: 0 15px; color: #777777; padding-right: 0;">一组平行线交于同一无穷远点, 所有平行线对应的无穷远点构成无穷远线.</span>

  - 每个保向的相似变换均可表示为 $ \cal{S}^r(z) = r\e^{\i\theta} z + v $, 或 $ \cal S^r(z) = A z + B $.

- **空间复数**

  - 空间中的每一个保向相似变换均为一伸缩旋转与沿旋转轴的平移的复合.
  - 空间中的旋转是<span style="color: blueviolet">非交换</span>的.

### 1.5	多项式方程

#### 1.5.2	二次方程

**思路一**: 配方法

对于 $ ax^2 + bx + c = 0 $, 有 $ \pqty{x + \dfrac{b}{2a}}^2 = \dfrac{b^2 - 4ac}{4a} $, 于是 $ x_1, x_2 = \dfrac{-b \pm \sqrt{b^2 - 4ac}}{2a} $.

---

**思路二**: 韦达定理

对于 $ x^2 - \sigma_1 x + \sigma_2 = 0 $, 令 $ \delta = x_1 - x_2 $, 则有
$$
\begin{cases}
	x_1 + x_2 = \sigma_1, \\
	(x_1 - x_2)^2 = \sigma_1^2 - 4 \sigma_2.
\end{cases}
$$
解之即得 $ x_1, x_2 $.

---

**判别法则**

由思路一, 令 $ \Delta = b^2 - 4ac $, 则有

- 当 $ \Delta < 0 $ 时, 有两个共轭复根.
- 当 $ \Delta = 0 $ 时, 有一个二重实根.
- 当 $ \Delta > 0 $ 时, 有两个一重实根.

#### 1.5.3	三次方程

对于 $ ax^3 + bx^2 + cx + d = 0 $, 令 $ t = x + \dfrac{b}{3a} $ 即可化为 $ t^3 + Bt + C = 0 $.

方便起见, 下面只研究 $ x^3 = 3px + 2q $. 习惯上, 令 $ \omega_n = \e^\tfrac{2\pi\i}{n} $, $ \omega = \omega_3 $.

**思路一**: 变量代换

1. 令 $ x_0 = s + t $, 则当 $ st = p $ 且 $ s^3 + t^3 = 2q $ 时, 此 $x_0$ 为三次方程之根.
2. 解得 $ s^3, t^3 = q \pm \sqrt{q^2 - p^3} $, 从而求出三次方程的三根: $ \begin{cases}
   	x_0 = s + t, \\
   	x_1 = \omega s + \omega^2 t, \\
   	x_2 = \omega^2 s + \omega t.
   \end{cases} $ 

---

**思路二**: 三角换元

1. 代入 $ x = 2\sqrt p \cos\theta $, 即得 $ 4\cos^3\theta - 3 \cos\theta = \cos 3\theta = \dfrac{q}{p\sqrt p} $.
2. 于是 $ x = 2\sqrt p \cos\dfrac{\phi + 2k\pi}{3} $, 其中 $ \phi = \arccos\cfrac{q}{p\sqrt p} $.

**注**: 思路一和思路二的公式本质上是一样的, 其中 $ \arg s^3 = \phi,\, \vqty{s^3} = p \sqrt p $.

---

**思路三**: 减少对称 $ S_3 \to C_3 \to \Bqty{e} $ 

对于 $ x^3 - \sigma_1 x^3 + \sigma_2 x - \sigma_3 = 0 $, 其中 $ \sigma_k $ 为初等对称多项式, 令
$$
\begin{cases}
	X_1 = (x_1 + \omega x_2 + \omega^2 x_3)^3, \\
	X_2 = (x_1 + \omega^2 x_2 + \omega x_3)^3.
\end{cases}
$$
则 $ X_1 $ 和 $ X_2 $ 都是轮换对称多项式, 且
$$
\begin{cases}
	X_1 + X_2 = 2\sigma_1^3 - 9\sigma_1 \sigma_2 + 27\sigma_3, \\
	X_1 \cdot X_2 = (\sigma_1^2 - 3\sigma_2)^3
\end{cases}
\hspace{2em}
\begin{cases}
	x_1 + \omega x_2 + \omega^2 x_3 = \sqrt[3]{X_1}, \\
	x_1 + \omega^2 x_2 + \omega x_3 = \sqrt[3]{X_2}, \\
	x_1 + x_2 + x_3 = \sigma_1.
\end{cases}
$$
解之即得 $ x_1, x_2, x_3 $.

---

**判别法则**

结合思路一与思路二可得, 对于实系数三次方程,

- 当 $ 0 \le q^2 < p^3 $ 时, 有三个不等实根.
- 当 $ q^2 = p^3 \ne 0 $ 时, 有三个实根, 其中两个相等.
- 当 $ q = p = 0 $ 时, 有三个相等的实根.
- 当 $ 0 \le p^3 < q^2 $ 时, 有一个实根, 两个共轭虚根.

#### 1.5.3	四次方程

**思路一**: 费拉里法

对于 $ x^4 + bx^3 + cx^2 + dx + e = 0 $, 先消去三次项再配方, 则等价于
$$
\pqty{
	x^2 + \dfrac{1}{2} b x + y
}^2 = \pqty{
	\dfrac{1}{4} b^2 - c + 2y
} x^2 + \pqty{
	\dfrac{1}{2} by - d
} x + y^2 - e,
$$
令右式关于 $x$ 的判别式为零, 即解关于 $y$ 的三次方程, 即得关于 $x$ 的两个二次方程, 解之即得原方程的四个根.

---

**思路二**: 欧拉解法

消去三次项, 并将 $ x^4 + cx^2 + dx + e = 0 $ 因式分解为
$$
(x^2 + p_1 x + q_1) (x^2 + p_2 x + q_2) = 0,
$$
待定系数法解三次方程即得上述系数, 从而得四次方程的四根.

---

**思路三**: 变量代换

对于 $ x^4 + cx^2 + dx + e = 0 $, 作 $ x = u + v + w $, 则当
$$
\begin{cases}
	u^2 + v^2 + w^2 = -\dfrac{c}{2}, \\
	u^2 v^2 + v^2 w^2 + w^2 u^2 = \dfrac{c^2 - 4e}{16},
	\\
	uvw = -\dfrac{q}{8}.
\end{cases}
$$
时, 等式成立, 并且上述方程组的解即三次方程的解. 于是解 $ u, v, w $ 即得 $x$.

---

**思路四**: 减少对称 $ S_4 \to D_2 \to \Bqty{e} $ 

对于 $ x^4 - \sigma_1 x^3 + \sigma_2 x^2 - \sigma_3 x + \sigma_4 = 0 $, 其中 $ \sigma_k $ 为初等对称多项式,
$$
\begin{cases}
	W_1 := x_1 x_2 + x_3 x_4, \\
	W_2 := x_1 x_3 + x_2 x_4, \\
	W_3 := x_1 x_4 + x_2 x_3. \\
\end{cases}
\QRA
\begin{cases}
	h_1 := W_1 + W_2 + W_3 = \sigma_2, \\
	h_2 := W_1 W_2 + W_2 W_3 + W_3 W_1 = \sigma_1 \sigma_3 - 4\sigma_4, \\
	h_3 := W_1 W_2 W_3 = \sigma_1^2 \sigma_4 + \sigma_3^2 - 4 \sigma_2 \sigma_4.
\end{cases}
$$
$ W_1, W_2, W_3 $ 即为 $ W^3 - h_1 W^2 + h_2 W - h_3 = 0 $ 的解, 于是有
$$
\begin{array}{l}
	\begin{cases}
		(x_1 x_2) + (x_3 x_4) = W_1, \\
		(x_1 x_2) (x_3 x_4) = \sigma_4, \\
	\end{cases}
	\\
	\begin{cases}
		(x_1 + x_2) + (x_3 + x_4) = \sigma_1, \\
		(x_1 + x_2) (x_3 + x_4) = W_2 + W_3, \\
	\end{cases}
\end{array}
\QRA
\begin{array}{l}
	\begin{cases}
		x_1 x_2, \\
		x_1 + x_2.
	\end{cases}
	\\
	\begin{cases}
		x_3 x_4, \\
		x_3 + x_4.
	\end{cases}
\end{array}
\QRA
\begin{cases}
	x_1, \\ x_2, \\ x_3, \\ x_4.
\end{cases}
$$

---

**判别法则**

对于 $ ax^4 + 4bx^3 + 6cx^2 + 4dx + e = 0 $, 令:
$$
\begin{align}
& H=b^2-a c, I=a e-4 b d+3 c^2, \\
& G=a^2 d-3 a b c+2 b^3, J=\frac{4 H^3-a^2 H I-G^2}{a^3}, \\
& \Delta=I^3-27 J^2, \delta=12 H^2-a^2 I.
\end{align}
$$
那么有如下根的判别法则:

- 若 $\Delta<0$ ，则方程有两个互异实根和一对共轭虚根。
- 若 $\Delta>0, \delta>0, H>0$ ，则方程有四个互异实根。
- 若 $\Delta>0, H \leqslant 0$ 或 $\delta<0$ ，则方程有两对互异的共轭虚根。
- 若 $\Delta=0, I \cdot J \neq 0, \delta>0, H>0$ ，则方程有一个两重实根和两个单重实根。
- 若 $\Delta=0, I \cdot J \neq 0, H \leqslant 0$ 或 $\delta<0$ ，则方程有一个两重实根和一对共轭虚根。
- 若 $G \neq 0, I=J=0$ ，则方程有一个三重实根和一个单重实根。
- 若 $G=\delta=0, H>0$ ，则方程有两个互异的两重实根。
- 若 $G=\delta=0, H<0$ ，则方程有一对两重共轭虚根。
- 若 $H=I=G=0$ ，则方程有一个四重实根。



## 第 2 章	作为变换的复函数

- 图像的描述
  - 至象平面的几何变换.
  - 向量场.
  - 黎曼曲面.
  - 模曲面.
- **卡西尼曲线**: 到两点距离乘积为常数的曲线.
  - 映射 $ z \mapsto w = Q(z) = (z - a_1)(z - a_2) + c $ 将卡西尼曲线族映为同心圆.
  - 特例: **伯努利双纽线**: $ r^2 = 2\cos 2\theta $.
  - 与 **帕修斯螺旋截线** 相同.

<div>
    <button id="btn-k4kffjta">
        点击查看 Geogebra 图像
    </button>
    &emsp;或直接打开<a href="https://www.geogebra.org/calculator/k4kffjta">网页链接</a>
    <iframe src="" width="800" height="0" allowfullscreen style="border: 1px solid #e4e4e4;border-radius: 4px;" frameborder="0" id="ifm-k4kffjta"></iframe>
    <script>
        var src_k4kffjta = "https://www.geogebra.org/calculator/k4kffjta";
        var btnId_k4kffjta = "#btn-k4kffjta";
        var ifmId_k4kffjta = "#ifm-k4kffjta";
        var btn_k4kffjta = document.querySelector(btnId_k4kffjta);
        var ifm_k4kffjta = document.querySelector(ifmId_k4kffjta);
        btn_k4kffjta.onclick = () => {
            if (btn_k4kffjta.innerHTML == "点击查看 Geogebra 图像") {
                btn_k4kffjta.innerHTML = "点击关闭 Geogebra 图像";
                ifm_k4kffjta.setAttribute("src", src_k4kffjta);
                ifm_k4kffjta.setAttribute("height", "600");
            } else {
                btn_k4kffjta.innerHTML = "点击查看 Geogebra 图像";
                ifm_k4kffjta.setAttribute("src", "");
                ifm_k4kffjta.setAttribute("height", "0");
            }
        }
    </script>
</div>

- 余弦函数的图像
  - $ y = -c $ 在映射 $ z \mapsto \cos z $ 下变成椭圆 $ (a\cos t, b \sin t) $, 其中 $ a = \cosh c,\, b = \sinh c $, 并且焦点的模 $ \sqrt{a^2 - b^2} = 1 $.
  - $ x = c $ 在映射 $ z \mapsto \cos z $ 下变成双曲线.
- 多值函数
  - 若 $z$ 至少绕 $q$ 转 $N$ 圈才能第一次重回 $ f(z) $, 则 $q$ 称为 $ n - 1 $ 阶**代数支点**. 一阶代数支点称为简单支点. 如果无论绕多少周, 也无法重回原来的值, 则称为**对数支点**.

---

- 概念

  - 质心 $ Z = \dfrac{\sum m_i z_i}{\sum m_i} $.
    - 若 $ Z $ 为 $ \Bqty{z_j} $ 的质心, 则 $ \Bqty{az_j + b} $ 的质心是 $ aZ + b $.
    - 质心 $Z$ 必位于凸包 $H$ 的内域.
  - 形心 $ Z = \dfrac{1}{n} \insum z_i $
    - $ \insum (z_i - Z) = 0 $.
  - 函数 $ f(z) $ 在 $n$ 个点的集合 $ \Bqty{z_i} $ 上的平均值记作 $ \aqty{f(z)}_n = \dfrac{1}{n} \insum f(z_i) $.

- **在正多边形上求平均**: 若 $ n > m > 0 $, 以 $k$ 为中心的正 $n$ 边形顶点为 $ \Bqty{z_i} $, 则 $ \aqty{P_m(z)}_n = P_m(k) $.

- **在圆周上平均值**: 一个任意次多项式在圆周 $C$ 上的平均值都等于它在 $C$ 的中心 处的值.

- **高斯平均值定理**: 若 $ f(z) $ 可表示为一幂级数, 且一个以 $k$ 为中心, $R$ 为半径的圆周 $C$ 位于次幂级数的收敛圆盘内, 则 $ \aqty{f(z)}_C = \dfrac{1}{2\pi} \dint_0^{2\pi} f(k + R\e^{\i\theta}) \dd{\theta} = f(k) $.

  - 令 $ f(z) = \e^z $, 则有
    $$
    \begin{align}
    & \dint_0^{2\pi} \e^{r\cos\theta} \cos (r\sin\theta) \dd{\theta} = 2\pi
    \\
    & \dint_0^{2\pi} \e^{r\cos\theta} \sin(r\sin\theta) \dd{\theta} = 0
    \end{align}
    $$

  - 令 $ f(z) = \cos z $, 则有
    $$
    \begin{align}
    & \dint_0^{2\pi} \cos(r\cos\theta) \cosh(r\sin\theta) \dd{\theta} = 2\pi,
    \\
    & \dint_0^{2\pi} \sin(r\cos\theta) \sinh(r\sin\theta) \dd{\theta} = 0.
    \end{align}
    $$

