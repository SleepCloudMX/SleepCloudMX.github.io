<h1 align="center">几何学-黎曼几何与罗氏几何</h1>

$$
% 设置
\newcommand{\aneg}[1]{\hspace{-0.75em}&#1&\hspace{-0.75em}}
\newcommand{\aneq}{\aneg{=}}
% 上述指令用于在使用 array 环境时调整等号左右间距
\newcommand{\eqs}{\quad\;}
% 上述指令用于 align 环境中, &= 的换行对齐时调整第二行位置
\renewcommand{\d}{\displaystyle}

% 字符
\renewcommand{\i}{\mathrm{i}}
\renewcommand{\j}{\mathrm{j}}
\renewcommand{\k}{\mathrm{k}}
\newcommand{\e}{\textup{e}}
\newcommand{\ve}{\varepsilon}
\newcommand{\Beta}{\mathit{B}}
\newcommand{\omicron}{\mathit{o}}
\newcommand{\Omicron}{\mathit{O}}

% 原本的定义为:
% \newcommand{\cal}[1]{\mathcal{#1}}
\newcommand{\bm}[1]{\boldsymbol{#1}}
\renewcommand{\cal}[1]{\mathcal#1}
\renewcommand{\scr}[1]{\mathscr#1}
\renewcommand{\frak}[1]{\mathfrak#1}
\newcommand{\bb}[1]{\mathbb#1}

% 数集
\newcommand{\D}{\mathbb{D}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\J}{\mathbb{J}}
\newcommand{\K}{\mathbb{K}}
\renewcommand{\L}{\mathbb{L}}

% 上下标
\newcommand{\trans}{^\mathrm{T}}
\newcommand{\inv}{^{-1}}
\newcommand{\madj}[1]{^{\pqty{#1^*}}}	% m 重伴随矩阵
\newcommand{\adj}{^*}
\newcommand{\vector}[1]{\overrightarrow{#1}}
\newcommand{\wavy}[1]{\overset\sim#1}	% \tilde 或 \widetilde 不明显, 容易与 \bar 或 \overline 混淆

% 序列
\newcommand{\ccdots}{\cdot\cdots\cdot}
\newcommand{\oneton}{1,2,\cdots,n}
\newcommand{\oneto}[1]{1,2,\cdots,#1}

\newcommand{\ssto}[3]{#1_1 #3 #1_2 #3 \cdots #3 #1_{#2}}
\newcommand{\ssup}[3]{#1^1 #3 #1^2 #3 \cdots #3 #1^{#2}}
\newcommand{\soneto}[2]{\ssto{#1}{#2}{,}}
\newcommand{\splus}[2]{\ssto{#1}{#2}{+}}

% 括号
\newcommand{\aqty}[1]{\expval{#1}}
\newcommand{\pbqty}[1]{\left(#1\right]}
\newcommand{\bpqty}[1]{\left[#1\right)}
\newcommand{\floor}[1]{\left\lfloor#1\right\rfloor}
\newcommand{\ceil}[1]{\left\lceil#1\right\rceil}

% 矩阵宏简写
\newcommand{\bmatrix}[1]{\begin{bmatrix}#1\end{bmatrix}}
\newcommand{\Bmatrix}[1]{\begin{Bmatrix}#1\end{Bmatrix}}
\newcommand{\vmatrix}[1]{\begin{vmatrix}#1\end{vmatrix}}
\newcommand{\Vmatrix}[1]{\begin{Vmatrix}#1\end{Vmatrix}}

% 常用微分
\newcommand{\dx}{\dd{x}}
\newcommand{\dy}{\dd{y}}
\newcommand{\dz}{\dd{z}}
\newcommand{\dt}{\dd{t}}
\newcommand{\ds}{\dd{s}}
\newcommand{\dr}{\dd{r}}

% 一般的微分
% 如果只使用 \dd{x}\dd{y} 的话, 中间会有多余的间隔.
\newcommand{\df}{\dd}
\newcommand{\ddf}[2]{\,\mathrm{d}#1\mathrm{d}#2}	% 微分形式 differential form
\newcommand{\dddf}[3]{\,\mathrm{d}#1\mathrm{d}#2\mathrm{d}#3}

% 高阶微分
\newcommand{\dxdy}{\ddf{x}{y}}
\newcommand{\dydz}{\ddf{y}{z}}
\newcommand{\dzdx}{\ddf{z}{x}}
\newcommand{\dudv}{\ddf{u}{v}}
\newcommand{\drdt}{\ddf{r}{\theta}}
\newcommand{\dxdydz}{\dddf{x}{y}{z}}

% 矩阵的宏指令
\newcommand{\pmcmn}[3]{\begin{pmatrix}
	#1_{11} & #1_{12} & \cdots & #1_{1#3} \\
	#1_{21} & #1_{22} & \cdots & #1_{n#3} \\
	\vdots & \vdots && \vdots \\
	#1_{#2 1} & #1_{#2 2} & \cdots & #2_{n#3} \\
\end{pmatrix}}

\newcommand{\pmc}[1]{\pmcmn{#1}{n}{n}}
\newcommand{\pvcn}[2]{\begin{pmatrix}
	#1_1 \\ #1_2 \\ \vdots \\ #1_{#2}
\end{pmatrix}}

\newcommand{\pvc}[1]{\pvcn{#1}{n}}
\newcommand{\pto}{\overset{P}{\to}}

% 函数名
\renewcommand{\char}{\operatorname{char}}	% 由于已存在此命令, 不可使用 DeclareMathOperator
\renewcommand{\r}{\operatorname{r}}
\DeclareMathOperator{\st}{s.t.\,}	% 虽然不是函数名, 但用了这个指令就放这儿了.
\DeclareMathOperator{\diag}{diag}	% 不需要定义太多, 一个文件里用到什么定义什么,
\DeclareMathOperator{\Ker}{Ker}		% 毕竟特殊的函数名太多太多了.
\DeclareMathOperator{\Aut}{Aut}		% 便捷与效率的权衡.
\DeclareMathOperator{\Inn}{Inn}
\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\SL}{SL}
\DeclareMathOperator{\stab}{stab}
\DeclareMathOperator{\orb}{orb}
\DeclareMathOperator{\lcm}{lcm}
\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator{\Cov}{Cov}
\DeclareMathOperator{\Corr}{Corr}
\DeclareMathOperator{\rot}{rot}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\Outer}{Outer}
\DeclareMathOperator{\Even}{Even}
\DeclareMathOperator{\Scalar}{Scalar}
\DeclareMathOperator{\Vector}{Vector}
\DeclareMathOperator{\arsh}{arsh}
\DeclareMathOperator{\arch}{arch}
\DeclareMathOperator{\arth}{arth}
\renewcommand{\Re}{\operatorname{Re}}	% 自带 \Re 的效果是 \mathrm{Re}, 前后无空格, 故重写
\renewcommand{\Im}{\operatorname{Im}}

% 运算符
% 可以用 \bigcap, \bigcup, \bigoplus, \bigotimes 替代
\newcommand{\capop}{\displaystyle\mathop\cap\limits}
\newcommand{\cupop}{\displaystyle\mathop\cup\limits}
\newcommand{\oplusop}{\mathop\oplus\limits}
\newcommand{\otimesop}{\mathop\otimes\limits}
\newcommand{\bigoplusop}{\mathop\bigoplus\limits}
\newcommand{\bigotimesop}{\mathop\bigotimes\limits}

% 积分
\newcommand{\dint}{\displaystyle\int}
\newcommand{\inti}{\dint_{-\infty}^{+\infty}}
\newcommand{\intoi}{\dint_0^{+\infty}}

\newcommand{\intl}{\displaystyle\int\limits}
\newcommand{\iintl}{\displaystyle\iint\limits}
\newcommand{\iiintl}{\displaystyle\iiint\limits}

% 求和
\newcommand{\dsum}{\displaystyle\sum}
\newcommand{\csum}[1]{\dsum_{#1=1}^\infty}
\newcommand{\nsum}{\csum{n}}
\newcommand{\ksum}{\csum{k}}
\newcommand{\nosum}{\dsum_{n=0}^\infty}
\newcommand{\insum}{\dsum_{i=1}^n}
\newcommand{\knsum}{\dsum_{k=1}^n}

% 求积
\newcommand{\dprod}{\displaystyle\prod}
\newcommand{\nprod}{\dprod_{n=1}^\infty}
\newcommand{\noprod}{\dprod_{n=0}^\infty}
\newcommand{\inprod}{\dprod_{i=1}^n}

% 极限
\newcommand{\liml}{\lim\limits}
\newcommand{\ulim}{\overline\lim\limits_{n\to\infty}}
\newcommand{\dlim}{\underline\lim\limits_{n\to\infty}}
% 注意这里的 d 是 down, 而不是 displaystyle

\newcommand{\xlim}{\lim\limits_{x\to x_0}}
\newcommand{\nlim}{\lim\limits_{n\to\infty}}
\newcommand{\clim}[1]{\lim\limits_{#1\to\infty}}

% 差分
\newcommand{\DD}{\Delta}
\newcommand{\DV}[2]{\dfrac{\DD#1}{\DD#2}}
\newcommand{\nDV}[3]{\dfrac{\DD^{#1}#2}{\DD#3^{#1}}}

% 求导
\newcommand{\ddv}{\displaystyle\dv}
\newcommand{\dpdv}{\displaystyle\pdv}

% 缩写
\newcommand{\LRA}{\Leftrightarrow}
\newcommand{\RLA}{\Leftrightarrow}
\newcommand{\LA}{\Leftarrow}
\newcommand{\RA}{\Rightarrow}

\newcommand{\lra}{\leftrightarrow}
\newcommand{\rla}{\leftrightarrow}
\newcommand{\la}{\leftarrow}
\newcommand{\ra}{\rightarrow}

\newcommand{\QRLA}{\quad\RLA\quad}
\newcommand{\QRA}{\quad\RA\quad}
\newcommand{\LLRA}{\Longleftrightarrow}

\newcommand{\QNRA}{\quad\nRightarrow\quad}
\newcommand{\qnra}{\quad\nrightarrow\quad}

\newcommand{\wt}{\widetilde}

% 图形符号
\newcommand{\qed}{\quad\square}
\renewcommand{\parallel}{\mathrel{/\mskip-2.5mu/}}
\newcommand{\paralleleq}{\hspace{0.5em}{^{^{\parallel}}}\hspace{-1.04em}=}
\newcommand{\rt}{\matrm{Rt}\triangle}

% 分块矩阵
\newenvironment{mat}[1]{
	\begin{array}{#1}
}{
	\end{array}
}

\newenvironment{pmat}[1]{
	\left( \begin{array}{#1}
}{
	\end{array} \right)
}

\newenvironment{bmat}[1]{
	\left[ \begin{array}{#1}
}{
	\end{array} \right]
}

\newenvironment{Bmat}[1]{
	\left\{ \begin{array}{#1}
}{
	\end{array} \right\}
}

\newenvironment{vmat}[1]{
	\left\lvert \begin{array}{#1}
}{
	\end{array} \right\rvert
}

\newenvironment{Vmat}[1]{
	\left\lVert \begin{array}{#1}
}{
	\end{array} \right\rVert
}
$$

[TOC]

## 第 6 章	非欧几何学

### 6.1	基本概念与性质

#### 6.1.1	三种第五公理

- 平行公理: 过直线 $L$ 外任一点 $p$ 只有恰好一条直线 $L'$ 与 $L$ 不相交.
- 球面公理: 没有任何一条过 $p$ 的直线不与 $L$ 相交.

- 双曲公理: 至少有两条过 $p$ 的直线不与 $L$ 相交.

#### 6.1.2	内角和与面积

- $ \cal E(T) = \text k \cal A(T) $.
  - 概念
    - 记**角盈** $ \cal E(T) $ 为三角形 $T$ 的内角和减去 $\pi$.
    - 手写体 $ \cal A(T) $ 为三角形 $T$ 的面积.
    - 正体 $ \text k $ 决定了几何空间的性质.
  - 分类
    - 当 $ \text k > 0 $ 时, 为球面几何.
    - 当 $ \text k = 0 $ 时, 为欧氏几何.
    - 当 $ \text k < 0 $ 时, 为双曲几何.
  - 性质
    - 若 $ \Delta = \Delta_1 + \Delta_2 $, 则 $ \cal E(\Delta) = \cal E(\Delta_1) + \cal E(\Delta_2) $.
  - 结论
    - 在非欧几何中, 内角和完全由三角形的面积决定.
    - $ \cal E(T) \ge -\pi $, 所以双曲几何中 $ \cal A(T) \le \vqty{\pi / k} $.
    - 非欧几何中<span style="color: blueviolet">没有相似三角形</span>, 有<span style="color: blueviolet">绝对的长度单位</span>.

#### 6.1.3	弯曲面的几何学

- 测地线: 两点之间的最短路径.

- 于是线段, 距离, 圆, 三角形等可依此定义.

  <span style="border-left: 4px solid #dfe2e5; padding: 0 15px; color: #777777; padding-right: 0;">线段上任意两点所连线段属于原线段.</span>

#### 6.1.4	内蕴几何与外在几何

#### 6.1.5	高斯曲率

- 记号约定: 设曲面在点 $p$ 的法向量为 $ \bm n $, 作平面 $ \Pi \supset \bm n $, 其与曲面的交线在 $p$ 点的有向曲率记为 $ \kappa $.

- **主曲率**: $ \kappa_\min,\, \kappa_\max $.

  - 主曲率产生在两个相互垂直的方向上.

- **高斯曲率**: $ \text k := \kappa_\min \cdot \kappa_\max $.

  - 高斯曲率是内蕴的 (高斯绝妙定理), 因此又称内蕴曲率或全曲率.

  - 若 $ \Delta $ 是位于 $p$ 点的无穷小三角形, 其面积为 $ \dd{\cal A} $, 则
    $$
    \cal E(\Delta) = \text k(p) \dd{\cal A}.
    $$

  - 根据 $ \text k(p) $ 的符号, 可以将曲面分为三类:

    <img src="image/6.1.5 高斯曲率.png" alt="image-20230129173321747"  />

  - 积分计算角盈: $ \cal E(T) = \d\iint_T \text k(p) \dd{\cal A} $.

#### 6.1.6	常曲率曲面

- 例子

  - 常正曲率: 球面等.
  - 常负曲率: 伪球等.

- 性质: $ \cal E(T) = \text k \cal{A}(T) $.

  <div style="border-left: 4px solid #dfe2e5; padding: 0 15px; color: #777777; padding-right: 0;">因此欧氏几何、球面几何与双曲几何都可以解释为具有常曲率的曲面的内蕴几何学。</div>

- 单位长度

  - 欧氏几何: 无绝对的单位长度.
  - 球面几何: $ \text k \equiv \dfrac{1}{R^2} $, 其中单位长度 $R$ 即球面半径.
  - 双曲几何: $ \text k \equiv -\dfrac{1}{R^2} $, 其中单位长度 $R$ 即伪球底圆周的半径.

#### 6.1.7	与莫比乌斯变换

- 球面几何中的运动
  - 将黎曼球面映为 $ \C $ 平面.
  - 保向运动即绕球心的旋转.
  - 形如 $ M(z) = \dfrac{az + b}{-\overline b z + \overline a} $.
- 双曲几何中的运动
  - 伪球
    - $ \begin{cases}
      	x = \cos\phi \sin\theta, \\
      	y = \sin\phi \sin\theta, \\
      	z = \cos\phi + \ln\tan\dfrac{\phi}{2}.
      \end{cases} $ 
    - 单位伪球体积是单位球的一半.
  - 将伪球面映为 $ \C $ 内的单位圆盘.
  - 形如 $ M(z) = \dfrac{az + b}{\overline b z + \overline a} $.

### 6.2	球面几何

#### 6.2.1	球面运动

- 分类

  - 反射 $ \frak R_L $: 反向.
  - 旋转 $ \cal R_p^\theta $: 保向.

- 复合

  - 反射: $ \frak R_{L_2} \circ \frak R_{L_1} = \cal R_p^\theta $,
    其中 $ L_1 $ 和 $L_2$ 的夹角为 $ \theta / 2 $, 点 $p$ 为该二直线的交点.

  - 旋转: $ \cal R_q^\phi \circ \cal R_p^\theta = (\frak R_N \circ \frak R_M) \circ (\frak R_M \circ \frak R_L) = \frak R_N \circ \frak R_L = \cal R_r^{\psi} $,
    其中 $ \psi = \theta + \phi - 2\text k \cal A $.

    <center class="half">
        <img src="image\6.2.1 球面运动-反射的复合.png" width=225 />
        <img src="image\6.2.1 球面运动-旋转的复合.png" width=200 />
    </center>

- 结论

  - 恰有一条直线 $P$ 被 $ \cal R_p^\theta $ 映为自身, 直线 $P$ 与点 $p$ 分别称为极线与极点.
  - 恰有一个保向运动 $ M $ 和一个反向运动 $ \wt M $ 把一个直线段 $ab$ 映为另一个同样长度的直线段 $ a'b' $, 进一步还有 $ \wt M = \frak R_L \circ \cal M $, 其中 $L$ 是过 $a'$ 和 $b'$ 的直线.
  - 球面上每个保向运动都是一个旋转, 每个反向运动都是一个旋转和一个反射的复合.

#### 6.2.2	共形映射

- 从 $ \C $ 映到 $ \Sigma $: $ z \mapsto \hat z $, 此时象距为 $ \dd{\hat s} = \Lambda(z) \ds $, 其中 $ \dd{\hat s} = \vqty{\dd{\hat z}},\, \ds = \vqty{\dz} $.

  - 黎曼球面 $ \Sigma $ 上的大圆都被映为 $ \C $ 上与单位圆周交于一对对径点的圆周.

- $ \dd{\hat s} = \dfrac{2}{\bqty{Nz}^2} \ds = \dfrac{2}{1 + \vqty{z}^2} \ds $.

  - 法一: 由距离公式 $ \bqty{\wavy a \wavy b} = \dfrac{R^2 \bqty{ab}}{\bqty{qa}\bqty{qb}} $ 即得.
  - 法二: 由相似知 $ \displaystyle\dv{\hat s}{s} = \dfrac{N \hat z}{N z}
    = \dfrac{N \hat z}{\sqrt 2} \cdot
    \dfrac{\sqrt 2}{N z}
    = \dfrac{2}{Nz^2} $.

  <img src="image/6.2.2 球面映射距离的度量.png" width=500 />

#### 6.2.3	空间旋转与莫比乌斯变换

##### 1	解析函数

若解析函数 $ z \mapsto \wt z = f(z) $ 是一个运动 (即黎曼球面上的旋转), 则
$$
\Lambda(\wt z) \dd{\wt s} = \Lambda(z) \ds
\\
\vqty{f'(z)} = \vqty{\dv{\wt z}{z}} = \dv{\wt s}{s}
= \dfrac{\Lambda(z)}{\Lambda[f(z)]}
% \\
% f'(z) = \dv{\wt z}{z}
% = \dfrac{\Lambda(z)}{\Lambda[f(z)]}
$$
对于 $ \k = 1 $ 的曲面上, 保向运动的集合为
$$
\vqty{f'(z)} = \dfrac{1 + \vqty{f(z)}^2}{1 + \vqty{z}^2}.
$$

---

##### 2	反射变换

黎曼球面上关于直线 $ \hat L $ 的反射 $ \frak R_{\hat L}(\hat z) $ 诱导出 $\C$ 上关于此直线的球极射影象的反演 $ \cal I_L(z) $.

<img src="image/6.2.3 反射变换.png" alt="image-20230208172545625" style="zoom:72%;" />

<img src="image/6.2.3 旋转变换.png" alt="image-20230208172609205" style="zoom:72%;" />

##### 3	旋转变换

- 推导步骤

  1. 考虑 $ \Sigma $ 上的旋转 $ \cal R_{\hat a}^\psi $, 令 $ \hat b $ 为 $ \hat a $ 的对径点, 于是 $ b = -1 / \overline a $, 并且 $a$ 与 $b$ 是此旋转在 $\C$ 上诱导出变换的不动点.
  2. 令 $ \hat L_1 $ 和 $ \hat L_2 $ 是两条任意的过 $ \hat a $ (因此也过 $ \hat b $) 且交角为 $ \psi / 2 $ 的直线, 则 $ \cal R_\hat a^\psi = \frak R_{\hat L_2} \circ \frak R_{\hat L_1} $.
  3. 于是 $ L_1 $ 和 $ L_2 $ 是过 $a$ 与 $b$ 且成角 $ \psi / 2 $ 的圆, 因此 $ \cal R_\hat a^\psi $ 诱导变换 $ R_a^\psi = \cal I_{L_2} \circ \cal I_{L_1} $.

- 总结

  - $ \Sigma $ 上的旋转 $ \cal R_\hat a^\psi $ 经球极射影诱导出 $ \C $ 上的椭圆莫比乌斯变换 $ R_a^\psi $, 其不动点是 $ \xi_+ = a $ 和 $ \xi_- = -1 / \overline a $, 相应于 $a$ 的乘子为 $ \frak m = \e^{-\i\psi} $.

  - 为了建立空间旋转与莫比乌斯变换的联系并应用, 我们的思路是:
    $$
    \begin{array}{c}
    \Sigma \to \C &\hspace{3em}&
    \C \to \C \\
    \xymatrix{
    	\hat z\ 平面 \ar[r]^{\cal R_\hat a^\psi} \ar[d] &
    	\hat w\ 平面 \ar[d] \\
    	z\ 平面 \ar[r]^{R_a^\psi} &
    	w\ 平面
    } && \xymatrix{
    	z\ 平面 \ar[r]^M \ar[d]^F &
    	w\ 平面 \\
    	\wt z\ 平面 \ar[r]^{\wt M} &
    	\wt w\ 平面 \ar[u]^{F\inv}
    }
    \end{array}
    $$

  - :star: 于是可以得到 $ R_a^\psi $ 矩阵的显示表达式为
    $$
    \begin{align}
    \bqty{R_a^\psi} &= \begin{bmatrix}
    	1 & -\xi_+ \\
    	1 & -\xi_-
    \end{bmatrix}\inv \begin{bmatrix}
    	\sqrt{\frak m} & 0 \\
    	0 & 1 / \sqrt{\frak m}
    \end{bmatrix} \begin{bmatrix}
    	1 & -\xi_+ \\
    	1 & -\xi_-
    \end{bmatrix}
    \\
    &= \begin{bmatrix}
    	\vqty{a^2} \e^{\i\tfrac{\psi}{2}} + \e^{-\i\tfrac{\psi}{2}} &
    	2 \i a \sin \dfrac{\psi}{2} \\
    	2 \i \overline a \sin\frac{\psi}{2} &
    	\vqty{a^2} \e^{-\i\tfrac{\psi}{2}} + \e^{\i\tfrac{\psi}{2}}
    \end{bmatrix}
    \end{align}
    $$

##### 4	运动的一般形式

- 因此保向运动形如 $ R_a^\psi (z) = \dfrac{Az + B}{- \overline B z + \overline A} $.
- 注意到 $ z \mapsto \overline z $ 是一个反射, 最一般的反向运动为 $ z \mapsto \dfrac{
  	A \overline z + B
  }{
  	-\overline B \overline z + \overline A
  } $.

---

##### 5	绕单位向量旋转

将上述旋转改写为绕单位向量旋转的形式.

记<u>单位向量</u>为 $ \bm v = l \bm i + m \bm j + n \bm k $, 端点为 $ \hat a $, 球极射影象为 $ a $, 则
$$
a = \dfrac{l + \i m}{1 - n},\quad
\vqty{a}^2 = \dfrac{1 + n}{1 - n}.
$$
:star: 代入 $ [R_a^\psi] $ 的表达式即得:
$$
\bqty{R_\bm v^\psi} = \begin{bmatrix}
	\cos\dfrac{\psi}{2} + \i n\sin\dfrac{\psi}{2} &
	(-m + \i l) \sin \dfrac{\psi}{2} \\
	(m + \i l) \sin\dfrac{\psi}{2} &
	\cos\dfrac{\psi}{2} - \i n\sin\dfrac{\psi}{2}
\end{bmatrix}.
$$
该矩阵也是<u>规范化</u>的.

##### 6	应用与特例

- 欲求解旋转的复合, 只需将旋转表示为复平面上的莫比乌斯变换, 求其复合后再转为旋转的形式.

- 上述矩阵本质上代表莫比乌斯变换, 而与熟知的实平面上旋转的矩阵形式不同. 如下, 左式为莫比乌斯变换的形式在 $ \bm v = \bm k $ 的特例, 右式为线性变换的矩阵:
  $$
  R_\bm k^\psi = \begin{bmatrix}
  	\e^{\i\psi / 2} & 0 \\
  	0 & \e^{-\i\psi / 2}
  \end{bmatrix},
  \hspace{3em}
  \bm R_\varphi = \begin{bmatrix}
  	\cos\varphi & -\sin\varphi \\
  	\sin\varphi & \cos\varphi
  \end{bmatrix}
  $$

- 特殊的, 二元旋转的莫比乌斯变换为

$$
\bqty{R_\bm v^\pi} = \begin{bmatrix}
	\i n & -m + \i l \\
	m + \i l & -\i n
\end{bmatrix}
$$

#### 6.2.4	空间旋转与四元数

##### 1	四元数的概念

- 定义 $ \mathbb V $ 
  - $ \bm I^2 = \bm J^2 = \bm K^2 = \bm I\bm J\bm K = -1 $.
  - $ \mathbb{V} = v \bm 1 + v_1 \bm I + v_2 \bm J + v_3 \bm K $.
  - 群定义: $ Q_4 = \aqty{a, b \mid a^2 = b^2 = (ab)^2} $.
- 备注
  - 这里使用空心字母表示四元数元素, 而非集合, 以区分于标量和向量.
  - 这里四元数单位使用粗斜体, 表明它是 (四维实) 向量或 (二阶复) 矩阵.
  - 有的资料上使用正体表示四元数单位, 表明它是标量常数; 这里不建议如此表示.
- 概念
  - 数量部分: $ v = v \bm 1 $.
  - 向量部分: $ \bm V = v_1 \bm I + v_2 \bm J + v_3 \bm K $.
  - 纯四元数: $ \mathbb V = \bm V $.

##### 2	四元数的起源

首先澄清一点, 以下内容不一定是四元数真正的起源, 只是我根据已学知识推断出的一条比较合理的路.

从历史上来说, 我们知道复数的加法与乘法即复平面中的平移与旋转, 于是希望将其推广到三维空间, 并且存在某种运算可以对应空间旋转.

在 $ \i^2 = -1 $ 的基础上, 补充定义 $ \j^2 = -1, \i \ne \j $ 是很自然的想法, 于是三元数是 $ \R $ 上的线性空间. 但是 $ \i\j $ 应该等于多少呢? 由乘法的封闭性, 不妨令
$$
\i\j = x + y \i + z \j, x, y, z \in \R.
$$
首先我们看到, $ z \ne 0 $, 否则两端左乘 $ \i $ 得 $ \j = -y + x \i \in \C $, 本质上还是复数.

于是由上式可得
$$
\begin{align}
\j &= \dfrac{1}{z} (\i \j - x - y \i),
\\
\i\j &= \dfrac{1}{z} (-\j - x\i + y),
\end{align}
$$
比较系数可得 $ z^2 = -1, z \not\in \R $, 矛盾, 从而 $ \i \j $ 不能由上述三元数表示.

这个反证法的思路与 $ \sqrt 2 $ 不是有理数的证明类似. 不过 $ \sqrt2 $ 虽然不属于有理数, 但属于实数, 有没有可能寻找到更大的代数系统, 使得乘法的封闭性得以满足呢?

自然的想法是令 $ \k = \i\j \not\in \C $, 同样自然的, 我们令 $ \i\j = \j\i $, 即满足交换律, 于是 $ \k^2 = 1 $. 现在我们知道, 这样的代数系统称为双复数, 不过更常见的定义是令 $ \i^2 = -1, \j^2 = 1, \i\j = \j\i = \k $, 其子环 $ \R[\i] $ 称为圆复数 (即复数 $\C$), 而 $ \R[\j] $ 称为双曲复数. 顾名思义, 双曲复数与双曲线有着密不可分的联系, 不过不是这里讨论的重点.

旋转运动是可逆的, 因此我们希望四元数除零元外都可逆. 双复数不能作为我们理想的 "四元数", 因为双复数有零因子, 从而双复数的乘法未必可逆. 例如 $ (1 + \j)(1 - \j) = 0 $, 假设零因子 $ 1 + j $ 有逆元且为 $ a\inv $, 等式两端左乘 $ a\inv $, 得 $ \j = 1 $, 从而矛盾.

似乎又陷入了窘境, 而且这样构造出来的双复数在运算上不具有轮换对称性, 并不美观. 不过回过头来, 我们希望的是通过三元或四元的 "超复数" 来研究三维的空间旋转, 空间旋转又具有怎样的性质呢? 我们惊讶地发现, 空间旋转并不满足交换律! 随便拿起一支笔或一颗魔方, 便可以验证这一点.

如果让四元数也不满足交换律呢? 实数是满足交换律的, 因此我们令 $ \i\j \ne \j\i $, 但具体是怎样的关系呢? 互为相反数是最简单的, 即 $ \i\j = -\j\i $, 于是我们可以推得 $ \k^2 = -1, \j\k = -\k\j, \k\i = -\i\k $, 这些运算恰好也是轮换对称的.

进一步我们还可以得到这种定义的四元数的诸多良好性质, 其中就包括非零元必有逆, 并且可以利用四元数方便地求解空间旋转的复合和效果. 这些就是接下来要推导的了. 即使抛开实际应用, 四元数作为纯数学, 内容也是丰富而有趣的.

我们称呼这种超复数为四元数, 但是定义似乎与之前的 $ \bm I^2 = \bm J^2 = \bm K^2 = \bm I\bm J\bm K = -1 $ 有所不同, 实际上它们是等价的, 读者可自证.

以上我们探索了三种形式的超复数, 作为复数的 "扩展", 它们的定义分别是:

1. $ \i^2 = -1, \j^2 = -1, \i\j = \j\i = \k $. (双复数的等价超复数)
2. $ \i^2 = -1, \j^2 = 1, \i\j = \j\i = \k $. (双复数)
3. $ \i^2 = -1, \j^2 = -1, \i\j = -\j\i = \k $. (四元数)

形式上看, 只剩下一个有待研究:

4. $ \i^2 = -1, \j^2 = 1, \i\j = -\j\i = \k $. (反四元数)

这种超复数称为分裂四元数或反四元数, 与双复数一样, 它也有非零元无逆, 如 $ \dfrac{1 + \j}{2} $ 即为幂等的零因子, 因此反四元数的性质也没有四元数好.

最后, 我们之后使用的四元数单位的字体与前文不同, 不再是正体. 四元数单位之所以要使用大写的粗斜体, 是为了与复数单位区分. 由复数推广至四元数是自然的, 但是之后在研究四元数时, 常将其同构映射为复矩阵, 此时若不用粗斜体, 则容易混淆; 而小写的粗斜体常用于表示空间向量, 因此表示为 $ \bm I, \bm J, \bm K $ 是最为清晰的.

##### 3	基本代数性质

- 性质
  - $ \bm I \bm J = \bm K,\, \bm J \bm K = \bm I,\, \bm K \bm I = \bm J $.
  - $ \bm I \bm J = -\bm J \bm I,\, \bm J \bm K = -\bm K \bm J,\, \bm K \bm I = -\bm I \bm K $.
  - $ \bm I \bm J \bm K = \bm J \bm K \bm I = \bm K \bm I \bm J = -1 $.
- 乘法
  - $ \bm V \bm W = -\bm V \cdot \bm W + \bm V \cp \bm W $.
  - $ \bb V \bb W = (vw - \bm V \cdot \bm W) + (v\bm W + w \bm V + \bm V \cp \bm W) $.
- 备注
  - 将四元数集合视为 $ \R $ 上的线性空间, 加法与乘法都是通常意义下的.
  - 将纯四元数视为三维空间向量, 点积与叉积都是通常意义下的.
  - 四元数无乘法交换律, 不能成域, 而只能构成环, 称为哈密顿四元数除环 $ \bb H $.

##### 4	两种矩阵同构

注: $ \GL_n(\F) $ 表示域 $ \F $ 上由 $n$ 阶矩阵构成的一般线性群.

- 二阶复矩阵
  $$
  \begin{array}{crl}
  \phi_1: &
  Q_4 \hspace{-0.75em} &\to \GL_2(\C)
  \\
  & \bb V \hspace{-0.75em} &= a \bm 1 + b \bm I + c \bm J + d \bm K
  \\
  && \mapsto \begin{pmatrix}
  	a - d \i & -b + c \i \\
  	b + c \i & a + d \i
  \end{pmatrix}
  % \bb V &= v \bm 1 + v_1 \bm I + v_2 \bm J + v_3 \bm K
  % \\
  % & \mapsto \begin{pmatrix}
  % 	v - v_3 \i & -v_1 + v_2 \i \\
  % 	v_1 + v_2 \i & v + v_3 \i
  % \end{pmatrix}
  \end{array}
  $$

  - $ \bm 1 = \begin{bmatrix}
    	1 & 0 \\
    	0 & 1
    \end{bmatrix} $, 对应于 $ {\it 1}(z) = z $, 即恒等变换.
  - $ \bm I = \begin{bmatrix}
    	0 & \i \\
    	\i & 0
    \end{bmatrix} $, 对应于 $ I(z) = \dfrac{1}{z} $, 即黎曼球面绕 $ x_1 $ 轴旋转 $ 180^\circ $.
  - $ \bm J = \begin{bmatrix}
    	0 & -1 \\
    	1 & 0
    \end{bmatrix} $, 对应于 $ J(z) = - \dfrac{1}{z} $, 即黎曼球面绕 $ x_2 $ 轴旋转 $ 180^\circ $.
  - $ \bm K = \begin{bmatrix}
    	\i & 0 \\
    	0 & -\i
    \end{bmatrix} $, 对应于 $ K(z) = -z $, 即黎曼球面绕 $ x_3 $ 轴旋转 $ 180^\circ $.

- 四阶实矩阵
  $$
  \begin{array}{crl}
  \phi: & Q_4 \hspace{-0.75em} & \to \GL_4(\R)
  \\
  & \bb V \hspace{-0.75em} &= a \bm 1 + b \bm I + c \bm J + d \bm K
  \\
  && \mapsto \begin{pmatrix}
  	a & -b & d & -c \\
  	b & a & -c & -d \\
  	-d & c & a & -b \\
  	c & d & b & a
  \end{pmatrix}
  \end{array}
  $$
   其中四元数单位被映射为
  $$
  \begin{array}{c}
  \bm 1 \mapsto \begin{pmatrix}
  	1 \\
  	& 1 \\
  	&& 1 \\
  	&&& 1 \\
  \end{pmatrix},
  &
  \bm I \mapsto \begin{pmatrix}
  	& -1 \\
  	1 \\
  	&&& -1 \\
  	&& 1
  \end{pmatrix},
  \\
  \bm J \mapsto \begin{pmatrix}
  	&&& -1 \\
  	&& -1 \\
  	& 1 \\
  	1
  \end{pmatrix},
  &
  \bm K \mapsto \begin{pmatrix}
  	&& 1 \\
  	&&& -1 \\
  	-1 \\
  	& 1
  \end{pmatrix}.
  \end{array}
  $$

- 以下将 $ Q_4 $ 与 $ \GL_2(\C) $ 中的元素看成是相等的, 而不采用 $ \GL_4(\R) $ 的同构.

- 想要通过计算机求解四元数运算, 可以利用矩阵形式.

##### 5	共轭的性质

共轭 $ \overline{\bb V} $ 是对于四元数而言的, 而非矩阵共轭.

- $ \overline{\bb V} := \bb V^* $ (相应矩阵的共轭转置).
- $ \overline{\bb V} = v - \bm V $.
- $ \overline{\bm V \bm W} = \bm W \bm V % \overline{\bm W}\ \overline{\bm V} $. (注意顺序)
- $ \overline{\bb V \bb W} = \overline{\bb W}\ \overline{\bb V} $. (注意顺序)

**证明**

(1) 式为矩阵共轭定义, (2) 式为向量共轭定义, 由矩阵表示可知二者等价.
$$
\newcommand{\bm}[1]{\boldsymbol{#1}}
\renewcommand{\cal}[1]{\mathcal#1}
\renewcommand{\scr}[1]{\mathscr#1}
\renewcommand{\frak}[1]{\mathfrak#1}
\newcommand{\bb}[1]{\mathbb#1}
\newcommand{\dsum}{\displaystyle\sum}

\begin{align}
\overline{\bm V \bm W} &= \overline{
	\dsum v_i w_i \bm I^2 + \dsum v_i w_j \bm I \bm J
} \\
&= - \dsum v_i w_i - \dsum v_i w_j \bm K
\\
&= - \dsum v_i w_i + \dsum v_i w_j \bm J \bm I
\\
&= \bm W \bm V = \overline{\bm W}\ \overline{\bm V}.
\end{align}
$$

$$
\begin{align}
\overline{\bb V \bb W} &= \overline{(v + \bm V)(w + \bm W)}
\\
&= \overline{vw + v \bm V + w \bm W + \bm V \bm W}
\\
&= vw - v \bm V - w \bm W + \bm W \bm V
\\
&= (w - \bm W)(v - \bm V) = \overline{\bb W}\ \overline{\bb V}.
\end{align}
$$

##### 6	长度的性质

长度 $ \vqty{\bb V} $ 又称为二范数.

- $ \vqty{\bb V}^2 := {\bb V \overline{\bb V}} = \overline{\bb V} \bb V = \vqty{\overline{\bb V}}^2 $.
- $ \vqty{\bm V}^2 = - \bm V^2 = - \bm V \bm V = \bm V \cdot \bm V $.
- $ \vqty{\bb V}^2 = v^2 + \vqty{\bm V}^2 = v^2 + v_1^2 + v_2^2 + v_3^3 $.
- $ \vqty{\bb V \bb W} = \vqty{\bb V} \vqty{\bb W} $.
- $ \vqty{\bb V}^2 = \det(\bb V) $.

**证明**
$$
\begin{align}
\vqty{\bm V}^2 &= -\bm V\bm V
= \sum v_i^2 + \sum v_i v_j (\bm I \bm J + \bm J \bm I)
= \sum v_i^2 = \bm V \cdot \bm V.
\\
\vqty{\bb V}^2 &= v^2 - \bm V^2 = v^2 + \vqty{\bm V}^2 = v^2 + v_1^2 + v_2^2 + v_3^2.
\\
\vqty{\overline{\bb V}}^2 &= v^2 + \vqty{-\bm V}^2 = \vqty{\bb V}^2.
\\
\vqty{\bb V \bb W}^2 &= \bb V \bb W \overline{\bb V \bb W}
= \bb V\ \bb W \overline{\bb W}\ \overline{\bb V}
= \bb V \overline{\bb V} \vqty{\bb W}^2 = \vqty{\bb V}^2 \vqty{\bb W}^2.
\\
\det(\bb V) &= (v - v_3\i)(v + v_3\i) - (-v_1 + v_2\i)(v_1 + v_2\i) = v^2 + \dsum v_i^2 .
\end{align}
$$

##### 7	单位四元数

单位四元数 ($ \vqty{\bb V} = 1 $) 不一定是四元数单位.

- $ \vqty{\bb R_\bm v^\psi} = 1 $.
- $ \overline{\bb R_\bm v^\psi} = \bb R_\bm v^{-\psi} $.
- 当且仅当 $ \bb A^2 = -1 $ 时, $ \bb A $ 是纯的单位四元数.
- $ \forall \bb Q, \exist  \bm v, \psi: \bb Q = \vqty{\bb Q} \bb R_\bm v^\psi $.

**证明**
$$
\begin{align}
\vqty{\R_\bm v^\psi} &= \vqty{
	\cos \dfrac{\psi}{2} + \bm V \sin \dfrac{\psi}{2}
} = \cos^2 \dfrac{\psi}{2} +
\vqty{\bm V}^2 \sin^2 \dfrac{\psi}{2} = 1.
\\
\overline{\R_\bm v^\psi}
&= \cos \dfrac{\psi}{2} + (- \bm V) \sin \dfrac{\psi}{2}
= \cos \dfrac{-\psi}{2} + \bm V \sin \dfrac{-\psi}{2}
= \R_\bm v^{-\psi}.
\\
\bb A^2 &= (a + \bm A)^2 = a^2 + 2a \bm A + \bm A^2 = -1
\RA a = 0.
\\
\bm A^2 &= -\vqty{\bm A}^2 = -1 \RLA \bm A\ 是纯的单位四元数.
\end{align}
$$
第四点解方程即得 (有两解).

##### 8	旋转公式矩阵证法

- 旋转的矩阵 (可求复合) :star: 

  绕 $ \bm v = l \bm i + m \bm j + n \bm k $ 旋转 $ \psi $ 的矩阵 $ [R_\bm v^\psi] $.

  记 $ \bm V = l \bm I + m \bm J + n \bm K $, 则矩阵可表示为
  $$
  \R_\bm v^\psi = \cos \dfrac{\psi}{2} + \bm V \sin \dfrac{\psi}{2} \equiv \e^{\bm V \tfrac{\psi}{2}}.
  $$

- 旋转的效果 (可求象) :star: 

  一般的, $ \cal R_{\hat{\wt{p}}}^\theta = \cal R_\hat a^\psi \circ \cal R_\hat p^\theta \circ \cal R_\hat a^{-\psi} $, 即 $ \bb R_\wt{\bm P}^\theta = \bb R_\bm v^\psi \circ \bb R_\bm P^\theta \circ \bb R_\bm v^{-\psi} $.

  设 $ \cal R_\bm v^\psi $ 将 $ \bm P = x \bm i + y \bm j + z \bm k $ 旋转到 $ \wt{\bm P} $:

  在上式中令 $ \theta = \pi $, 则二元旋转 $ \R_\bm P^\theta $ 和 $ \R_{\wt{\bm P}}^\pi $ 正是纯四元数 $ \bb P $ 和 $ \wt{\bb{P}} $, 故有
  $$
  \wt{\bb{P}} = \bb{R}_\bm v^\psi \bb P \bb R_\bm v^{-\psi}.
  $$

- 伸缩旋转

  - $ \forall \bb Q, \exist  \bm v, \psi: \bb Q = \vqty{\bb Q} \bb R_\bm v^\psi $, 即伸缩旋转.

  - 由旋转的象的公式得, 伸缩旋转的效果为:
    $$
    \bb P \mapsto \wt{\bb P} = \bb Q \bb P \overline{\bb Q}.
    $$

##### 9	旋转公式反射证法

若 $ \bb P $ 与 $ \bb A $ 为<u>纯四元数</u>, 则

- 正交的充要条件: $ \bb P \bb A + \bb A \bb P = 0 $.

- 若 $\bb A$ 为单位纯四元数, 即 $ \bb A^2 = -1 $,

  - 则上述方程化为 $ \bb P = \bb A \bb P \bb A $.

  - 令 $ \Pi_\bm A $ 表示以 $ \bm A $ 为法向量的过原点的平面, 其方程为 $ \bm P \cdot \bm A = 0 $.

    :star: 考虑变换 $ \bb P \mapsto \bb P' = \bb A \bb P \bb A $,

    - $ \bb P' $ 为纯四元数, 并且 $ \vqty{\bb P'} = \vqty{\bb P} $, 于是该变换表示空间中的运动.
    - $ \Pi_\bm A $ 上的每点均不动, 且正交于 $ \Pi_\bm A $ 的向量均被反向, 于是该映射为**反射** $ \frak R_{\Pi_\bm A} $.

  - 若由 $ \Pi_\bm A $ 到 $ \Pi_\bm B $ 的角为 $ \psi / 2 $, 两平面交线的单位向量为 $ \bm V $, 则旋转 $ \cal R_\bm v^\psi = \frak R_{\Pi_\bm A} \circ \frak R_{\Pi_\bm B} $ 可表示为
    $$
    \bb P \mapsto \wt{\bb P} = (-\bb B \bb A) \bb P (-\overline{\bb B \bb A}).
    $$

  - 其中 $ \bb R_\bm v^\psi = -\bb B \bb A = \cos\dfrac{\psi}{2} + \bm V \sin\dfrac{\psi}{2} $. ($ \bb P $ 和 $ -\bb P $ 的效果是一样的)

**证明**

由于是纯四元数, $ \begin{align}
\bb P \bb A + \bb A \bb P = -2 \bm P \cdot \bm A
\end{align} $, 因此得到第一点.

当 $ \bb A^2 = -1 $, 第一点的两端同乘 $ \bb A $ 即得 $ \bb P = \bb A \bb P \bb A $.

$ \bb P' $ 为纯四元数的结论, 可以代入值后展开, 这里采用向量法另证:
$$
\begin{align}
\bb P' &= \bm A(-\bm P \cdot \bm A + \bm P \cp \bm A)
\\
&= -(\bm P \cdot \bm A) \bm A - \bm A \cdot (\bm P \cp \bm A) + \bm A \cp (\bm P \cp \bm A)
\\
&= -(\bm P \cdot \bm A) \bm A - \bm A \cdot (\bm P \cp \bm A) + (\bm A \cdot \bm A) \bm P - (\bm A \cdot \bm P) \bm A
\\
&= \bm P -2(\bm P \cdot \bm A) \bm A.
\\
\vqty{\bb P'} &= \vqty{\bb A \bb P \bb A}
= \vqty{\bb A} \vqty{\bb P} \vqty{\bb A} = \vqty{\bb P}.
\end{align}
$$
不动点可用正交的等价条件证明, 这里继续使用向量法:

当 $ \bm P \in \Pi_\bm A $ 时, $ \bm P \cdot \bm A = 0 $, 于是 $ \bb P' = \bm P $.

若 $ \bm P \perp \Pi_\bm A $, 则 $ \bb P' = \bm P - 2 \vqty{\bm P} \bm A = \bm P - 2\bm P = -\bm P $.
$$
\bb P \mapsto \wt{\bb P} = \bb B (\bb A \bb P \bb A) \bb B
= (-\bb B \bb A) \bb P (-\overline{\bb B \bb A}).
$$

$$
\begin{align}
-\bb B \bb A &= \bm B \cdot \bm A - \bm B \cp \bm A
= \cos\dfrac{\psi}{2} + \bm V \sin\dfrac{\psi}{2}.
\end{align}
$$

##### 10	旋转公式向量证法

将 $ \Sigma $ 和 $ \C $ 中的点用 $ \C^2 $ 中的齐次坐标向量表示, 如 $ \bm{\frak p} = [\frak p_1, \frak p_2]\trans, z = p = \dfrac{\frak p_1}{\frak p_2} $, 则
$$
\bm{\frak p} \mapsto \wt{\bm{\frak p}} = \bb R_\bm v^\psi \bm{\frak p}.
$$
取 $ \aqty{\bm{\frak p}, \bm{\frak p}} \equiv \vqty{\frak p_1}^2 + \vqty{\frak p_2}^2 = 2 $, 则 $ \Sigma $ 与 $ \C $ 中点的换算公式为
$$
\begin{cases}
    X + \i Y = \dfrac{2z}{1 + \vqty{z}^2} = \dfrac{
        2 \frak p_1 \overline{\frak p}_2
    }{
    	\vqty{\frak p_1}^2 + \vqty{\frak p_2}^2
    } = \frak p_1 \overline{\frak p}_2, \\
    Z = \dfrac{\vqty{z}^2 - 1}{\vqty{z}^2 + 1} = \dfrac{
        \vqty{\frak p_1}^2 - \vqty{\frak p_2}^2
    }{
        \vqty{\frak p_1}^2 + \vqty{\frak p_2}^2
    } = \vqty{\frak p_1}^2 - 1.
\end{cases}
$$
记 $p$ 的球极射影象 $ \hat p $ 对应的单位向量为 $ \bm P = (X, Y, Z) $, 则
$$
\begin{align}
\bb P &= X \bm I + Y \bm J + Z \bm K
= \begin{bmatrix}
	\i Z & -Y + \i X \\
	Y + \i X & -\i Z
\end{bmatrix}
\end{align}
$$
注意到
$$
1 - \i \bb P = \begin{bmatrix}
	1 + Z & X + \i Y \\
	X - \i Y & 1 - Z
\end{bmatrix} = \begin{bmatrix}
	\frak p_1 \overline{\frak p}_1 &
	\frak p_1 \overline{\frak p}_2 \\
	\frak p_2 \overline{\frak p}_1 &
	\frak p_2 \overline{\frak p}_2
\end{bmatrix} = \begin{bmatrix}
	\frak p_1 \\ \frak p_2
\end{bmatrix} \begin{bmatrix}
	\,\overline{\frak p}_1 & \overline{\frak p}_2 
\end{bmatrix} = \bm{\frak p} \bm{\frak p}\adj.
$$
于是有
$$
\begin{align}
1 - \i \wt{\bb P} &= \wt{\bm{\frak p}} \wt{\bm{\frak p}}\adj
= \pqty{
	\bb R_\bm v^\psi \bm{\frak p}
} \pqty{
	\bb R_\bm v^\psi \bm{\frak p}
}\adj = \bb R_\bm v^\psi
\bm{\frak p} \bm{\frak p}\adj
\pqty{\R_\bm v^\psi}\adj
\\
&= \bb R_\bm v^\psi \pqty{
	1 - \i \bb P
} \pqty{\R_\bm v^\psi}\adj
= 1 - \i {\bb R_\bm v^\psi} \bb P {\pqty{\R_\bm v^\psi}\adj}.
\end{align}
$$
从而得到 $ \wt{\bb{P}} = \bb{R}_\bm v^\psi \bb P \bb R_\bm v^{-\psi} $.

##### 11	旋转公式几何证法

##### 12	四元数的逆与伴随

- 定义: $ \bb V \bb V \inv = \bb V\inv \bb V = 1 $.
- 计算: $ \bb V\inv = \dfrac{\overline{\bb V}}{\vqty{\bb V}^2} = \dfrac{\bb V\adj}{\vqty{\bb V}^2} $. (向量形式和矩阵形式)
- 旋转: $ (\bb R_\bm v^\psi)\inv = (\bb R_\bm v^\psi)\adj = \overline{\bb R_\bm v^\psi} = \bb R_\bm v^{-\psi} = \bb R_{-\bm v}^\psi $.
- 共轭转置: $ \overline{\bb V} = \bb V^* = \mathrm{adj}(\bb V) $. (伴随矩阵)
- 模长: $ \vqty{\bb V\inv} = \vqty{\bb V}\inv $.
- 交换: $ \overline{\bb V\inv} = \overline{\bb V}\inv $.

**证明**
$$
\begin{align}
\bb V\inv &= \dfrac{\vqty{\bb V}^2 \bb V\inv}{\vqty{\bb V}^2}
= \dfrac{\bb V\adj \bb V\, \bb V\inv}{\vqty{\bb V}^2}
= \dfrac{\bb V\adj}{\vqty{\bb V}^2}.
\\
\mathrm{adj}(\bb V) &= \det(\bb V) \bb V\inv
= \vqty{\bb V}^2 \bb V\inv = \bb V\adj.
\\
\overline{\bb V\inv} &= \dfrac{\bb V}{\vqty{\bb V}^2}
= \dfrac{\bb V}{\vqty{\overline{\bb V}}^2}
= \overline{\bb V}\inv.
\end{align}
$$

##### 13	四元数的其它运算

- 点积 (内积)
  - $ \bb P \cdot \bb Q := pq + \bm P \cdot \bm Q $.
  - $ \bm P \cdot \bm Q = -\dfrac{\bm P \bm Q + \bm Q \bm P}{2} $.
  - $ \bb P \cdot \bb Q = \dfrac{\bb P\adj \bb Q + \bb Q\adj \bb P}{2} $.
- 叉积 (矢积, 向量积)
  - $ \bb P \cp \bb Q := \bm P \cp \bm Q $.
  - $ \bb P \cp \bb Q = \dfrac{\bb P \bb Q - \bb Q \bb P}{2} $.
- 外积
  - $ \Outer(\bb P, \bb Q) := \dfrac{\bb P\adj \bb Q - \bb Q\adj \bb P}{2} $.
  - $ \Outer(\bb P, \bb Q) = p \bm Q - q \bm P - \bm P \cp \bm Q $.
- 偶积
  - $ \Even(\bb P, \bb Q) := \dfrac{\bb P \bb Q + \bb Q \bb P}{2} $.
  - $ \Even(\bb P, \bb Q) = (pq - \bm P \cdot \bm Q) + (p \bm Q + q \bm P) $.
- 纯量部 (标量部)
  - $ \Scalar(\bb P) = p $.
  - $ \Scalar(\bb P) = 1 \cdot \bb P $.
  - $ \Scalar(\bb P) = \dfrac{\bb P + \bb P\adj}{2} $.
- 向量部
  - $ \Vector({\bb P}) = \bm P $.
  - $ \Vector(\bb P) = \Outer(1, \bb P) $.
  - $ \Vector(\bb P) = \dfrac{\bb P - \bb P\adj}{2} $.
- 模
  - $ \vqty{\bb P} := \sqrt{\bb P\adj \bb P} = \sqrt{\overline{\bb P} \bb P} $.
  - $ \vqty{\bb P} = \sqrt{\bb P \cdot \bb P} = \sqrt{p^2 - \bm P^2} $.
  - $ \vqty{\bb P} = \sqrt{p^2 + p_1^2 + p_2^2 + p_3^2} $.
- 角度的度量
  - 符号数: $ \sgn(\bb P) := \dfrac{\bb P}{\vqty{\bb P}} $.
  - 另一表示: $ \sgn(\bb P) = \dfrac{\overline{\bb P\inv}}{\vqty{\bb P\inv}} $.
  - 幅角: $ \arg(\bb P) := \arccos\dfrac{p}{\vqty{\bb P}} $.

**证明**

- 点积

$$
\begin{align}
\bm P \bm Q + \bm Q \bm P &= \dsum p_i q_i (\bm I^2 + \bm I^2) + \dsum p_i q_j (\bm I \bm J + \bm J \bm I)
\\
&= -2\dsum p_i q_i = -2 \bm P \cdot \bm Q.
\end{align}
$$

$$
\begin{align}
\overline{\bb P} \bb Q &= (p - \bm P) (q + \bm Q)
= pq + p \bm Q - q \bm P - \bm P \bm Q,
\\
\overline{\bb Q} \bb P &= (p + \bm P) (q - \bm Q)
= pq - p \bm Q + q \bm P - \bm Q \bm P,
\\
\overline{\bb P} \bb Q + \overline{\bb Q} \bb P
&= 2pq - \bm P \bm Q - \bm Q \bm P
= 2pq + 2\bm P \cdot \bm Q
= 2 \bb P \cdot \bb Q.
\end{align}
$$

- 叉积

$$
\begin{align}
\bb P \bb Q &= (pq - \bm P \cdot \bm Q) + (p \bm Q + q \bm P + \bm P \cp \bm Q),
\\
\bb Q \bb P &= (pq - \bm P \cdot \bm Q) + (p \bm Q + q \bm P - \bm P \cp \bm Q),
\\
\bb P \bb Q - \bb Q \bb P &= 2 \bm P \cp \bm Q
= 2 \bb P \cp \bb Q.
\end{align}
$$

- 外积

$$
\begin{align}
\bm P \bm Q &= - \bm P \cdot \bm Q + \bm P \cp \bm Q,
\\
\bm Q \bm P &= - \bm P \cdot \bm Q - \bm P \cp \bm Q,
\\
\Outer(\bb P, \bb Q) &= p \bm Q - q \bm P - \bm P \bm Q + \bm Q \bm P
\\
&= p \bm Q - q \bm P - \bm P \cp \bm Q.
\end{align}
$$

- 偶积: 由叉积证明过程即得.
- 纯量部与向量部: 由定义代入即得.
- 模: 即[长度](# 6	长度的性质), 这里仅作总结, 结论均已证过.
- 符号数: $ \sgn(\bb P) = \dfrac{\bb P}{\vqty{\bb P}} = \overline{\bb P}\inv \vqty{\bb P} = \dfrac{\overline{\bb P\inv}}{\vqty{\bb P\inv}} $.

### 6.3	双曲几何

#### 6.3.1	曳物线和伪球面

- 曳物线
  - 令 $ \sigma $ 为曳物线的弧长, 起点 $ \sigma = 0 $ 在 $ X = R $, 另一端在 $Y$ 轴上从 0 向正方向<u>缓慢地</u>移动.
  - $ \ddv{X}{\sigma} = - \dfrac{X}{R} \QRA X = R\e^{-\sigma / R} $.
  - $ \sqrt{1 + y'^2} = -\dfrac{R}{x} \QRA y = \sqrt{R^2 - x^2} - R \arch\dfrac{R}{x} $.

<img src="image/6.3.1 曳物线.png" alt="image-20230210111841584" style="zoom:64%;" />

- 伪球面

  - 半径为 $R$ 的伪球面: 曳物线绕其轴旋转而成的曲面.

  - 伪球面具有常值负曲率.

    证明: 令 $ r $ 和 $ \wt r $ 是半径为 $R$ 的伪球面的两个主曲率半径, 由对称性知

    - $ \wt r = $ 作为母线的曳物线的曲率半径.
    - $ r = $ 由曲面到轴的法线线段的长.

    于是有
    $$
    \begin{align}
    \dfrac{r}{R} = \dfrac{AC}{BC}
    = \dfrac{AC}{BQ - CQ}
    = \dfrac{AC}{AP - CQ}
    = \dfrac{AC}{PQ} = \dfrac{R}{\wt r}.
    \end{align}
    $$
    从而得到 $ \k = -\dfrac{1}{r\wt r} = -\dfrac{1}{R^2} $.


<img src="image/6.3.1 伪球面.png" alt="image-20230210122636049" style="zoom:80%;" />

#### 6.3.2	伪球面上的共形映射

恒取伪球面的半径为 $ R = 1 $, 于是常曲率为 $ \k = -1 $.

取坐标系为 $ (x, \sigma) $, 其中 $ 0 \le x < 2\pi $,于是过点 $ (x, \sigma) $ 的圆周 $ \sigma =  $ 常数的半径为 $ X = \e^{-\sigma} $.

如右图映至复平面, $ (x, \sigma) \mapsto z = x + \i y $.

为保证共形, $ \ddv{y}{\sigma} = \dfrac{1}{X} = \e^{\sigma} \RA y = \e^\sigma + C $, 一般令 $ C = 0 $, 于是
$$
\begin{cases}
	y = \e^{\sigma} = \dfrac{1}{X},
	\\
	\dd{\hat s} = X \ds = \dfrac{\sqrt{\dd{x^2} + \dd{y^2}}}{y},
	\\
	\dd{\cal A} = \dfrac{\dxdy}{y^2}.
\end{cases}
$$
<img src="image/6.3.2 伪球面映到复平面.png" alt="image-20230210144607810" style="zoom:80%;" />

#### 6.3.3	贝尔特拉米的双曲平面

双曲平面的映射

- 庞加莱上半平面
  - 理想点 (无穷远点): $ (x, 0) $.
  - 天际线 (无穷远圆): $ y = 0 $.
- 庞加莱圆盘
- 克莱因圆盘

#### 6.3.4	双曲直线和反射

- 定义

  - h 直线表示双曲直线 (测地线).
  - $ \cal H\Bqty{z_1, z_2} $ 为双曲距离 (h 距离).
  - h 圆周: $ \cal H\Bqty{z, c} = \rho $.

- 距离

  - $ \cal H\Bqty{z + \dz, z} = \dfrac{\vqty{\dz}}{\Im z} $.
  - $ \cal H\Bqty{(x + \i y_1), (x + \i y_2)} = \vqty{\ln\dfrac{y_1}{y_2}} $.

- h 直线的分类

  - 垂直于天际线的半直线.

  - 垂直于天际线的半圆周.

    <img src="image/6.3.4 h 直线.png" alt="image-20230210165700963" style="zoom:80%;" />

- 对正交于天际线的半圆周的反演是双曲平面上的反向运动.

  即证由 $ z $ 发出的任意无穷小线段 $ \ds $, $ \cal I_K(z) $ 不会改变其 h 长度 $ \dd{\hat s} $, 由于共形性, 只需证下式:
  $$
  \dd{\hat{\wt s}} = \dfrac{\dd{\wt s}}{\wt y} = \dfrac{\dd{s}}{y} = \dd{\hat s}.
  $$
  由此利用反演可证 h 直线的分类结果, 并因此可指出上述反向运动即对 h 直线 $K$ 的反射 $ \frak R_K $.

- 双曲平面上两点的距离:
  $$
  \cal H\Bqty{a, b} = \cal H\Bqty{\wt a, \wt b} = \vqty{
  	\ln\dfrac{\Im \wt a}{\Im \wt b}
  }.
  $$
  <img src="image/6.3.4 测地线长度.png" alt="image-20230210171550220" style="zoom:80%;" />

- 平行线的分类
  - 渐近线
  - 超平行

<img src="image/6.3.4 平行线的分类-1.png" alt="image-20230210173104993" style="zoom:80%;" />

<img src="image/6.3.4 平行线的分类-2.png" alt="image-20230210173213169" style="zoom:80%;" />

#### 6.3.5	鲍耶-罗巴切夫斯基公式

平行角 $ \Pi = \arctan 2\e^{-D} $.
$$
D \equiv \cal H\Bqty{p, q} = \vqty{\ln\dfrac{[qm]}{[\wt pm]}} = \vqty{\ln\dfrac{[cm]}{[\wt qm]}} = \vqty{\ln\tan\dfrac{\Pi}{2}} = -\ln\tan\dfrac{\Pi}{2}.
\\
\RA \tan \dfrac{\Pi}{2} = \e^{-D}.
$$
<img src="image/6.3.5 鲍耶-罗巴切夫斯基公式.png" alt="image-20230210180427805" style="zoom:80%;" />

#### 6.3.7	保向运动的三种类型

保向运动可表示为 $ \cal M \equiv \frak R_{L_2} \circ \frak R_{L_1} $.

每一个保向运动都可由一个非斜驶型的莫比乌斯变换表示, 并可表示为
$$
M(z) = \dfrac{az + b}{cz + d}, \quad
a, b, c, d \in \R, (ad - bc) > 0.
$$

- 若这两条 h 直线相交, 则 $ \cal M $ 称为 **旋转**, 并且是椭圆型的.
- 若这两条 h 直线是渐进的, 则 $ \cal M $ 称为 **极限旋转**, 并且是抛物型的.
- 若这两条 h 直线是超平行的, 则 $ \cal M $ 称为 **双曲平移**, 并且是双曲型的. (这两个双曲的含义不同).

---

以 $ a = (x + \i y) $ 为 h 圆心, $ \rho $ 为 h 半径的 h 圆周, 就是以 $ (x + \i y \cosh \rho) $ 为中心, $ y\sinh\rho $ 为半径的欧氏圆周.



## 第 7 章	环绕数与拓扑学

### 7.1	环绕数

- 环绕数: $ \nu(L, p) $.
- 简单环路: 不自交的环路.
- 穿越法则: 记环路为 $K$, 则当我们即将穿越 $K$ 时, 如果 $K$ 的方向是从我们的左侧指向我们的右侧（从我们的右侧指向我们的左侧）, 则环绕数增加 1（减少 1）.

### 7.2	霍普夫映射定理

环路 $K$ 可以连续变形为另一环路 $L$ 而不穿过点 $p$, 当且仅当 $K$ 与 $L$ 有同样的绕 $p$ 的环绕数. 这个结论对任意维数空间都成立, 其中环绕数的一般概念称为 **度** 或 **映射度**.

### 7.3	多项式与幅角原理

- 若一个简单环路 $ \Gamma $ 一次包围了多项式 $P(z)$ 的 $m$ 个根, 则 $ ν[P(\Gamma), 0] = m $.
- 若 $ f(z) $ 在一个简单环路 $ \Gamma $ 的内域和在 $ \Gamma $ 上均为解析, 而 $N$ 为 $ \Gamma $ 内域中的 $p$-点数目 [按重数计], 则 $N = ν [f(\Gamma), p]$.































