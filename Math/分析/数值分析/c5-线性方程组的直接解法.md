<h2 align="center">第五章    线性方程组的直接解法</h2>

$$
% 设置
\renewcommand{\d}{\displaystyle}
\newcommand{\aneg}[1]{\hspace{-0.75em}&#1&\hspace{-0.75em}\d}
\newcommand{\aneq}{\aneg{=}}
\newcommand{\overaneg}[2]{\hspace{-0.75em}&\overset{#1}{#2}&\hspace{-0.75em}\d}
\newcommand{\overaneq}[1]{\overaneg{#1}{=}}
% 上述指令用于在使用 array 环境时调整等号左右间距
\newcommand{\noeq}{&\hspace{1.3em}}
% 上述指令用于 align 环境中, 类似与 &= 但不显示等号.
\newcommand{\ltag}[1]{\label{#1}\tag{#1}}

% 字符
\renewcommand{\i}{\mathrm{i}}
\renewcommand{\j}{\mathrm{j}}
\renewcommand{\k}{\mathrm{k}}
\newcommand{\e}{\mathrm{e}}
\newcommand{\o}{\mathrm{o}}
\newcommand{\ve}{\varepsilon}
\newcommand{\Beta}{\mathrm{B}}
\newcommand{\omicron}{\mathit{o}}
\newcommand{\Omicron}{\mathrm{O}}

% 简写与重定义
\newcommand{\bm}[1]{\boldsymbol{#1}}
\renewcommand{\cal}[1]{\mathcal{#1}}
\renewcommand{\scr}[1]{\mathscr{#1}}
\renewcommand{\frak}[1]{\mathfrak{#1}}
\renewcommand{\rm}[1]{\mathrm{#1}}
\newcommand{\bb}[1]{\mathbb{#1}}

% 数集
\newcommand{\D}{\mathbb{D}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\J}{\mathbb{J}}
\newcommand{\K}{\mathbb{K}}
\renewcommand{\L}{\mathbb{L}}

% 上下标
\newcommand{\trans}{^\mathrm{T}}
\newcommand{\conj}{^\rm{H}}
\newcommand{\inv}{^{-1}}
\newcommand{\madj}[1]{^{\pqty{#1^*}}}	% m 重伴随矩阵
\newcommand{\adj}{^*}
\newcommand{\vector}[1]{\overrightarrow{#1}}
\newcommand{\wavy}[1]{\overset\sim#1}	% \tilde 或 \widetilde 不明显, 容易与 \bar 或 \overline 混淆

% 序列
\newcommand{\ccdots}{\cdot\cdots\cdot}
\newcommand{\oneton}{1,2,\cdots,n}
\newcommand{\oneto}[1]{1,2,\cdots,#1}

\newcommand{\ssto}[3]{#1_1 #3 #1_2 #3 \cdots #3 #1_{#2}}
\newcommand{\ssup}[3]{#1^1 #3 #1^2 #3 \cdots #3 #1^{#2}}
\newcommand{\soneto}[2]{\ssto{#1}{#2}{,}}
\newcommand{\splus}[2]{\ssto{#1}{#2}{+}}

% 括号
\newcommand{\aqty}[1]{\expval{#1}}
\newcommand{\pbqty}[1]{\left(#1\right]}
\newcommand{\bpqty}[1]{\left[#1\right)}
\newcommand{\floor}[1]{\left\lfloor#1\right\rfloor}
\newcommand{\ceil}[1]{\left\lceil#1\right\rceil}
\newcommand{\Norm}[1]{\norm\big{#1}}
\newcommand{\Angle}[1]{\left|\hspace{-0.1em}\underline{\hspace{0.1em}#1}\right.}

% 矩阵宏简写
\newcommand{\bmatrix}[1]{\begin{bmatrix}#1\end{bmatrix}}
\newcommand{\Bmatrix}[1]{\begin{Bmatrix}#1\end{Bmatrix}}
\newcommand{\vmatrix}[1]{\begin{vmatrix}#1\end{vmatrix}}
\newcommand{\Vmatrix}[1]{\begin{Vmatrix}#1\end{Vmatrix}}

% 常用微分
\newcommand{\dx}{\dd{x}}
\newcommand{\dy}{\dd{y}}
\newcommand{\dz}{\dd{z}}
\newcommand{\dt}{\dd{t}}
\newcommand{\ds}{\dd{s}}
\newcommand{\dr}{\dd{r}}

% 一般的微分
% 如果只使用 \dd{x}\dd{y} 的话, 中间会有多余的间隔.
\newcommand{\df}{\dd}
\newcommand{\ddf}[2]{\,\mathrm{d}#1\mathrm{d}#2}	% 微分形式 differential form
\newcommand{\dddf}[3]{\,\mathrm{d}#1\mathrm{d}#2\mathrm{d}#3}

% 高阶微分
\newcommand{\dxdy}{\ddf{x}{y}}
\newcommand{\dydz}{\ddf{y}{z}}
\newcommand{\dzdx}{\ddf{z}{x}}
\newcommand{\dudv}{\ddf{u}{v}}
\newcommand{\drdt}{\ddf{r}{\theta}}
\newcommand{\dxdydz}{\dddf{x}{y}{z}}

% 矩阵的宏指令
\newcommand{\pmcmn}[3]{\begin{pmatrix}
	#1_{11} & #1_{12} & \cdots & #1_{1#3} \\
	#1_{21} & #1_{22} & \cdots & #1_{n#3} \\
	\vdots & \vdots && \vdots \\
	#1_{#2 1} & #1_{#2 2} & \cdots & #2_{n#3} \\
\end{pmatrix}}

\newcommand{\pmc}[1]{\pmcmn{#1}{n}{n}}
\newcommand{\pvcn}[2]{\begin{pmatrix}
	#1_1 \\ #1_2 \\ \vdots \\ #1_{#2}
\end{pmatrix}}

\newcommand{\pvc}[1]{\pvcn{#1}{n}}
\newcommand{\pto}{\overset{P}{\to}}

% 函数名
\renewcommand{\char}{\operatorname{char}}	% 由于已存在此命令, 不可使用 DeclareMathOperator
\renewcommand{\r}{\operatorname{r}}
\DeclareMathOperator{\st}{s.t.\,}	% 虽然不是函数名, 但用了这个指令就放这儿了.
\DeclareMathOperator{\diag}{diag}	% 不需要定义太多, 一个文件里用到什么定义什么,
\DeclareMathOperator{\Ker}{Ker}		% 毕竟特殊的函数名太多太多了.
\DeclareMathOperator{\Aut}{Aut}		% 便捷与效率的权衡.
\DeclareMathOperator{\Inn}{Inn}
\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\SL}{SL}
\DeclareMathOperator{\stab}{stab}
\DeclareMathOperator{\orb}{orb}
\DeclareMathOperator{\lcm}{lcm}
\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator{\Cov}{Cov}
\DeclareMathOperator{\Corr}{Corr}
\DeclareMathOperator{\rot}{rot}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\Outer}{Outer}
\DeclareMathOperator{\Even}{Even}
\DeclareMathOperator{\Scalar}{Scalar}
\DeclareMathOperator{\Vector}{Vector}
\DeclareMathOperator{\arsh}{arsh}
\DeclareMathOperator{\arch}{arch}
\DeclareMathOperator{\arth}{arth}
\renewcommand{\Re}{\operatorname{Re}}	% 自带 \Re 的效果是 \mathrm{Re}, 前后无空格, 故重写
\renewcommand{\Im}{\operatorname{Im}}
\DeclareMathOperator{\Sa}{Sa}
\DeclareMathOperator{\Si}{Si}
\DeclareMathOperator{\avg}{avg}
\DeclareMathOperator{\cond}{cond}

% 运算符
% 可以用 \bigcap, \bigcup, \bigoplus, \bigotimes 替代
\newcommand{\capop}{\displaystyle\mathop\cap\limits}
\newcommand{\cupop}{\displaystyle\mathop\cup\limits}
\newcommand{\oplusop}{\mathop\oplus\limits}
\newcommand{\otimesop}{\mathop\otimes\limits}
\newcommand{\bigoplusop}{\mathop\bigoplus\limits}
\newcommand{\bigotimesop}{\mathop\bigotimes\limits}

% 积分
\newcommand{\dint}{\displaystyle\int}
\newcommand{\inti}{\dint_{-\infty}^{+\infty}}
\newcommand{\intoi}{\dint_0^{+\infty}}

\newcommand{\intl}{\displaystyle\int\limits}
\newcommand{\iintl}{\displaystyle\iint\limits}
\newcommand{\iiintl}{\displaystyle\iiint\limits}

\newcommand{\coiint}[1]{\d{\oiint\hspace{-1em}}_{#1}\;}
\newcommand{\coiiint}[1]{\d{\oiiint\hspace{-0.9em}}_{#1}\;}

% 求和
\newcommand{\dsum}{\displaystyle\sum}
\newcommand{\csum}[1]{\dsum_{#1=1}^\infty}
\newcommand{\nsum}{\csum{n}}
\newcommand{\ksum}{\csum{k}}
\newcommand{\nosum}{\dsum_{n=0}^\infty}
\newcommand{\insum}{\dsum_{i=1}^n}
\newcommand{\knsum}{\dsum_{k=1}^n}
\newcommand{\csuminf}[1]{\dsum_{#1=-\infty}^{+\infty}}
\newcommand{\nsuminf}{\csuminf{n}}

% 求积
\newcommand{\dprod}{\displaystyle\prod}
\newcommand{\nprod}{\dprod_{n=1}^\infty}
\newcommand{\noprod}{\dprod_{n=0}^\infty}
\newcommand{\inprod}{\dprod_{i=1}^n}

% 极限
\newcommand{\liml}{\lim\limits}
\newcommand{\ulim}{\overline\lim\limits_{n\to\infty}}
\newcommand{\dlim}{\underline\lim\limits_{n\to\infty}}
% 注意这里的 d 是 down, 而不是 displaystyle

\newcommand{\xlim}{\lim\limits_{x\to x_0}}
\newcommand{\nlim}{\lim\limits_{n\to\infty}}
\newcommand{\clim}[1]{\lim\limits_{#1\to\infty}}

% 并集
\newcommand{\incup}{\bigcup_{i=1}^n}
\newcommand{\ncup}{\bigcup_{n=1}^\infty}
\newcommand{\icup}{\bigcup_{i=1}^\infty}

% 交集
\newcommand{\incap}{\bigcap_{i=1}^n}
\newcommand{\ncap}{\bigcap_{n=1}^\infty}
\newcommand{\icap}{\bigcap_{i=1}^\infty}

% 差分
\newcommand{\DD}{\Delta}
\newcommand{\DV}[2]{\dfrac{\DD#1}{\DD#2}}
\newcommand{\nDV}[3]{\dfrac{\DD^{#1}#2}{\DD#3^{#1}}}

% 求导
\newcommand{\ddv}{\displaystyle\dv}
\newcommand{\dpdv}{\displaystyle\pdv}

% 最值 (返回参数); 暂时先这么凑合着用吧
\newcommand{\argmax}[1]{\underset{#1}{\operatorname{argmax}}}
\newcommand{\argmin}[1]{\underset{#1}{\operatorname{argmin}}}

% 缩写
\newcommand{\LRA}{\Leftrightarrow}
\newcommand{\RLA}{\Leftrightarrow}
\newcommand{\LA}{\Leftarrow}
\newcommand{\RA}{\Rightarrow}

\newcommand{\lra}{\leftrightarrow}
\newcommand{\rla}{\leftrightarrow}
\newcommand{\la}{\leftarrow}
\newcommand{\ra}{\rightarrow}

\newcommand{\QRLA}{\quad\RLA\quad}
\newcommand{\QRA}{\quad\RA\quad}
\newcommand{\LLRA}{\Longleftrightarrow}

\newcommand{\QNRA}{\quad\nRightarrow\quad}
\newcommand{\qnra}{\quad\nrightarrow\quad}

\newcommand{\wt}{\widetilde}

% 图形符号
\newcommand{\qed}{\quad\square}
\renewcommand{\parallel}{\mathrel{/\mskip-2.5mu/}}
\newcommand{\paralleleq}{\hspace{0.5em}{^{^{\parallel}}}\hspace{-1.04em}=}
\newcommand{\rt}{\matrm{Rt}\triangle}

% 分块矩阵
\newenvironment{mat}[1]{
	\begin{array}{#1}
}{
	\end{array}
}

\newenvironment{pmat}[1]{
	\left( \begin{array}{#1}
}{
	\end{array} \right)
}

\newenvironment{bmat}[1]{
	\left[ \begin{array}{#1}
}{
	\end{array} \right]
}

\newenvironment{Bmat}[1]{
	\left\{ \begin{array}{#1}
}{
	\end{array} \right\}
}

\newenvironment{vmat}[1]{
	\left\lvert \begin{array}{#1}
}{
	\end{array} \right\rvert
}

\newenvironment{Vmat}[1]{
	\left\lVert \begin{array}{#1}
}{
	\end{array} \right\rVert
}

% 积分变换
\newcommand{\ft}{\overset{\cal F}{\rla}}
\newcommand{\dtft}{\overset{\rm F}{\rla}}
\newcommand{\lt}{\overset{\cal L}{\rla}}
\newcommand{\bt}{\overset{\cal B}{\rla}}
\newcommand{\zt}{\overset{\cal Z}{\rla}}
\newcommand{\bzt}{\overset{\cal Z_B}{\rla}}
\newcommand{\lzt}{\overset{\cal Z_L}{\rla}}
\newcommand{\rzt}{\overset{\cal Z_R}{\rla}}
$$

[TOC]

### 5.1  预备知识

#### 5.1.1  特征值与特征向量

- 矩阵 $ \bm A $.
  - **谱** $ \sigma(\bm A) $ 即全体特征值.
  - **谱半径** $ \rho(\bm A) = \d\max_{1 \le i \le n} \vqty{\lambda_i} $.
  - **特征多项式** $ p(\lambda) = \det(\lambda \bm I - \bm A) $.
  - **特征方程** $ p(\lambda) = (\lambda - \lambda_1) (\lambda - \lambda_2) \cdots (\lambda - \lambda_n) = 0 $.
  - $ \det(\bm A) = \ssto{\lambda}{n}{} $.
  - $ \tr(\bm A) = \insum a_{ii} = \insum \lambda_i $.
- 特征值与特征向量的性质
  - $ \bm A\trans $ 有相同的特征值 $ \lambda $ 与特征向量 $ \bm x $.
  - 若 $ \bm A $ 非奇异，则 $ \bm A\inv $ 的特征值为 $ \lambda\inv $，特征向量为 $ \bm x $.
  - 若 $ \bm A $ 非奇异，则 $ \bm A\adj $ 的特征值为 $ \vqty{\bm A} \lambda\inv $，特征向量为 $ \bm x $.
  - 相似矩阵 $ \bm B = \bm S\inv \bm A \bm S $ 有相同的特征多项式.
  - 哈密顿-凯莱定理：$ \lambda(\bm I \pm \bm A) = 1 \pm \lambda(\bm A) $.

  - $ \rho(\bm B)^k = \rho(\bm B) $

- $ \bm A\trans \bm A $ 和 $ \bm A \bm A\trans $.
  - 二者是对称矩阵.
  - 二者的特征值相等，且非负.
  - 二者的 $ 2- $范数相等.





#### 5.1.2  常见的特殊矩阵

- 对角
  - 对角矩阵：$ \forall i \ne j \colon a_{ij} = 0 $.
  - 三对角矩阵：$ \forall \vqty{i - j} > 1 \colon a_{ij} = 0 $.
- 上三角
  - 上三角矩阵：$ \forall i > j \colon a_{ij} = 0 $.
  - 单位上三角矩阵：$ ( \forall i > j \colon a_{ij} = 0 ) \and (\forall i \colon a_{ii} = 1) $.
  - 严格上三角矩阵：$ \forall i > j-1 \colon a_{ij} = 0 $.
  - 上海森伯格阵：$ \forall i > j + 1 \colon a_{ij} = 0 $.
- 对称
  - 对称矩阵：$ \bm A\trans = \bm A $.
  - 埃尔米特矩阵：$ \bm A\conj := \overline A{}\trans = \bm A $.
  - 对称正定矩阵：$ (\bm A\trans = \bm A) \and \pqty{\forall \bm 0 \ne \bm x \in \R^n \colon (\bm A \bm x, \bm x) = \bm x\trans \bm A \bm x > 0} $.
    - 性质 1：$ \forall i \colon \lambda_i > 0 $.
    - 性质 2：$ \forall i \colon a_{ii} > 0 $.
- 其他
  - 正交矩阵：$ \bm A\inv = \bm A\trans $.
  - 酉矩阵：$ \bm A\inv = \bm A\conj $.
  - 初等置换阵、置换阵.



#### 5.1.3  矩阵的常用定理

- 定理 1：矩阵 $ \bm A \in \R^{n \cp n} $ 非奇异的等价命题：
  - $ \forall \bm b \in \R^n \colon \bm A \bm x = \bm b $ 有唯一解.
  - $ \bm A \bm x = \bm 0 $ 有唯一解 $ \bm x = \bm 0 $.
  - $ \det(\bm A) \ne 0 $.
  - $ \exist \bm A\inv \colon \bm A \bm A\inv = \bm E $.
  - $ \rank(\bm A) = n $.
- 定理 2：设 $ \bm A \in \R^{n \cp n} $ 为对称正定矩阵，则
  - $ \det(\bm A) \ne 0 $，并且 $ \bm A\inv $ 也是对称正定矩阵.
  - 顺序主子阵 $ \forall k \colon \bm A_k = \begin{pmatrix}
    	a_{11} & \cdots & a_{1k} \\
    	\vdots & & \vdots \\
    	a_{k1} & \cdots & a_{kk}
    \end{pmatrix} $ 是对称矩阵.
  - $ \bm A $ 的特征值 $ \forall i \colon \lambda_i > 0 $，并且 $ \forall k \colon \det(\bm A_k) > 0 $.
- 定理 3：对称阵 $ \bm A \in \R^{n \cp n} $ 正定的充分条件：
  - $ \forall i \colon \lambda_i > 0 $.
  - $ \forall k \colon \det(\bm A_k) > 0 $.
- 定理 4：若尔当标准型
  - 若尔当块：$ \bm J_i = \pmatrix{
    	\lambda_i & 1 &&& \\
    	& \lambda_1 & 1 && \\
    	&& \ddots & \ddots & \\
    	&&& \lambda_i & 1 \\
    	&&&& \lambda_i
    }_{n_i \cp n_i} $.
  - 若尔当标准型：$ \bm P\inv \bm A \bm P = \mqty(\dmat{
    	\bm J_1(\lambda_1), \bm J_2(\lambda_2), \ddots, \bm J_r(\lambda_r)
    }) $.
  - 若 $ \forall i \ne j \colon \lambda_i \ne \lambda_j $，则 $ \forall i \colon \bm J_i $ 均为一阶，于是标准型变为对角矩阵.



### 5.2  高斯消去法

#### 5.2.1  高斯消去法

**定理 5**	设 $ \bm A \bm x = \bm b $，其中 $ \bm A \in \R^{n \cp n} $，

1. 若 $ \forall k \colon a_{kk}^{(k)} \ne 0 $，则可如下计算：

   1. 消元计算：$ \bm A \bm x = \bm b $ 化为 $ \bm L\inv \bm A \bm x \equiv \bm U \bm x = \bm L\inv \bm b $.
      $$
      \begin{cases}
      	m_{ik} = a_{ik}^{(k)} / a_{kk}^{(k)},
      	& i = k + 1, \cdots, n,
      	\\
      	a_{ij}^{(k+1)} = a_{ij}^{(k)} - m_{ik} a_{kj}^{(k)},
      	& i, j = k+1, \cdots, n,
      	\\
      	b_i^{(k+1)} = b_i^{(k)} - m_{ik} b_k^{(k)},
      	& i = k+1, \cdots, n.
      \end{cases}
      $$

   2. 回代计算：求解 $ \bm U\bm x = \bm L\inv \bm b $.
      $$
      \begin{cases}
      	x_n = b^{(n)} / a_{nn}^{(n)}, \\
      	x_k = \pqty{
      		b_k^{(k)} - \dsum_{j=k+1}^n a_{kj}^{(k)} x_j
      	} / a_{kk}^{(k)}, & k = n-1, n-2, \cdots, 1.
      \end{cases}
      $$

2. 若 $ \bm A $ 为非奇异矩阵，则可通过高斯消去法和行交换将方程组约化为 $ \bm U \bm x = \bm L\inv \bm b $.

**备注**	加减和乘除的次数均为 $ \cal O(n^3) $.

---

**定理 6**	约化的主元素非零的充要条件是 $ \bm A $ 的顺序主子式 $ \forall k \colon D_k \ne 0 $，即
$$
\forall i \colon D_i = \begin{vmatrix}
	a_{11} & \cdots & a_{1i} \\
	\vdots && \vdots \\
	a_{i1} & \cdots & a_{ii}
\end{vmatrix} \ne 0.
$$
**推论**	若 $ \bm A $ 的顺序主子式 $ \forall k \colon D_k \ne 0 $，则
$$
\begin{cases}
	a_{11}^{(1)} = D_1, \\
	a_{kk}^{(k)} = D_k / D_{k-1}, & k = 2, 3, \cdots, n.
\end{cases}
$$



#### 5.2.2  矩阵的三角分解

**定理 7（LU 分解）**	若 $ \bm A \in \R^{n \cp n} $ 且 $ \forall i \colon D_i \ne 0 $，则可唯一分解为单位下三角矩阵和上三角矩阵的乘积，即 $ \bm A = \bm L \bm U $.

**备注**	有三种分解方式：

1. Doolittle 分解
   $$
   \bm A = \bm L \bm U = \begin{bmatrix}
   	1 &&& \\
   	l_{21} & 1 && \\
   	\vdots & \vdots & \ddots & \\
   	l_{n1} & l_{n2} & \cdots & 1
   \end{bmatrix} \begin{bmatrix}
   	u_{11} & u_{12} & \cdots & u_{1n} \\
   	& u_{22} & \cdots & u_{2n} \\
   	&& \ddots & \vdots \\
   	&&& u_{nn}
   \end{bmatrix}.
   $$

2. Crout 分解
   $$
   \bm A = \bm L \bm U = \begin{bmatrix}
   	l_{11} &&& \\
   	l_{21} & l_{22} && \\
   	\vdots & \vdots & \ddots & \\
   	l_{n1} & l_{n2} & \cdots & l_{nn}
   \end{bmatrix} \begin{bmatrix}
   	1 & u_{12} & \cdots & u_{1n} \\
   	& 1 & \cdots & u_{2n} \\
   	&& \ddots & \vdots \\
   	&&& 1
   \end{bmatrix}.
   $$

3. LDU 分解
   $$
   \bm A = \bm L \bm D \bm U = \begin{bmatrix}
   	1 &&& \\
   	l_{21} & 1 && \\
   	\vdots & \vdots & \ddots & \\
   	l_{n1} & l_{n2} & \cdots & 1
   \end{bmatrix}
   \mqty[\dmat{d_1, d_2, \ddots, d_n}]
   \begin{bmatrix}
   	1 & u_{12} & \cdots & u_{1n} \\
   	& 1 & \cdots & u_{2n} \\
   	&& \ddots & \vdots \\
   	&&& 1
   \end{bmatrix}.
   $$

---

**算法 1（列主元消去法）**

**定理 8（列主元的 LU 分解）**	若 $ \bm A $ 非奇异，则存在排列矩阵 $ \bm P $ 使得 $ \bm P \bm A = \bm L \bm U $.



#### 5.2.3  三角矩阵的求解

1. $ \bm U \bm x = \bm d $ 和 $ \bm L \bm x = \bm d $.

   1. 上三角矩阵：依次计算 $ i = n, n-1, \cdots, 1 $.
      $$
      x_i = \left. \pqty{
      	d_i - \dsum_{j = i+1}^n u_{ij} x_j
      } \right/ u_{ii}.
      $$

   2. 下三角矩阵：依次计算 $ i = \oneton $.
      $$
      x_i = \left. \pqty{
      	d_i - \dsum_{j = 1}^{i-1} u_{ij} x_j
      } \right/ u_{ii}.
      $$

2. 乘除法次数

   1. 乘法次数：$ 0 + 1 + 2 + \cdots + (n-1) = \dfrac{n(n-1)}{2} $，$ O(n^2) $.
   2. 除法次数：$ n $.
   3. 加减次数：$ \dfrac{n(n+1)}{2} $，$ O(n^2) $.

3. 逆矩阵求解公式：设 $ \bm A = \bm U\inv $，则 $ \bm A $ 亦为上三角矩阵.
   $$
   \begin{cases}
   	a_{ii} = \dfrac{1}{u_{ii}}, & i = \oneton, \\
   	a_{ij} = - \dsum_{k=i+1}^j \dfrac{u_{ik} s_{kj}}{u_{ii}}, &
   	\begin{array}{l}
   		j = i+1, i+2, \cdots, n, \\
   		i = n-1, n-2, \cdots, 1.
   	\end{array}
   \end{cases}
   $$



### 5.3  矩阵三角分解法

#### 5.3.1  直接三角分解

- 思路

  - 将 $ \bm A $ 分解为 $ \bm A = \bm L \bm U $.（每次计算左上角的一圈）
  - 将 $ \bm A \bm x = \bm b $ 分解为 $ \begin{cases}
    	\bm L \bm y = \bm b, \\
    	\bm U \bm x = \bm y.
    \end{cases} $ 
  - 先求出 $ \bm y $，再求出 $ \bm x $，时间复杂度 $ \cal O(n^3) $.

- 算法 1：不选主元的三角分解

  - 单位下三角：杜利特尔（Doolittle）分解
    $$
    \begin{cases}
    	u_{1j} = a_{1j}, & j = \oneto n, \\
    	l_{i1} = a_{i1} / u_{11}, & i = 2, 3, \cdots, n.
    \end{cases}
    $$

    $$
    \begin{cases}
    	u_{ij} &= a_{ij} - \dsum_{k=1}^{i-1} l_{ik} u_{kj},
    	& j = i, i+1, \cdots, n, \\
    	l_{ij} &= \pqty{
    		a_{ij} - \dsum_{k=1}^{j-1} l_{ik} u_{kj}
    	} / u_{jj}, & i = j+1, \cdots, n, j \ne n.
    \end{cases}
    $$

  - 单位上三角：克劳特（Crout）分解
    $$
    \begin{cases}
    	l_{i1} = a_{i1}, & i = \oneton, \\
    	u_{1j} = a_{1j} / l_{11}, & i = 2, 3, \cdots, n.
    \end{cases}
    $$

    $$
    \begin{cases}
    	l_{ij} = a_{ij} - \dsum_{k=1}^{j-1} l_{ik} u_{kj}, &
    	i = j, j+1, \cdots, n, \\
    	u_{ij} = \pqty{
    		a_{ij} - \dsum_{k=1}^{i-1} l_{ik} u_{kj}
    	} / l_{ii}, & j = i+1, i+2, \cdots, n, i \ne n.
    \end{cases}
    $$

- 算法 2：选主元的三角分解法

  - 单位下三角：由于 $ u_{ii} $ 会作为分母，应使之尽可能大.
  - 单位上三角

- 算法 2‘：求逆矩阵，$ \cal O(n^3) $.

  1. 分解为 $ \bm P\bm A = \bm L \bm U $.
  2. 计算 $ \bm U\inv $.
  3. 计算 $ \bm U\inv \bm L\inv $
  4. 计算 $ \bm A\inv = \bm U\inv \bm L\inv \bm P $.



#### 5.3.2  平方根法

**定理 9**	若 $n$ 阶<u>对称矩阵</u> $ \bm A $ 所有顺序主子式非零，则可唯一分解为 $ \bm A = \bm L \bm D \bm L\trans $.

**定理 10**	$n$ 阶<u>对称正定矩阵</u> $ \bm A $ 可唯一分解为 $ \bm A = \bm L \bm L\trans $（限定 $ \bm L $ 对角元素为正），称为楚列斯基（Cholesky）分解.

**平方根法**	利用楚列斯基分解求解对称正定方程组 $ \bm A \bm x = \bm b $.

1. 求解 $ \bm A = \bm L \bm L\trans $.
   $$
   \begin{cases}
   	l_{ii} = \sqrt{
   		a_{ii} - \dsum_{k=1}^{j-1} l_{ik}^2
   	}, & i = \oneto n,
   	\\
   	l_{ij} = \pqty{
   		a_{ij} - \dsum_{k=1}^{j-1} l_{ik} l_{kj}
   	} / l_{jj}, & i > j.
   \end{cases}
   $$

2. 求解 $ \bm L \bm y = \bm b $.

3. 求解 $ \bm L\trans \bm x = \bm y $.

**改进的平方根法**	为避免开方，分解为 $ \bm A = \bm L \bm D \bm L\trans $.



#### 5.3.3  追赶法

**问题**	$ \bm A \bm x = \bm f $，其中
$$
\bm A = \begin{pmatrix}
	b_1 & c_1  \\
	a_2 & b_2 & c_2 \\
	& \ddots & \ddots & \ddots \\
	&& a_{n-1} & b_{n-1} & c_{n-1} \\
	&&& a_n & b_n
\end{pmatrix},
$$
并且

1. $ \vqty{b_1} > \vqty{c_1} > 0 $.
2. $ \vqty{b_i} \ge \vqty{a_i} + \vqty{c_i}, a_i, c_i \ne 0, i = 2, 3, \cdots, n-1 $.
3. $ \vqty{b_n} > \vqty{a_n} > 0 $.

**分析**	如下分解
$$
\bm A = \bm L \bm U = \begin{pmatrix}
	\alpha_1 \\
	\gamma_2 & \alpha_2 \\
	& \ddots & \ddots \\
	&& \gamma_n & \alpha_n
\end{pmatrix} \begin{pmatrix}
	1 & \beta_1 \\
	& 1 & \ddots \\
	&& \ddots & \beta_{n-1} \\
	&&& 1
\end{pmatrix},
$$

于是
$$
\begin{cases}
	b_1 = \alpha_1, c_1 = \alpha_1 \beta_1, \\
	a_i = \gamma_i, b_i = \gamma_i \beta_{i-1} + \alpha_i, &
	i = 2, 3, \cdots, n, \\
	c_i = \alpha_i \beta_i, & i = 2, 3, \cdots, n-1.
\end{cases}
$$
归纳可证，对于 $ \forall i $，有 $ \vqty{\alpha_i} > \vqty{c_i} > 0 $ 和 $ 0 < \vqty{\beta_i} < 1 $，于是
$$
\begin{cases}
	\gamma_i = a_i, \\
	\alpha_i = b_i - a_i \beta_{i-1}, & i = 2, 3, \cdots, n \\
	\beta_i = c_i / \pqty{b_i - a_i \beta_{i-1}}, & i = 2, 3, \cdots, n.
\end{cases}
$$
**算法**

1. 求解 $ \beta_i $.
   $$
   \begin{cases}
   	\beta_1 = \dfrac{c_1}{b_1}, \\
   	\beta_i = \dfrac{c_i}{b_i - a_i \beta_{i-1}}, & i = 2, 3, \cdots, n-1.
   \end{cases}
   $$

2. 求解 $ \bm L \bm y = \bm f $.
   $$
   \begin{cases}
   	y_1 = \dfrac{f_1}{b_1}, \\
   	y_i = \dfrac{f_i - a_i y_{i-1}}{b_i - a_i \beta_{i-1}}, &
   	i = 2, 3, \cdots, n.
   \end{cases}
   $$

3. 求解 $ \bm U \bm x = \bm y $.
   $$
   \begin{cases}
   	x_n = y_n, \\
   	x_i = y_i - \beta_i x_{i+1}, & i = n-1, n-2, \cdots, 1.
   \end{cases}
   $$



### 5.4  向量和矩阵的范数

#### 5.4.1  向量范数

- 列向量 $ \bm x, \bm y $ 的数量积

  - 若为实数：$ (\bm x, \bm y) = \bm y\trans \bm x = \insum x_i y_i $.
  - 若为复数：$ (\bm x, \bm y) = \bm y\conj \bm x = \insum x_i \overline{y_i} $.

- 数量积的性质（$ \bm x, \bm y \in \C^n, \alpha \in \C $）

  - $ (\bm x, \bm x) \ge 0 $，当且仅当 $ \bm x = \bm 0 $ 取等.
  - $ (\alpha \bm x, \bm y) = \alpha (\bm x, \bm y) $.
  - $ (\bm x, \alpha \bm y) = \overline\alpha (\bm x, \bm y) $.
  - $ (\bm x, \bm y) = \overline{(\bm y, \bm x)} $.
  - $ (\bm x_1 + \bm x_2, \bm y) = (\bm x_1, \bm y) + (\bm x_2, \bm y) $.
  - 柯西·施瓦茨不等式：$ \vqty{(\bm x, \bm y)} \le \norm\big{\bm x}_2 \norm\big{\bm y}_2 $.

- 向量的范数

  - 定义 1（非负性）$ \norm\big{\bm x} \ge 0 $ 当且仅当 $ \bm x = \bm 0 $ 时取等.
  - 定义 2（齐次性）$ \forall \alpha \in \C \colon \norm\big{\alpha \bm x} = \vqty{\alpha} \cdot \norm\big{\bm x} $.
  - 定义 3（三角不等式）$ \norm \big{\bm x_1 + \bm x_2} \le \norm\big{\bm x_1} + \norm\big{\bm x_2} $.
  - 性质：$ \vqty{\Norm{\bm x} - \Norm{\bm y}} \le \Norm{\bm x - \bm y} $.

- 常用的范数

  - $ p- $范数：$ \norm\big{\bm x}_p = \pqty{\insum \vqty{x_i}^p}^\tfrac{1}{p}, p \ge 1 $.
  - $ 1- $范数：$ \norm\big{\bm x}_1 = \insum \vqty{x_i} $.
  - $ 2- $范数：$ \norm\big{\bm x}_2 = \sqrt{(\bm x, \bm x)} $.（欧氏范数）
  - $ \infty- $范数：$ \norm\big{\bm x}_\infty = \d\max_{1 \le i \le n} \vqty{x_i} $.（最大范数）
  - 加权范数：$ \norm\big{\bm x}_\bm W = \norm\big{\bm W \bm x}, \bm W \in \R^{n \cp n} $.

- 收敛

  - 依绝对值收敛
  - 依范数收敛
  - 依概率收敛

- 向量范数的性质

  - $ N(\bm x) = \Norm{\bm x} $ 是 $ \bm x $ 的连续函数.

  - 向量范数的等价性：$ \forall \Norm{\cdot}_s, \Norm{\cdot}_t, \exist c_1, c_2 > 0, \forall \bm x \in \R^n \colon $
    $$
    c_1 \Norm{\bm x}_s \le \Norm{\bm x}_t \le c_2 \Norm{\bm x}_s.
    $$

  - 向量收敛等价条件：$ \nlim \bm x^{(n)} = \bm x \RLA \nlim \Norm{\bm x^{(k)} - \bm x} = \bm 0 $.




#### 5.4.2  矩阵范数

- $ \rm F- $范数（Frobenius 范数）

  - $ F(\bm A) \equiv \Norm{\bm A}_\rm F := \pqty{\dsum_{i, j} a_{ij}^2}^{\tfrac{1}{2}} $.

  - $ \Norm{\bm A}_\rm F = \sqrt{\tr(\bm A\trans \bm A)} = \sqrt{\insum \lambda_i} $.

- 方阵的范数（模）

  - 正定条件：$ \Norm{\bm A} \ge 0 $ 当且仅当 $ \bm A = \bm 0 $ 时取等.
  - 齐次条件：$ \forall c \in \R \colon \Norm{c \bm A} = \vqty{c} \cdot \Norm{\bm A} $.
  - 三角不等式：$ \Norm{\bm A + \bm B} \le \Norm{\bm A} + \Norm{\bm B} $.
  - 矩阵相容性：$ \Norm{\bm A \bm B} \le \Norm{\bm A} \cdot \Norm{\bm B} $.

- 相容性：$ \forall x \in \R^n, \forall \bm A \in \R^{n \cp n} \colon \Norm{\bm A \bm x} \le \Norm{\bm A} \cdot \Norm{\bm x} $.

- 方阵的算子范数（从属范数）

  - 对于向量范数 $ \Norm{\bm x}_v $，

  - 定义算子范数 $ \Norm{\bm A}_v = \d\max_{\bm x \ne \bm 0} \dfrac{\Norm{\bm A \bm x}_v}{\Norm{\bm x}_v} $.

  - 于是算子范数是范数，且满足相容性.

- 常用的算子范数

  > 注：以下是定理，而非定义.
  >
  > 另外，我不喜欢 “列范数” 和 “行范数” 这两个名字.
  >
  > - $ 1- $范数即对第 1 维求和（即每一行相加，或同一列中所有元素相加）后寻找最大值.
  > - $ \infty- $范数即对第 2 维求和（即每一列相加，或同一行中所有元素相加）后寻找最大值.

  - $ 1- $范数（列范数）$ \Norm{\bm A}_1 = \d\max_{1 \le j  \le n} \insum \vqty{a_{ij}} $.
  - $ 2- $范数（谱范数）$ \Norm{\bm A}_2 = \sqrt{\lambda_\max(\bm A\trans \bm A)} $.
  - $ \infty- $范数（行范数）$ \Norm{\bm A}_\infty = \d\max_{1 \le i \le n} \dsum_{j=1}^n \vqty{a_{ij}} $.

- 正交

  - 正交矩阵：$ \bm Q\trans \bm Q = \bm E $.
  - 正交变换：$ \bm y = \bm Q \bm x $
    - 条件一：$ \Norm{\bm y} = \Norm{\bm x} $.
    - 条件二：夹角不变.
  - 谱范数和 F 范数在正交变换下保持不变.
    - $ \Norm{\bm Q \bm A}_F = \Norm{\bm A \bm Q}_F = \Norm{\bm A}_F $.
    - $ \Norm{\bm Q \bm A}_2 = \Norm{\bm A \bm Q}_2 = \Norm{\bm A}_2 $.

- 矩阵范数的定理

  - 对于 $ \forall \bm A \in \R^{n \cp n} $，谱半径是范数的下确界.
    - $ \forall \Norm{\cdot} \colon \rho(\bm A) \equiv \d\max_{1 \le i \le n} \vqty{\lambda_i} \le \Norm{\bm A} $.
    - $ \forall \ve > 0, \exist \Norm{\cdot}_\ve \colon \Norm{\bm A}_\ve \le \rho(\bm A) + \ve $.
    - 对于对称阵：$ % \forall (\bm A = \bm A\trans) \colon
      \Norm{\bm A}_2 = \rho(\bm A) $.
  - 矩阵序列的敛散性.
  - 若 $ \Norm{\bm B} < 1 $，则 $ \bm I \pm \bm B $ 可逆，且 $ \Norm{\pqty{\bm I \pm \bm B}\inv} \le \dfrac{1}{1 - \Norm{\bm B}} $.



#### 5.4.3  范数杂项

> 不那么重要（但同样有趣）的例子与性质.

- 范数的大小关系
  - $ \Norm{\bm x}_\infty \le \Norm{\bm x}_1 \le n \Norm{\bm x}_\infty $.

  - $ \dfrac{1}{\sqrt n} \Norm{\bm A}_\rm F \le \Norm{\bm A}_2 \le \Norm{\bm A}_\rm F $.

- 其他的向量范数
  - 若 $ \bm P \in \R^{n \cp n} $ 非奇异，则 $ \Norm{\bm x}_\bm P := \Norm{\bm P \bm x} $ 是向量范数.
  - 若 $ \bm A \in \R^{n \cp n} $ 为对称正定矩阵，则
    - $ \Norm{\bm x}_\bm A = \sqrt{(\bm A \bm x, \bm x)} $ 是向量范数.
    - 作分解 $ \bm A = \bm L \bm L\trans $，则 $ \Norm{\bm x}_\rm A = \Norm{\bm L\trans \bm x}_2 $.
- 若 $ \bm A $ 非奇异，则
  - $ \dfrac{1}{\Norm{\bm A\inv}_\infty} = \min_{\bm y \ne \bm 0} \dfrac{
    	\Norm{\bm A \bm y}_\infty
    }{
    	\Norm{\bm y}_\infty
    } $.



### 5.5  误差分析

#### 5.5.1  矩阵的性态

- 线性方程组 $ \bm A \bm x = \bm b $ 的误差，其中 $ \bm A $ 非奇异，$ \bm b \ne \bm 0 $.

  - 只考虑 $ \bm b $ 有误差 $ \delta \bm b $.
    $$
    \begin{array}{rl}
    & \begin{cases}
    	\bm A (\bm x + \delta \bm x) = \bm b + \delta \bm b, \\
    	\bm A \bm x = \bm b, \quad 
    	\bm A \delta \bm x = \delta \bm b.
    \end{cases}
    \\
    \RA & \begin{cases}
    	\Norm{\delta \bm x} = \Norm{\bm A\inv \delta \bm b}
    	\le \Norm{\bm A\inv} \Norm{\delta \bm b},
    	\\
    	\Norm{\bm b} = \Norm{\bm A \bm x} \le \Norm{\bm A} \Norm{\bm x}.
    \end{cases}
    \\
    \RA & \dfrac{\Norm{\delta \bm x}}{\Norm{\bm x}}
    \le \Norm{\bm A\inv} \Norm{\bm A}
    \dfrac{\Norm{\delta \bm b}}{\bm b}.
    \end{array}
    $$

  - 只考虑 $ \bm A $ 有误差 $ \delta\bm A $，并且 $ \Norm {\bm A\inv} \Norm{\delta\bm A} < 1 $.
    $$
    \begin{array}{c|c}
    
    \begin{array}{rl}
    & (\bm A + \delta\bm A) (\bm x + \delta \bm x) = \bm b
    \\
    \RA & (\bm A + \delta \bm A) \delta \bm x = - \delta \bm A \bm x
    \\
    \RA & \bm A (\bm I + \bm A\inv \delta \bm A) \delta \bm x = -\delta \bm A \bm x
    \\
    \RA & \delta \bm x = -(\bm I + \bm A\inv \delta \bm A)\inv \bm A\inv \delta \bm A \bm x
    \\
    \RA & \Norm{\delta \bm x} \le \dfrac{
    	\Norm{\bm A\inv} \Norm{\delta \bm A} \Norm{\bm x}
    }{
    	1 - \Norm{\bm A\inv \delta\bm A}
    } \\
    \RA & \dfrac{\Norm{\delta \bm x}}{\Norm{\bm x}}
    \le \dfrac{
    	\Norm{\bm A\inv} \Norm{\bm A}
    	\cfrac{\Norm{\delta \bm A}}{\Norm{\bm A}}
    }{
    	1 - \Norm{\bm A\inv} \Norm{\bm A}
    	\cfrac{\Norm{\delta \bm A}}{\Norm{\bm A}}
    }
    \end{array}
    
    &
    
    \begin{array}{rl}
    & (\bm A + \delta \bm A) (\bm x + \delta \bm x) = \bm b
    \\
    \RA & \bm A \delta \bm x = - \delta \bm A (\bm x + \delta \bm x)
    \\
    \RA & \delta \bm x = - \bm A\inv \delta \bm A (\bm x + \delta \bm x)
    \\
    \RA & \Norm{\bm x} \le \Norm{\bm A\inv} \Norm{\delta \bm A} \Norm{\bm x + \delta \bm x}
    \\
    \RA & \dfrac{\Norm{\delta \bm x}}{\Norm{\bm x + \delta \bm x}}
    \le \Norm{\bm A\inv} \Norm{\bm A}
    \dfrac{\Norm{\delta \bm A}}{\Norm{\bm A}}
    \\ \\ \\ \\ \\	% 奈何没有 \vspace{}
    \end{array}
    
    \end{array}
    $$

  - 同时考虑 $ \delta \bm A $ 和 $ \delta \bm b $，并且 $ \Norm {\bm A\inv} \Norm{\delta\bm A} < 1 $.
    $$
    \begin{array}{rl}
    & (\bm A + \delta \bm A) (\bm x + \delta \bm x) = \bm b + \delta \bm b
    \\
    \RA & (\bm A + \delta \bm A) \delta \bm x = \delta \bm b - \delta \bm A \bm x
    \\
    \RA & \Norm{\delta \bm x} \le \dfrac{
    	\Norm{\bm A\inv}
    }{
    	1 - \Norm{\bm A\inv \delta \bm A}
    } \pqty{
    	\Norm{\delta \bm b} + \Norm{\delta \bm A} \Norm{\bm x}
    } \\
    \RA & \dfrac{\Norm{\delta \bm x}}{\norm{\bm x}}
    \le \Norm{\delta \bm x} \le \dfrac{
    	\Norm{\bm A\inv} \Norm{\bm A}
    }{
    	1 - \Norm{\bm A\inv} \Norm{\delta \bm A}
    } \pqty{
    	\dfrac{\Norm{\delta \bm b}}{\Norm{\bm b}} +
    	\dfrac{\Norm{\delta \bm A}}{\Norm{\bm A}}
    }
    \end{array}
    $$

- 非奇异矩阵 $ \bm A $ 的 **条件数** $ \cond(\bm A)_v = \Norm{\bm A\inv}_v \Norm{\bm A}_v $.

  - 当 $ \cond(\bm A) \gg 1 $ 时，矩阵是病态的.
  - 当 $ \cond(\bm A) \ll 1 $ 时，矩阵是良态的.




#### 5.5.2  矩阵条件数

- 常用的条件数

  - 无穷条件数：$ \cond(\bm A)_\infty = \Norm{\bm A\inv}_\infty \Norm{\bm A}_\infty $.
  - 谱条件数：$ \cond(\bm A)_2 = \sqrt{\dfrac{\lambda_\max(\bm A\trans \bm A)}{\lambda_\min(\bm A \bm A\trans)}} $.

- 谱条件数的性质

  - 对称阵的谱条件数：$ \cond(\bm A)_2 = \dfrac{\max\vqty{\lambda}}{\min\vqty{\lambda}} $.
  - 正交矩阵的谱条件数：$ \cond(\bm A)_2 = 1 $.
  - 若 $ \bm R $ 正交，$ \bm A $ 非奇异，则 $ \cond(\bm R \bm A)_2 = \cond(\bm A \bm R)_2 = \cond(\bm A)_2 $.

- 一般的条件数的性质

  - $ \cond(\bm A)_v = \Norm{\bm A\inv}_v \Norm{\bm A}_v \ge \Norm{\bm A\inv \bm A}_v = 1 $.
  - $ \forall c \ne 0 \colon \cond(c \bm A)_v = \cond(\bm A)_v $.
  - $ \cond(\bm A \bm B) \le \cond(\bm A) \cond(\bm B) $.

- （常见矩阵的条件数）

- 病态矩阵的判断

  - 若使用主元素消去法时出现了小主元，则一般为病态.
  - 若矩阵的行列式较小（某些行近似线性相关），则可能为病态.
  - 若矩阵元素间数量积相差很大且无规则，则可能为病态.

- 病态矩阵的求解

  - ~~选主元的消去法~~
  - 采用高精度（双倍字长）
  - 预处理：将 $ \bm A \bm x = \bm b $ 转化为 $ \begin{cases}
    	\bm P \bm A \bm Q \bm y = \bm P \bm b, \\
    	\bm y = \bm Q\inv \bm x.
    \end{cases} $，使得 $ \cond(\bm P\bm A\bm Q) < \cond(\bm A) $.
  - 当矩阵的元素大小不均时，<u>对行引进比例因子</u>，使得所有行按 $ \infty- $范数的长度相近.

- 事后误差估计：对于非奇异矩阵 $ \bm A $，$ \bm x $ 和 $ \bm x^* $ 分别是 $ \bm A \bm x = \bm b \ne \bm 0 $ 的精确解和近似解，剩余向量 $ \bm r = \bm b - \bm A \bm x^* $，则
  $$
  \dfrac{\Norm{\bm x - \bm x^*}}{\Norm{\bm x}} \le \cond(\bm A) \cdot \dfrac{\Norm{\bm r}}{\Norm{\bm b}}.
  $$



#### 5.5.3  迭代改善法

1. 求近似解
   1. 选主元三角分解：$ \bm P \bm A = \bm L \bm U $.
   2. 求解 $ \bm A \bm x_1 = \bm b $，即 $ \begin{cases}
      	\bm L \bm y = \bm P \bm b, \\
      	\bm U \bm x_1 = \bm y.
      \end{cases} $ 
2. 迭代：$ k = \oneto{N_0} $，
   1. $ \bm r_k = \bm b - \bm A \bm x_k $.
   2. 求解 $ \bm A \bm d_k = \bm r_k $，即 $ \bm L \bm U \bm d_k = \bm P \bm r_k $.
   3. 如果 $ \left. \Norm{\bm d_k}_\infty \right/ \Norm{\bm x_k}_\infty \le \ve $，则停止计算.
   4. $ \bm x_{k+1} = \bm x_k + \bm d_k $.

> 如果矩阵非常病态，则上述算法仍可能不收敛.


