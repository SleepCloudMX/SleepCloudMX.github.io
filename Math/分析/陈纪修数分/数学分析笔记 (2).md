<h1 align="center">数学分析笔记 (2)</h1>

$$
% 字符
\newcommand{\e}{\textup{e}}
\newcommand{\i}{\textup{i}}
\newcommand{\ve}{\varepsilon}
\newcommand{\inv}{^{-1}}
\newcommand{\trans}{^\mathrm{T}}
\newcommand{\D}{\mathbb{D}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\F}{\mathbb{F}}

\newcommand{\eqs}{\quad\;}



% 特定内容
\newcommand{\oneton}{1,2,\cdots,n}
\newcommand{\oneto}[1]{1,2,\cdots,#1}

\newcommand{\ssto}[3]{#1_1 #3 #1_2 #3 \cdots #3 #1_{#2}}
\newcommand{\ssup}[3]{#1^1 #3 #1^2 #3 \cdots #3 #1^{#2}}
\newcommand{\soneto}[2]{\ssto{#1}{#2}{,}}
\newcommand{\splus}[2]{\ssto{#1}{#2}{+}}

\newcommand{\aqty}[1]{\expval{#1}}
\newcommand{\pbqty}[1]{\left(#1\right]}
\newcommand{\bpqty}[1]{\left[#1\right)}

\newcommand{\ccdots}{\cdot\cdots\cdot}

% 下面几个只是为了方便一点点而已
\newcommand{\dx}{\dd{x}}
\newcommand{\dy}{\dd{y}}
\newcommand{\dz}{\dd{z}}
\newcommand{\dt}{\dd{t}}
\newcommand{\ds}{\dd{s}}
\newcommand{\dr}{\dd{r}}

% 如果只使用 \dd{x}\dd{y} 的话, 中间会有多余的间隔.
\newcommand{\df}{\dd}
\newcommand{\ddf}[2]{\,\mathrm{d}#1\mathrm{d}#2}	% 微分形式
\newcommand{\dddf}[3]{\,\mathrm{d}#1\mathrm{d}#2\mathrm{d}#3}

\newcommand{\dxdy}{\ddf{x}{y}}
\newcommand{\dydz}{\ddf{y}{z}}
\newcommand{\dzdx}{\ddf{z}{x}}
\newcommand{\dudv}{\ddf{u}{v}}
\newcommand{\drdt}{\ddf{r}{\theta}}
\newcommand{\dxdydz}{\dddf{x}{y}{z}}



% 函数名
\DeclareMathOperator{\diam}{diam}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\span}{span}



% 运算符
\newcommand{\dint}{\displaystyle\int}
\newcommand{\inti}{\dint_{-\infty}^{+\infty}}
\newcommand{\intoi}{\dint_0^{+\infty}}

\newcommand{\intl}{\displaystyle\int\limits}
\newcommand{\iintl}{\displaystyle\iint\limits}
\newcommand{\iiintl}{\displaystyle\iiint\limits}

\newcommand{\dsum}{\displaystyle\sum}
\newcommand{\nsum}{\dsum_{n=1}^\infty}
\newcommand{\nosum}{\dsum_{n=0}^\infty}
\newcommand{\insum}{\dsum_{i=1}^n}
\newcommand{\knsum}{\dsum_{k=1}^n}

\newcommand{\dprod}{\displaystyle\prod}
\newcommand{\nprod}{\displaystyle\prod_{n=1}^\infty}
\newcommand{\noprod}{\dprod_{n=0}^\infty}
\newcommand{\inprod}{\dprod_{i=1}^n}

\newcommand{\liml}{\lim\limits}
\newcommand{\xlim}{\lim\limits_{x\to x_0}}
\newcommand{\nlim}{\lim\limits_{n\to\infty}}
\newcommand{\clim}[1]{\lim\limits_{#1\to\infty}}
\newcommand{\ulim}{\overline\lim\limits_{n\to\infty}}
\newcommand{\dlim}{\underline\lim\limits_{n\to\infty}}



% 缩写
\newcommand{\bm}[1]{\boldsymbol{#1}}
\newcommand{\d}{\displaystyle}

\newcommand{\RLA}{\Leftrightarrow}
\newcommand{\LA}{\Leftarrow}
\newcommand{\RA}{\Rightarrow}

\newcommand{\QRLA}{\quad\RLA\quad}
\newcommand{\QRA}{\quad\RA\quad}
\newcommand{\QLA}{\quad\LA\quad}

\newcommand\ddv{\displaystyle\dv}
\newcommand\dpdv{\displaystyle\pdv}
$$

## 第 9 章	数项级数

### 定理

调和级数的 **余和数列**.

**定理 9.1.1 (级数收敛的必要条件)**	设级数 $\displaystyle \sum_{n=1}^\infty x_n$ 收敛, 则其通项构成的数列 $\Bqty{x_n}$ 是无穷小量, 即 $ \lim\limits_{n\to\infty} x_n = 0 $.

**定理 9.1.2 (线性性)**	设 $ \displaystyle \sum_{n=1}^\infty a_n = A,\, \sum_{n=1}^\infty b_n = B,\, \alpha. \beta $ 是两个常数, 则
$$
\sum_{n=1}^\infty (\alpha a_n + \beta b_n) = \alpha A + \beta B.
$$
**定理 9.1.3 (加法结合律)**	设级数 $ \displaystyle \sum_{n=1}^\infty x_n $ 收敛, 则在它的求和表达式中任意添加括号后所得的级数仍然收敛, 且其和不变.

---

**定义 9.2.1**	在有界数列 $\Bqty{x_n}$ 中, 若存在它的一个子列 $\Bqty{x_{n_k}}$ 使得 $ \lim\limits_{k\to\infty} x_{n_k} = \xi $, 则称 $\xi$ 为数列 $\Bqty{x_n}$ 的一个 **极限点**.

**定理 9.2.1** :star:	有界数列 $\Bqty{x_n}$ 的极限点的集合 $E$ 的上确界 $H$ 和下确界 $h$ 均属于 $E$, 即
$$
H = \max E,\, h = \min E.
$$

- 无界亦成立.

**定义 9.2.2**	**上极限** $ H = \overline{\lim}\limits_{n\to\infty} x_n $, **下极限** $ h = \underline{\lim}\limits_{n\to\infty} x_n $.

**定理 9.2.2** :star:	有界数列 $\Bqty{x_n}$ 收敛的充要条件是
$$
\overline{\lim_{n\to\infty}} x_n = \underline{\lim}\limits_{n\to\infty} x_n.
$$

- 无界亦成立.

**定理 9.2.3** :star:	设 $\Bqty{x_n}$ 是有界数列, 则

1. $ \overline{\lim\limits_{n\to\infty}} x_n = H $ 的充要条件是: $ \forall \ve > 0 $,
   1. $ \exist N, \forall n>N: x_n < H + \ve $.
   2. $\Bqty{x_n}$ 中有无穷多项满足 $ x_n > H-\ve $.
2. $ \underline\lim\limits_{n\to\infty} x_n = h $ 的充要条件是: $ \forall \ve > 0 $,
   1. $ \exist N, \forall n>N: x_n > H - \ve $.
   2. $\Bqty{x_n}$ 中有无穷多项满足 $ x_n < H+\ve $.

**定理 9.2.4** :star:	设 $\Bqty{x_n}$ 和 $\Bqty{y_n}$ 是两数列, 则

1. $ \ulim (x_n+y_n) \le \ulim x_n + \ulim y_n $.

   $ \dlim(x_n + y_n) \ge \dlim x_n + \dlim y_n $.

2. 若 $\lim\limits_{n\to\infty} x_n$ 存在, 则

   $ \ulim(x_n + y_n) = \nlim x_n + \ulim y_n $.

   $ \dlim(x_n + y_n) = \nlim x_n + \dlim y_n $.

   (要求上述诸式的右端不是待定型)

**定理 9.2.5** :star:	设 $\Bqty{x_n}$ 和 $\Bqty{y_n}$ 是两数列, 则

1. 若 $ x_n \ge 0$, $ y_n \ge 0 $, 则

   $ \ulim(x_n y_n) \le \ulim x_n \cdot \ulim y_n $.

   $ \dlim(x_n y_n) \ge \dlim x_n \cdot \dlim y_n $.

2. 若 $ \nlim x_n = x \in (0, +\infty) $, 则

   $ \ulim(x_n y_n) = \nlim x_n \cdot \ulim y_n $.

   $ \dlim(x_n y_n) = \nlim x_n \cdot \dlim y_n $.

   (要求上述诸式的右端不是待定型)

---

对于 $\Bqty{x_n}$, 记
$$
\begin{align}
b_n &= \sup\Bqty{x_{n+1}, x_{n+2}, \cdots} = \sup_{k>n} \Bqty{x_k}
\\
a_n &= \inf\Bqty{x_{n+1}, x_{n+2}, \cdots} = \inf_{k>n} \Bqty{x_k}
\\
H^* &= \nlim b_n = \nlim \sup_{k>n} \Bqty{x_k}
\\
h^* &= \nlim a_n = \nlim \inf_{k>n} \Bqty{x_k}
\end{align}
$$
**定理 9.2.6** :star:	$H^*$ 是 $\Bqty{x_n}$ 的最大极限点, $h^*$ 是 $\Bqty{x_n}$ 的最小极限点, 即
$$
H^* = \max{E} = \ulim x_n,\quad h^* = \min{E} = \dlim x_n.
$$

---

**定理 9.3.1 (正项级数的收敛原理)**	正项级数收敛的充要条件是它的部分和数列有上界.

**定理 9.3.2 (比较判别法)**	设 $ \displaystyle \sum_{n=1}^\infty x_n $ 与 $\displaystyle \sum_{n=1}^\infty y_n$ 是两个正项级数, 若 $ \exist A>0: x_n \le Ay_n,\, n = 1, 2, \cdots, $ 则

1. 当 $\displaystyle \sum_{n=1}^\infty y_n$ 收敛时, $ \displaystyle \sum_{n=1}^\infty x_n $ 也收敛.
2. 当 $ \displaystyle \sum_{n=1}^\infty x_n $ 发散时, $\displaystyle \sum_{n=1}^\infty y_n$ 也发散.

**定理 9.3.2' (比较判别法的极限形式)**	设 $ \displaystyle \sum_{n=1}^\infty x_n $ 与 $\displaystyle \sum_{n=1}^\infty y_n$ 是两个正项级数, 且 $ \nlim \dfrac{x_n}{y_n} = l $, 则

1. 若 $ 0 \le l < +\infty $, 则当 $\displaystyle \sum_{n=1}^\infty y_n$ 收敛时, $ \displaystyle \sum_{n=1}^\infty x_n $ 也收敛.
2. 若 $ 0 < l \le +\infty $, 则当 $\displaystyle \sum_{n=1}^\infty y_n$ 发散时, $ \displaystyle \sum_{n=1}^\infty x_n $ 也发散.

**定理 9.3.3 (Cauchy 判别法)** :star:	设 $ \displaystyle \sum_{n=1}^\infty x_n $ 是正项级数, $ r = \ulim \sqrt[n]{x_n} $, 则

1. 当 $r<1$ 时, $ \displaystyle \sum_{n=1}^\infty x_n $ 收敛.
2. 当 $r>1$ 时, $ \displaystyle \sum_{n=1}^\infty x_n $ 发散.
3. 当 $r=1$ 时, 级数可能收敛可能发散.

**定理 9.3.4 (d' Alembert 判别法)** :star:	设 $ \displaystyle \sum_{n=1}^\infty x_n\; (x_n \ne 0) $ 是正项级数, 则

1. 当 $ \ulim \dfrac{x_{n+1}}{x_n} = \overline{r} < 1 $ 时, 级数 $ \displaystyle \sum_{n=1}^\infty x_n $ 收敛.
2. 当 $ \dlim \dfrac{x_{n+1}}{x_n} = \underline{r} > 1 $ 时, 级数 $ \displaystyle \sum_{n=1}^\infty x_n $ 发散.
3. 当 $ \overline{r} \ge 1 $ 或 $ \underline{r} \le 1 $ 时, 级数可能收敛, 也可能发散.

**引理 9.3.1** :star:	设 $\Bqty{x_n}$ 是正项数列, 则
$$
\dlim \dfrac{x_{n+1}}{x_n} \le \dlim \sqrt[n]{x_n} \le \ulim \sqrt[n]{x_n} \le \ulim \dfrac{x_{n+1}}{x_n}.
$$

- 能用 d' Alembert 判别法判定的敛散情况, 一定能用 Cauchy 判别法判定, 反之不亦然. 二者本质是比较判别法.

**定理 9.3.5 (Rabbe 判别法)** :star:	设 $ \displaystyle \sum_{n=1}^\infty x_n\; (x_n \ne 0) $ 是正项级数, $ \nlim n\pqty{\dfrac{x_n}{x_{n+1}} - 1} = r $, 则

1. 当 $r>1$ 时, 级数 $ \displaystyle \sum_{n=1}^\infty x_n $ 收敛.
2. 当 $r<1$ 时, 级数 $ \displaystyle \sum_{n=1}^\infty x_n $ 发散.

**定理 9.3.5' (Bertrand 判别法)** :crescent_moon:	设 $ \displaystyle \sum_{n=1}^\infty x_n\; (x_n \ne 0) $ 是正项级数, $ \nlim \bqty{ n \pqty{\dfrac{x_n}{x_{n+1}} - 1}-1 } \ln{n} = r $, 则判断标准同上.

---

设 $f(x)$ 在 $[a, +\infty)$ ==非负==且 Riemann 可积,

取一单调增加趋于 $+\infty$ 的数列 $\Bqty{a_n}: a = a_1 < a_2 < \cdots$，令 $ u_n = \dint_{a_n}^{a_{n+1}} f(x)\dd{x} $.

**定理 9.3.6 (积分判别法)** :star:	反常积分 $ \dint_a^{+\infty} f(x)\dd{x} $ 与正项级数 $ \nsum u_n $ 同时收敛或同时发散于 $+\infty$, 且
$$
\int_a^{+\infty} f(x)\dd{x} = \nsum u_n = \nsum \int_{a_n}^{a_{n+1}} f(x)\dd{x}.
$$
特别地, 当 $f(x)$ 单调减少时, 取 $a_n = n$, 则反常积分 $ \dint_a^{+\infty} f(x)\dd{x} $ 与正项级数 $ \dsum_{n=N}^{\infty} f(n)\; (N = [a] + 1) $ 同时收敛或同时发散.

- 由反常积分的收敛性判断级数的收敛性.
- 由级数的收敛性判断反常积分的收敛性.

- 若 $f(x) \ge 0$ 不恒成立,则由反常积分的收敛性仍可得到级数的收敛性, 但反之不亦然.

---

**定理 9.4.1 (级数的 Cauchy 收敛原理)** :star:	级数 $ \nsum x_n $ 收敛的充要条件是: $ \forall \ve > 0, \exist N \in \N^+: $
$$
\vqty{x_{n+1} + x_{n+2} + \cdots + x_m} < \ve
$$
对一切 $ m > n > N $ 成立.

- 当 $m=n+1$ 时, 即为必要条件 $ \nlim x_n = 0 $.
- $ \forall \ve>0, \forall p\in\N^+, \exist N(\ve, p):\forall n>N, \vqty{x_{n+1}+x_{n+2}+\cdots+x_{n+p}}<\ve $ 无法推出级数收敛.

**定义 9.4.1**	$ \nsum (-1)^{n+1} u_n\; (u_n>0) $ 称为 **交错级数**, 若 $ \vqty{u_n} $ 单调减少且收敛于 0, 则称为 **Leibniz 级数**.

**定理 9.4.2 (Leibniz 判别法)**	Leibniz 级数必定收敛.

1. Leibniz 级数满足 $ 0 \le \nsum (-1)^{n+1} u_n \le u_1 $.
2. 余和 $ r_n = \dsum_{k=n+1}^\infty (-1)^{k+1} $ 满足 $ \vqty{r_n} \le u_{n+1} $.

**引理 9.4.1 (Abel 变换; 分部求和公式)** :star:	设 $ \Bqty{a_n},\, \Bqty{b_n} $ 是两数列, 记 $ B_k = \dsum_{i=1}^k b_i\; (k = 1, 2, \cdots) $, 则
$$
\sum_{k=1}^P a_k b_k = a_p B_p - \sum_{k=1}^{P-1} (a_{k+1}-a_k) B_k.
$$
**引理 9.4.2 (Abel 引理)** :star:	设 $\Bqty{a_k}$ 为单调数列, $ \Bqty{B_k}\; (B_k = \dsum_{i=1}^k b_i, k = 1, 2, \cdots) $ 为有界数列, 即 $ \exist M>0, \forall k:\vqty{B_k} \le M $, 则
$$
\vqty{\sum_{k=1}^P a_k b_k} \le M(\vqty{a_1} + 2\vqty{a_p}).
$$
**定理 9.4.3 (级数的 A-D 判别法)** :star:	若下列两个条件之一满足, 则级数 $ \nsum a_n b_n $ 收敛:

1. (**Abel 判别法**)	$ \vqty{a_n} $ 单调有界, $ \nsum b_n $ 收敛;
2. (**Dirichlet 判别法**)	$ \vqty{a_n} $ 单调趋于 0, $ \Bqty{\dsum_{i=1}^n b_i} $ 有界.

- Leibniz 判别法和 Abel 判别法均可看作 Dirichlet 判别法的特例.

---

设 $ \nsum x_n $ 是任意项级数, 令
$$
\begin{align}
	x_n^+ &= \dfrac{\vqty{x_n}+x_n}{2} = \begin{cases}
		x_n, & x_n > 0, \\
		0, & x_n \le 0,
	\end{cases}
	\\
	x_n^- &= \dfrac{\vqty{x_n}-x_n}{2} = \begin{cases}
		-x_n, & x_n < 0, \\
		0, & x_n \ge 0.
	\end{cases}
\end{align}
$$
**定理 9.4.4** :star:	若 $ \nsum x_n $ 绝对收敛, 则 $ \nsum x_n^+ $ 和 $ \nsum x_n^- $ 都收敛; 若 $ \nsum x_n $ 条件收敛, 则 $ \nsum x_n^+ $ 和 $ \nsum x_n^- $ 都发散到 $+\infty$.

---

<h4>加法交换律</h4>

**定理 9.4.5** :star:	若级数 $ \nsum x_n $ 绝对收敛, 则它的 **更序级数** $ \nsum x'_n $ 也绝对收敛, 且和不变, 即 $ \nsum x'_n = \nsum x_n $.

**定理 9.4.6 (Riemann)** :star:	设级数 $ \nsum x_n $ 条件收敛, 则 $ \forall a \in [-\infty, +\infty] $, 必定存在 $ \nsum x_n $ 的更序级数 $ \nsum x'_n $ 满足 $ \nsum x'_n = a $.

<h4>级数的乘法</h4>

级数的 **Cauchy 乘积**.

对于正方形排列所得的乘积, 只要 $ \nsum a_n $ 和 $ \nsum b_n $ 收敛, 则 $ \nsum d_n $ 收敛, 且
$$
\nsum d_n = \pqty{\nsum a_n} \pqty{\nsum b_n}.
$$
**定理 9.4.7** :star:	如果级数 $ \nsum a_n $ 与 $ \nsum b_n $ 绝对收敛, 则将 $ a_ib_j $ 按任一方式排列求和而成的级数也绝对收敛, 且其和等于 $ \pqty{\nsum a_n} \pqty{\nsum b_n} $.

---

<h4>无穷乘积</h4>

**定义 9.5.1**	如果部分积数列 $ \Bqty{P_n} $ 收敛于一个==非零有限数== $P$, 则称无穷乘积 $ \nprod p_n $ 收敛, 且称 $P$ 为它的积. 如果发散或收敛于 0, 则称无穷乘积 $ \nprod p_n $ 发散.

**定理 9.5.1** :star:	如果无穷乘积 $ \nprod p_n $ 收敛, 则

1. $ \nlim p_n = 1 $.
2. $ \lim\limits_{m\to\infty} \dprod_{n=m+1}^\infty p_n = 1 $. :crescent_moon:

---

**Wallis 公式** :star:

设 $ p_n = 1 - \dfrac{1}{(2n)^2} $, 记 $ I_n = \dint_0^{\tfrac{\pi}{2}} \sin^n x\dd{x} $, 则
$$
I_{2n} = \dfrac{(2n-1)!!}{(2n)!!} \cdot \dfrac{\pi}{2},\quad
I_{2n+1} = \dfrac{(2n)!!}{(2n+1)!!},
\\
P_n = \prod_{k=1}^n p_k
= \dfrac{[(2n-1)!!]^2}{[(2n)!!]^2} \cdot (2n+1)
= \dfrac{2}{\pi} \dfrac{I_{2n}}{I_{2n+1}},
\\
1 < \dfrac{I_{2n}}{I_{2n+1}} < \dfrac{I_{2n-1}}{I_{2n+1}}
= \dfrac{2n+1}{2n},
\\
\nlim \dfrac{I_{2n-1}}{I_{2n+1}} = 1 \QRA
\nprod p_n = \dfrac{2}{\pi}
\\ \\
\dfrac{\pi}{2} =
\pqty{ \dfrac{2}{1} \cdot \dfrac{2}{3} } \cdot
\pqty{ \frac{4}{3} \cdot \dfrac{4}{5} } \cdot
\pqty{ \dfrac{6}{5} \cdot \dfrac{6}{7} } \cdot \cdots
\\
\dfrac{(2n)!!}{(2n-1)!!} \sim \sqrt{n\pi}\quad (n\to+\infty)
$$

---

**Viete 公式** :star:
$$
\nprod \cos\dfrac{x}{2^k} =
\nlim \dfrac{\sin{x}}{2^n\sin\dfrac{x}{2^n}}
= \dfrac{\sin{x}}{x}
$$
令 $x=\dfrac{\pi}{2}$, 即得
$$
\dfrac{2}{\pi} = \cos\dfrac{\pi}{4} \cdot \cos\dfrac{\pi}{8} \cdot \cdots \cdot \cos\dfrac{\pi}{2^n} \cdot \cdots
$$

---

<h4>无穷乘积与无穷级数</h4>

**定理 9.5.2** :star:	无穷乘积 $ \nprod p_n $ 收敛的充要条件是级数 $ \nsum \ln p_n $ 收敛.

**推论 9.5.1** :star:	设 $a_n > 0$ (或 $a_n<0$), 则无穷乘积 $ \nprod (1+a_n) $ 收敛的充要条件是级数 $ \nsum a_n $ 收敛.

- 即对于==正项级数== $\nsum x_n$ 有： $ \nsum \ln(1+x_n) $ 收敛 $ \QRLA \nsum x_n $ 收敛. 

**推论 9.5.2** :star:	设级数 $ \nsum a_n $ 收敛，则无穷乘积 $ \nprod (1+a_n) $ 收敛的充要条件是级数 $ \nsum a_n^2 $ 收敛.

- 若级数 $ \nsum a_n $ 收敛，$ \nsum a_n^2 = +\infty $，则无穷乘积 $ \nprod (1+a_n) $ 发散于 0.
- 当无穷乘积 $ \nprod (1+a_n) $ 收敛时，$ \nsum a_n $ 和 $ \nsum a_n^2 $ 可能都发散.

**定义 9.5.2**	当级数 $ \nsum \ln p_n $ 绝对收敛时，无穷乘积 $\nprod p_n$ **绝对收敛**.

**定理 9.5.3** :star:	设 $a_n > -1,\, n = 1, 2, \cdots$,则下述命题等价:

1. 无穷乘积 $ \nprod (1+a_n) $ 绝对收敛.
2. 无穷乘积 $ \nprod (1+\vqty{a_n}) $ 收敛.
3. 级数 $ \nsum \vqty{a_n} $ 收敛.

---

**Stirling 公式** :star:

令 $ b_n = \dfrac{n!\e^n}{n^{n+\frac{1}{2}}} $, 则 $ \dfrac{b_n}{b_{n-1}} = \e^{1+\pqty{n-\frac{1}{2}} \ln\pqty{1-\frac{1}{n}}} = 1 - \dfrac{1}{12n^2} + o\pqty{\dfrac{1}{n^2}} $,

故 $ \dsum_{n=2}^\infty \pqty{\dfrac{b_n}{b_{n-1}} - 1} $ 是收敛的定号级数, 故无穷乘积 $ \dprod_{n=2}^\infty \dfrac{b_n}{b_{n-1}} $ 收敛于非零实数, $ \nlim b_n = b_1 \dprod_{n=2}^\infty \dfrac{b_n}{b_{n-1}} $ 也收敛于非零实数, 故
$$
\nlim b_n = \nlim \dfrac{b_n^2}{b_{2n}} = \nlim \dfrac{(2n)!!}{(2n-1)!!} \cdot \sqrt{\dfrac{2}{n}} = \sqrt{2\pi}
\\ \\
n! \sim \sqrt{2\pi} n^{n+\frac{1}{2}} \e^{-n} \quad (n\to+\infty)
$$

---

**巴塞尔问题**
$$
\sin{x} = (2n+1) \sin\dfrac{x}{2n+1} \prod_{k=1}^n \pqty{
	1 - \dfrac{\sin^2\dfrac{x}{2n+1}}{\sin^2\dfrac{k\pi}{2n+1}}
}
\\ \\
\sin x = x \nprod \pqty{
	1 - \dfrac{x^2}{n^2\pi^2}
}
\\
\nsum \dfrac{1}{n^2} = \dfrac{\pi^2}{6}
$$



### 笔记

- 可利用级数收敛的必要条件证明数列收敛于 0.
  - $ \nlim \dfrac{n^n}{(n!)^2} = 0 $.
  - $ \nlim \dfrac{(2n)!}{2^{n(n+1)}} = 0 $.
- 若由 Cauchy 判别法或 d' Alembert 判别法判断出 $ \nsum \vqty{x_n} $ 发散, 则 $ \nsum x_n $ 也发散.
- 正弦级数的有界性

$$
\vqty{\sum_{k=1}^n \sin kx} = \vqty{ \dfrac{
	\cos\dfrac{x}{2} - \cos\dfrac{2n+1}{2}x
}{2\sin\dfrac{x}{2}} }
\le \dfrac{1}{
	\vqty{ \sin\dfrac{x}{2} }
}.
$$

- 等价无穷大

$$
\dfrac{(2n)!!}{(2n-1)!!} \sim \sqrt{n\pi}\quad
\\
n! \sim \sqrt{2\pi} n^{n+\frac{1}{2}} \e^{-n}
$$

- 一些无穷乘积

$$
\dfrac{\pi}{2} =
\pqty{ \dfrac{2}{1} \cdot \dfrac{2}{3} } \cdot
\pqty{ \frac{4}{3} \cdot \dfrac{4}{5} } \cdot
\pqty{ \dfrac{6}{5} \cdot \dfrac{6}{7} } \cdot \cdots
\\
\dfrac{2}{\pi} = \cos\dfrac{\pi}{4} \cdot \cos\dfrac{\pi}{8} \cdot \cdots \cdot \cos\dfrac{\pi}{2^n} \cdot \cdots
\\
\sin x = x \nprod \pqty{
	1 - \dfrac{x^2}{n^2\pi^2}
}
\\
$$

- 若 $ \Bqty{x_n} $ 和 $ \dsum_{n=2}^\infty n(x_n - x_{n-1}) $ 收敛, 则级数 $ \nsum x_n $ 收敛. :star:
- 若 $ x_n>0 $ 且 $ \nlim n\pqty{\dfrac{x_n}{x_{n+1}} - 1} > 0 $, 则交错级数 $ \nsum (-1)^n x_n $ 收敛. :star:
- 由柯西乘积数归得: $ \dsum_{n=0}^\infty (n+1)q^n = (1-q)^{-k} $. :star:



### 例题

1. $ \nsum \sin\pqty{\sqrt{n^2+1}\pi} = \nsum \sin\pqty{\sqrt{n^2+1}-n}\pi $ 收敛.

2. 设正项级数 $ \nsum x_n $ 发散, $ S_n = \dsum_{k=1}^n x_k $, 则

   1. 存在发散的正项级数 $ \nsum y_n = \nsum\pqty{\sqrt{S_n} - \sqrt{S_{n-1}}} $, 使得 $ \nlim \dfrac{y_n}{x_n} = 0 $.
   2. $ \nsum \dfrac{x_n}{S_n^2} \le \nsum \dfrac{S_n-S_{n-1}}{S_nS_{n-1}} = \dfrac{2}{x_1}- \dfrac{1}{S_n} $ 收敛.

3. 无穷乘积
   $$
   \nlim \dfrac{
   	\beta (\beta+1) (\beta+2) \ccdots (\beta+n)
   }{
   	\alpha (\alpha+1) (\alpha+2) \ccdots (\alpha+n)
   } = 0\quad (0<\beta<\alpha)
   $$

4. 设 $\vqty{q}<1$, 则
   $$
   \nprod(1+q^n) = \dfrac{1}{\nprod(1-q^{2n-1})}
   $$



## 第 10 章	函数项级数

### 定理

**定义 10.1.1**	设 $u_n(x)$ 在 $\E$ 上定义, 对于任意固定的 $ x_0 \in \E $, 若数项级数 $ \nsum u_n(x_0) $ 收敛, 则称函数项级数 $ \nsum u_n(x) $ 在点 $x_0$ 收敛, $x_0$ 称为其 **收敛点**. 收敛点全体构成的集合 $\D$ 称为 **收敛域**.

$ \nsum u_n(x) $ 在 $\D$ 上 **点态收敛** 于 **和函数** $ S(x) = \nsum u_n(x) $, 即 **部分和函数** 的极限.

---

逐项求极限:  $ \nlim \nsum = \nsum \nlim,\quad \xlim \nlim = \nlim \xlim $.

逐项求导:  $ \ddv{x}\nsum = \nsum\ddv{x},\quad \ddv{x}\nlim = \nlim\ddv{x} $.

逐项积分:  $ \dint_a^b \nsum = \nsum \int_a^b,\quad \dint_a^b \nlim = \nlim\dint_a^b $.

---

**定义 10.1.2**	设 $\Bqty{S_n(x)} (x \in \D)$ 是一函数序列, 若对任意给定的 $\ve>0$, 存在正整数 $N(\ve)$, 当 $n>N(\ve)$ 时,
$$
\vqty{S_n(x) - S(x)} < \ve
$$
对一切 $x \in \D$ 成立, 则称 $\Bqty{S_n(x)}$ 在 $\D$ 上 **一致收敛** 于 $S(x)$, 记为 $ S_n(x) \overset\D\RA S(x) $.

同样的有 $\nsum u_n(x)$ 在 $\D$ 上一致收敛于 $S(x)$. 即
$$
\forall \ve>0, \exist N, \forall n>N, \forall x \in \D:
\vqty{\sum_{k=1}^n u_k(x) - S(x)} = \vqty{S_n(x) - S(x)} < \ve
$$
**推论 10.1.1**	若函数项级数 $\nsum u_n(x)$ 在 $\D$ 上一致收敛, 则函数序列 $\Bqty{u_n(x)}$ 在 $\D$ 上一致收敛于 $u(x) \equiv 0$.

**定义 10.1.3**	若对于==任意==给定的闭区间 $[a, b] \subset \D$, 函数序列 $\Bqty{S_n(x)}$ 在 $[a, b]$ 上一致收敛于 $S(x)$, 则称 $\Bqty{S_n(x)}$ 在 $\D$ 上 **内闭一致收敛** 于 $S(x)$.

**定理 10.1.1**	设函数序列 $\Bqty{S_n(x)}$ 在集合 $\D$ 上点态收敛于 $S(x)$, 定义 $S_n(x)$ 与 $S(x)$ 的距离为
$$
d(S_n, S) = \sup_{x\in\D} \vqty{S_n(x) - S(x)}.
$$
则 $\Bqty{S_n(x)}$ 在 $\D$ 上一致收敛于 $S(x)$ 的充要条件是 $ \nlim d(S_n, S) = 0 $.

**定理 10.1.2**	设函数序列 $\Bqty{S_n(x)}$ 在集合 $\D$ 上点态收敛于 $S(x)$, 则 $\vqty{S_n(x)}$ 在 $\D$ 上一致连续收敛于 $S(x)$ 的充要条件是: 对任意数列 $\vqty{x_n}, x_n \in \D$, 成立
$$
\nlim (S_n(x_n)- S(x_n)) = 0.
$$

<h4>一致收敛的判别</h4>

**定理 10.2.1 (函数项级数一致收敛的 Cauchy 收敛原理)**	函数项级数 $\nsum u_n(x)$ 在 $\D$ 上一致收敛的充要条件是, $\forall \ve>0, \exist N, \forall m>n>N, \forall x \in \D$
$$
\vqty{S_m(x) - S_n(x)} = \vqty{u_{n+1}(x) + u_{n+2}(x) + \cdots u_m(x)} < \ve.
$$
**定理 10.2.2 (Weierstrass 判别法)**	设函数项级数 $\nsum u_n(x) (x \in \D)$ 的每一项 $u_n(x)$ 满足
$$
\vqty{u_n(x)} \le a_n,\quad x \in \D,
$$
并且数项级数 $\nsum a_n$ 收敛, 则 $\nsum u_n(x)$ 在 $\D$ 上一致收敛.

- 此时不仅一致收敛, 还在绝对意义上一致收敛.

**定理 10.2.3**	设函数项级数 $\nsum a_n(x) b_n(x) (x \in \D)$ 满足如下两个条件之一, 则 $\nsum a_n(x) b_n(x)$ 在 $\D$ 上一致收敛.

1. (**Abel 判别法**)	函数序列 $\Bqty{a_n(x)}$ 对每一固定的 $x \in \D$ 关于 $n$ 是单调的, 且 $\Bqty{a_n(x)}$ 在 $\D$ 上一致有界:
   $$
   \vqty{a_n(x)} \le M, \quad x \in \D, n\in\N^+,
   $$
   同时, 函数项级数 $\nsum b_n(x)$ 在 $\D$ 上一致收敛.

2. (**Dirichlet 判别法**)	函数序列 $\Bqty{a_n(x)}$ 对每一固定的 $x\in\D$ 关于 $n$ 是单调的, 且 $\Bqty{a_n(x)}$ 在 $\D$ 上一致收敛于 $0$; 同时, 函数项级数 $\nsum b_n(x)$ 的部分和序列在 $\D$ 上一致有界:
   $$
   \vqty{\sum_{k=1}^n b_k(x)} \le M, \quad x \in \D, n \in \N^+.
   $$

---

<h4>一致收敛级数的性质</h4>

**定理 10.2.4 (连续性定理)**	设函数序列 $\Bqty{S_n(x)}$ 的每一项 $S_n(x)$ 在 $[a, b]$ 连续, 且一致收敛于 $S(x)$, 则 $S(x)$ 在 $[a, b]$ 上也连续.

- 即可以逐项求极限, $ \xlim \nlim S_n(x) = \nlim \xlim S_n(x) $.

**定理 10.2.4' (逐项求极限定理)**	设对每个 $n$, $u_n(x)$ 在 $[a, b]$ 上连续, 且 $\nsum u_n(x)$ 在 $[a, b]$ 上一致收敛于 $S(x)$, 则 $S(x)$ 在 $[a, b]$ 上连续. 这时, $ \forall x_0 \in [a, b] $,
$$
\xlim \nlim u_n(x) = \nsum \xlim u_n(x).
$$
**定理 10.2.5**	设函数序列 $\Bqty{S_n(x)}$ 的每一项 $S_n(x)$ 在 $[a ,b]$ 上连续, 且在 $[a, b]$ 上一致收敛于 $S(x)$, 则 $S(x)$ 在 $[a, b]$ 上可积, 且
$$
\int_a^b \nlim S_n(x) \dd{x} = \nlim \int_a^b S_n(x)\dd{x}.
$$
**定理 10.2.5' (逐项积分定理)**	设对每个 $n$, $u_n(x)$ 在 $[a, b]$ 上连续, 且 $\nsum u_n(x)$ 在 $[a, b]$ 上一致收敛于 $S(x)$, 则 $S(x)$ 在 $[a, b]$ 上可积, 且
$$
\int_a^b \nsum u_n(x) \dd{x} = \nsum \int_a^b u_n(x) \dd{x}.
$$
**定理 10.2.6**	设函数序列 $\Bqty{S_n(x)}$ 满足

1. $S_n(x)\; (n = 1, 2, \cdots)$ 在 $[a, b]$ 上有连续的导函数.
2. $\Bqty{S_n(x)}$ 在 $[a, b]$ 上点态收敛于 $S(x)$.
3. $\Bqty{S'_n(x)}$ 在 $[a, b]$ 上一致收敛于 $\sigma(x)$.

则 $S(x)$ 在 $[a, b]$ 上可导, 且 $\ddv{x} S(x) = \sigma(x)$. 即
$$
\dv{x} \nlim S_n(x) = \nlim \dv{x} S_n(x).
$$
**定理 10.2.6' (逐项求导定理)**	设函数项级数 $\nsum u_n(x)$ 满足

1. $u_n(x)\; (n = 1, 2, \cdots)$ 在 $[a, b]$ 上有连续的导函数.
2. $\nsum u_n(x)$ 在 $[a, b]$ 上点态收敛于 $S(x)$.
3. $\nsum u_n(x)$ 在 $[a, b]$ 上一致收敛于 $\sigma(x)$.

则 $S(x)$ 在 $[a, b]$ 上可导, 且
$$
\dv{x} \nsum u_n(x) = \nsum \dv{x} u_n(x).
$$
**定理 10.2.7 (Dini 定理)**	设函数序列 $\vqty{S_n(x)}$ 在闭区间 $[a, b]$ 上点态收敛于 $S(x)$, 如果

1. $S_n(x)\; (n = 1, 2, \cdots)$ 在 $[a, b]$ 上连续.
2. $S(x)$ 在 $[a, b]$ 上连续.
3. $\Bqty{S_n(x)}$ 关于 $n$ ==单调==.

则 $\bqty{S_n(x)}$ 在 $[a, b]$ 上一致收敛于 $S(x)$.

**定理 10.2.7'**	设函数项级数 $\nsum u_n(x)$ 在闭区间 $[a, b]$ 上点态收敛于 $S(x)$, 如果

1. $u_n(x)\; (n = 1, 2, \cdots)$ 在 $[a, b]$ 上连续.
2. $S(x)$ 在 $[a, b]$ 上连续.
3. 对任意固定的 $x \in [a, b]$, $\nsum u_n(x)$ 是正项级数或负向级数.

则 $\nsum u_n(x)$ 在 $[a, b]$ 上一致收敛于 $S(x)$.

**处处不可导的连续函数**	$ f(x) = \dsum_{n=0}^\infty \dfrac{\varphi(10^n x)}{10^n} $.

---

<h4>幂级数</h4>

对于幂级数 $\nosum a_n x^n$, 令 $ A = \ulim \sqrt[n]{\vqty{a_n}} $, 定义 **收敛半径**
$$
R = \begin{cases}
	+\infty, & A = 0, \\
	\dfrac{1}{A}, & A\in (0, +\infty), \\
	0, & A = + \infty.
\end{cases}
$$
**定理 10.3.1 (Cauchy-Hadamard 定理)**	幂级数 $\nosum a_nx^n$ 当 $\vqty{x}<R\; (R>0)$ 时绝对收敛; 当 $\vqty{x}>R$ 时发散.

**定理 10.3.2 (d' Alembert 判别法)**	如果对幂级数 $\nosum a_nx^n$ 成立
$$
\nlim \vqty{\dfrac{a_{n+1}}{a_n}} = A,
$$
则此幂级数的收敛半径为 $R = \dfrac{1}{A}$.

- 即不等式 $\dlim \dfrac{x_{n+1}}{x_n} \le \dlim \sqrt[n]{x_n} \le \ulim \sqrt[n]{x_n} \le \ulim \dfrac{x_{n+1}}{x_n}$ 的推论.

---

**Abel 第一定理**	设 $x_0=0$, 如果幂级数在点 $\xi$ 收敛, 则当 $\vqty{x} < \vqty{\xi}$ 时幂级数绝对收敛. 如果幂级数在点 $\eta$ 发散, 则当 $\vqty{x}>\vqty{\eta}$ 时幂级数发散.

**定理 10.3.3 (Abel 第二定理)**	设幂级数 $\nosum a_nx^n$ 的收敛半径为 $R$, 则

1. $\nosum a_n x^n$ 在 $(-R, R)$ 上内闭一致收敛.
2. 若 $\nosum a_nx^n$ 在 $x=R$ 收敛, 则它在任意闭区间 $[a, R] \subset (-R, R]$ 上一致收敛.

- 即幂级数在包含于收敛域中的任意闭区间上一致收敛.

**定理 10.3.4 (和函数的连续性)**	设 $\nosum a_nx^n$ 的收敛半径为 $R$, 则和函数在 $(-R, R)$ 上连续; 若 $\nosum a_nx^n$ 在 $x=R$ 收敛, 则和函数在 $x=R$ 左连续.

**定理 10.3.5 (逐项可积性)**	设 $a, b$ 是幂级数 $\nosum a_nx^n$ 收敛域中任意二点, 则
$$
\int_a^b \nosum a_n x^n \dd{x} = \nosum \int_a^b a_nx^n \dd{x},
$$
且逐项积分所得幂级数与原幂级数具有相同的收敛半径.

- 收敛半径相同, 但收敛域可能扩大.

**定理 10.3.6 (逐项可导性)**	设 $\nosum a_nx^n$ 的收敛半径为 $R$, 则它在 $(-R, R)$ 上可以逐项求导, 即
$$
\dv{x} \nosum a_nx^n = \nosum \dv{x} a_nx^n = \nsum na_nx^{n-1},
$$
且逐项求导所得幂级数的收敛半径也是 $R$.

- 收敛半径相同, 但收敛域可能缩小.

---

<h4>Taylor 级数与余项公式</h4>

**定理 10.4.1 (积分形式的余项公式)**	设 $f(x)$ 在 $O(x_0, r)$ 上任意阶可导, 则
$$
\begin{align}
f(x) &= \sum_{k=0}^n \dfrac{f^{(k)}(x_0)}{k!} (x-x_0)^k + r_n(x),
\quad x \in O(x_0, r)
\\
r_n(x) &= \dfrac{1}{n!} \int_{x_0}^x f^{(n+1)}(t) (x-t)^n \dd{t}
\quad \text{(积分形式的余项公式)}
\\
&= \dfrac{f^{(n+1)}(x_0 + \theta(x-x_0))}{(n+1)!} (x-x_0)^{n+1}
\quad \text{(Lagrang 余项)}
\\
&= \dfrac{f^{(n+1)}(x_0 + \theta(x-x_0))}{n!} (1-\theta)^n (x-x_0)^{n+1}
\quad \text{(Cauchy 余项)}
\end{align}
$$

---

**定理 10.5.1 (Weierstrass 第一逼近定理)**	设 $f(x)$ 在 $[0, 1]$ 上连续, 则它的 **Bernstein 多项式** 序列 $\Bqty{B_n(f, x)}$ 在 $[0, 1]$ 上一致收敛于 $f$.
$$
B_n(f, x) = \sum_{k=0}^n f\pqty{\dfrac{k}{n}} \mathrm{C}_n^k x^k (1-x)^{n-k}
$$
Bernstein 多项式的性质

1. 线性性: $ B_n(\alpha f + \beta g, x) = \alpha B_n(f, x) + \beta B_n(g, x) $.

2. 单调性: 若 $f(t) \ge g(t)$ 恒成立, 则 $ B_n(f, x) \ge B_n(g, x) $.

3. $ B_n(1, x) = 1 $.

   $ B_n(t, x) = \dfrac{1}{n^1} n^\underline{1} x^1 $.

   $ B_n(t^2, x) = \dfrac{1}{n^2} (n^\underline{2} x^2 + n^\underline{1} x^1) $.

   $ B_n(t^3, x) = \dfrac{1}{n^3}(n^\underline{3} x^3 + 3n^\underline{2} x^2 + n^\underline{1} x^1) $.

   $ B_n(t^4, x) = \dfrac{1}{n^4}(n^\underline{4} x^4 + 6n^\underline{3} x^3 + 7n^\underline{2} x^2 + n^\underline{1} x^1) $.

   $ B_n(t^5, x) = \dfrac{1}{n^5}(n^\underline{6} x^6 + 10n^\underline{4} x^4 + 25n^\underline{3} x^3 + 15n^\underline{2} x^2 + n^\underline{1} x^1) $.

   $ B_n(t^6, x) = \dfrac{1}{n^6}(n^\underline{7} x^7 + 15n^\underline{6} x^6 + 65n^\underline{4} x^4 + 90n^\underline{3} x^3 + 31n^\underline{2} x^2 + n^\underline{1} x^1) $.

   找到了比较方便的递推式, 希望没有算错.

- 可以用有理系数多项式逼近.



### 笔记

- $ f(x) = x^a(1-x)^b\; (0<x<1) $ 在 $x = \dfrac{a}{a+b}  $ 处取到最值 $ \dfrac{a^ab^b}{(a+b)^{a+b}} $.

- 若 $\nsum a_n$, $\nsum b_n$ 和它们的 Cauchy 乘积 $ \nsum c_n = \nsum (a_1b_n + a_2b_{n-1} + \cdots + a_nb_1) $ 都收敛, 则 $ \nsum c_n = \pqty{\nsum a_n}\pqty{\nsum b_n} $.

- 幂级数展开
  $$
  \begin{align}
  (1+x)^\alpha &= \nosum \binom{\alpha}{n} x^n, \quad
  \begin{cases}
  	x \in (-1, 1), & \alpha \le -1, \\
  	x \in \pbqty{-1, 1}, & -1 < \alpha < 0, \\
  	x \in [-1, 1], & \alpha>0.
  \end{cases}
  \\ \\
  \sin{x} &= \nosum \sin\dfrac{n\pi}{2} \cdot \dfrac{x^n}{n!}
  = \nosum (-1)^n \dfrac{x^{2n+1}}{(2n+1)!}, \quad x \in \R
  \\
  \cos{x} &= \nosum \cos\dfrac{n\pi}{2} \cdot \dfrac{x^n}{n!}
  = \nosum (-1)^n \dfrac{x^{2n}}{(2n)!}
  , \quad x \in \R
  \\
  \arcsin{x} &= x + \nsum \dfrac{(2n-1)!!}{(2n)!!} \dfrac{x^{2n+1}}{2n+1}, \quad x \in (-1, 1)
  \\
  \arccos{x} &= \dfrac{\pi}{2} - \arcsin{x}, \quad x \in (-1, 1)
  \\
  \sinh{x} &= \nosum \sin^2\dfrac{n\pi}{2} \cdot \dfrac{x^n}{n!}
  = \nosum \dfrac{x^{2n+1}}{(2n+1)!}, \quad x \in \R
  \\
  \cosh{x} &= \nosum \cos^2\dfrac{n\pi}{2} \cdot \dfrac{x^n}{n!}
  = 1 + \nsum \dfrac{x^{2n}}{(2n)!}, \quad x \in \R
  \end{align}
  $$

- 和函数
  $$
  \begin{align}
  & \nsum \pqty{1 + \dfrac{1}{2} + \cdots + \dfrac{1}{n}}x^n = \pqty{\nosum x^n}\pqty{\nsum\dfrac{x^n}{n}} = \dfrac{1}{1-x} \ln\dfrac{1}{1-x}
  \\
  & \nsum \dfrac{t^n}{n^2} = \int_0^t - \dfrac{\ln(1-u)}{u} \dd{u}
  \end{align}
  $$

- 巴塞尔问题
  $$
  \zeta(2n) = \dfrac{(2\pi)^{2n}(-1)^{n+1}B_{2n}}{2\cdot (2n)!}.
  $$

- 



### 例题

1. (不) 一致收敛的例子

   1. $ S_n(x) = x^n $ 在 $(0, +\infty)$ 不一致收敛于 $S(x)=0$.

   2. $S_n(x) = \pqty{1+\dfrac{x}{n}}^n$ 在 $[0, a]$ 一致收敛, 但在 $\bpqty{0, +\infty}$ 上不一致收敛.

   3. 若 $\nsum a_n$ 绝对收敛, 则 $\nsum a_n\cos nx$ 与 $\nsum a_n\sin nx$ 在 $(-\infty, +\infty)$ 上一致收敛.

   4. $\nsum x^\alpha \e^{-nx}$ 在 $\bpqty{0, +\infty}$ 上当且仅当 $\alpha>0$ 时一致收敛.

   5. 若 $\nsum a_n$ 收敛, 则 $\nsum a_nx^n$ 在 $[0, 1]$ 上一致收敛.

      如 $ \nsum \dfrac{(-1)^n}{n^p} x^n $.

   6. 设 $\Bqty{a_n}$ 单调收敛于 0, 则 $\nsum a_n\cos nx$ 与 $\nsum a_n\sin nx$ 在 $(0, 2\pi)$ 内闭一致收敛.

2. 设正项级数 $\nsum a_n$ 发散, $A_n = \dsum_{k=1}^n a_k$, 且 $\nlim \dfrac{a_n}{A_n} = 0$, 则幂级数 $\nsum a_nx^n$ 的收敛半径为 1. (考虑幂级数 $\nsum A_n x^n$ 并用 d' Alembert 判别法)

3. 设 $P_n(x) = 0, P_{n+1}(x) = P_n(x) + \dfrac{x^2 - P_n^2(x)}{2}\; (n = 0, 1, 2, \cdots)$, 则 $\Bqty{P_n(x)}$ 在 $[-1, 1]$ 上一致收敛于 $\vqty{x}$.



## 第 11 章	Euclid 空间上的极限和连续

<h4>Euclid 空间上的距离与极限</h4>

**向量空间**: 定义加法与数乘.

$\R^n$ 上的 **内积**: $ \aqty{\bm{x}, \bm{y}} = \dsum_{k=1}^n x_ky_k $.

1. (**正定性**)	$ \aqty{\bm{x}, \bm{y}} \ge 0 $, 而 $\aqty{\bm x, \bm x} = 0$ 当且仅当 $\bm x = \bm 0$.
2. (**对称性**)	$ \aqty{\bm{x}, \bm{y}} = \aqty{\bm{y}, \bm{x}} $.
3. (**线性性**)	$ \aqty{\lambda\bm x + \mu \bm y, \bm z} = \lambda \aqty{\bm x, \bm z} + \mu \aqty{\bm y, \bm z} $.
4. (**Schwarz 不等式**)	$ \aqty{\bm x, \bm y}^2 \le \aqty{\bm x, \bm x} \aqty{\bm y, \bm y} $.

**定义 11.1.1**	距离 $ \vqty{\bm x - \bm y} = \sqrt{(x_1-y_1)^2 + (x_2-y_2)^2 + \cdots + (x_n-y_n)^2} $. **Euclid 范数** $ \norm{\bm x} = \sqrt{\aqty{\bm x, \bm x}} $.

**定理 11.1.1**	距离满足一下性质:

1. (**正定性**)	$ \vqty{\bm x - \bm y} \ge 0 $, 当且仅当 $\bm x = \bm y$ 时取等.
2. (**对称性**)	$ \vqty{\bm x - \bm y} = \vqty{\bm y - \bm x} $.
3. (**三角不等式**)	$ \vqty{\bm x - \bm z} \le \vqty{\bm x - \bm y} + \vqty{\bm y - \bm z} $.

**领域**, **极限**, **收敛**, **发散**, **有界集**.

<h4>开集与闭集</h4>

以邻域 $O(\bm x, \delta)$ 判断: **内点**, **内部** $S^o$, **外点**, **边界点**, **边界** $\partial S$, **孤立点**, **聚点**.

**定理 11.1.2**	$ \clim{k} \bm{x}_k = \bm a \QRLA \clim{k} x_i^{(k)} = a_i\; (i = \oneto{n}) $.

**定理 11.1.3**	$\bm x$ 是点集 $ S \subset \R^n $ 的聚点的充要条件是: 存在点列 $\Bqty{\bm x_k}$ 满足 $ \bm x \in S,\, \bm x_k \ne \bm x $, 使得 $\clim{k} \bm x_k = \bm x$.

**定义 11.1.5**	设 $S$ 是 $\R^n$ 上的点集, 若 $S$ 中的每一个点都是它的内点, 则称 $S$ 为 **开集**; 若 $S$ 中包含了它的所有聚点, 则称 $S$ 为 **闭集**. $S$ 与它的聚点全体 $S'$ 的并集称为 $S$ 的 **闭包**, 记为 $\overline{S}$.

**定理 11.1.4**	$\R^n$ 上的点集 $S$ 为闭集的充要条件是 $S^c$ 是开集.

**引理 11.1.1 (De Morgan 公式)**	设 $\Bqty{S_\alpha}$ 是 $\R^n$ 中的一组 (有限或无限多个) 子集, 则

1. $ \d \pqty{\bigcup_\alpha S_\alpha}^c = \bigcap_\alpha S_\alpha^c $.
2. $ \d\pqty{\bigcap_\alpha S_\alpha}^c = \bigcup_\alpha S_\alpha^c $.

**定理 11.1.5**

1. 开集之并是开集.
2. 闭集之交是闭集.
3. 有限个开集之交是开集.
4. 有限个闭集之并是闭集.

- 开集与并集之差是开集, 并集与开集之差是并集.

**定理 11.1.6 (闭矩形套定理)**	设 $ \Delta_k = [a_k, b_k] \times [c_k, d_k]\; (k = 1, 2, \cdots) $ 是 $\R^2$ 上一列闭矩形, 如果

1. $ \Delta_{k+1} \subset \Delta_k $.
2. $ \sqrt{(b_k - a_k)^2 + (d_k - c_k)^2} \to 0\; (k \to \infty) $.

则存在唯一的点 $\bm a = (\xi, \eta) \in \d\bigcap_{k=1}^n \Delta_k$, 且
$$
\clim{k} a_k = \clim{k} b_k = \xi, \quad \clim{k} c_k = \clim{k} d_k = \eta.
$$
**定理 11.1.6' (Cantor 闭区域套定理)**	设 $\Bqty{S_k}$ 是 $\R^n$ 上的非空闭集序列, 满足
$$
S_1 \supset S_2 \supset \cdots \supset S_k \supset S_{k+1} \supset \cdots,
$$
以及 $ \clim{k} \diam S_k = 0 $, 则存在唯一点属于 $ \d\bigcap_{k=1}^\infty S_k $. 其中
$$
\diam S = \sup\Bqty{
	\vqty{\bm x - \bm y} \mid \bm x, \bm y \in S
},
$$
称为 $S$ 的直径.

**定理 11.1.7 (Bolzano—Weierstrass 定理)**	$\R^n$ 上的有界点列 $\Bqty{\bm x_k}$ 中必有收敛子列.

**推论 11.1.1**	$\R^n$ 上的有界无限点集至少有一个聚点.

**定义 11.1.6**	若 $\R^n$ 上的点列 $\Bqty{\bm x_k}$ 满足:
$$
\forall \ve>0, \exist K \in \N^+, \forall k, l > K: \vqty{\bm x_l - \bm x_k} < \ve,
$$
则称 $\Bqty{\bm x_k}$ 为 **基本点列** (或 **Cauchy 点列**).

**定理 11.1.8 (Cauchy 收敛原理)**	$\R^n$ 上的点列 $\Bqty{\bm x_k}$ 收敛的充要条件是: $\Bqty{\bm x_k}$ 为基本点列.

**定义 11.1.7**	设 $S$ 为 $\R^n$ 上的点集, 如果 $\R^n$ 中的一组开集 $\Bqty{U_\alpha}$ 满足 $ \d \bigcup_\alpha U_\alpha \supset S $, 那么称 $\Bqty{U_\alpha}$ 为 $S$ 的一个 **开覆盖**. 如果 $S$ 的任意一个开覆盖 $\Bqty{U_\alpha}$ 中总存在一个有限子覆盖, 即存在 $\Bqty{U_\alpha}$ 中的有限个开集 $ \Bqty{U_{\alpha_i}}_{i=1}^P $ 满足 $ \d \bigcup_{i=1}^P U_{\alpha_i} \supset S $, 则称 $S$ 为 **紧集**.

**定理 11.1.9 (Heine—Borel 定理)**	$\R^n$ 上的点集 $S$ 是紧集的充要条件为: 它是有界闭集.

- 紧集之交与紧集之并仍是紧集.

**定理 11.1.10**	设 $S$ 是 $\R^n$ 上的点集, 那么以下三个命题等价:

1. $S$ 是有界闭集.
2. $S$ 是紧集.
3. $S$ 的任一无限子集在 $S$ 中必有聚点.

- Euclid 空间上的基本定理：Cantor 闭区间套定理、Bolzano—Weierstrass 定理、Cauchy 收敛原理和 Heine—Borel 定理，它们是相互等价的.

---

**n 重极限**, **累次极限**

- 二次极限存在, 二重极限不一定存在.
- 二重极限存在, 二次极限可能都存在, 可能有一个不存在, 也可能==都不存在==.
- 两个极限运算不一定可以交换次序.

**定理 11.2.1**	若二元函数 $f(x, y)$ 在 $(x_0, y_0)$ 点存在二重极限 $ \lim\limits_{(x, y) \to (x_0, y_0)} f(x, y) = A $, 且当 $x \ne x_0$ 时存在极限 $ \lim\limits_{y\to y_0} f(x, y) = \varphi(x) $, 那么
$$
\xlim \lim_{y \to y_0} f(x, y) = \nlim \varphi(x) = \lim_{(x, y) \to (x_0, y_0)} f(x, y) = A.
$$

- 注意条件是二重极限存在.
- 若二重极限和两个二次极限都存在, 则极限运算可以交换次序.

**向量值函数** (**多元函数组**)

**定理 11.2.3**	如果 $g$ 在 $D$ 上连续, $f$ 在 $\Omega$ 上连续, 那么复合映射 $f \circ g$ 在 $D$ 上连续.

- $f+g$ 与 $\aqty{f, g}$ 也是连续的. 注意到
  $$
  \vqty{\aqty{f(x), g(x)} - \aqty{f(x_0), g(x_0)}} = \vqty{\aqty{f(x) - f(x_0), g(x)} + \aqty{f(x_0), g(x) - g(x_0)}}.
  $$

---

**连续**, **一致连续**.

**定理 11.3.1**	连续映射将紧集映射称紧集.

**定理 11.3.2 (有界性定理)**	设 $K$ 是 $\R^n$ 中的紧集, $f$ 是 $K$ 上的连续函数, 则 $f$ 在 $K$ 上有界.

**定理 11.3.3 (最值定理)**

**定理 11.3.4 (一致连续性定理)**	设 $K$ 是 $\R^n$ 中的紧集, $f: K \to \R^m$ 为连续映射, 则 $f$ 在 $K$ 上一致连续.

---

**定义 11.3.3**	设 $S$ 是 $\R^n$ 中的点集, 若连续映射 $\gamma: [0, 1] \to \R^n$ 的值域全部落在 $S$ 中, 即 $ \gamma([0, 1]) \subset S $, 则称 $\gamma$ 为 $S$ 中的 **道路**, $\gamma(0)$ 与 $\gamma(1)$ 分别称为道路的 **起点** 与 **终点**.

若 $S$ 中任意两点之间都存在道路, 则称 $S$ 是 **(道路) 连通** 的, 且称为 **连通集**.

连通的开集称为 **(开) 区域**, 其闭包称为 **闭区域**.

**定理 11.3.5**	连续映射将连通集映射成连通集.

**推论 11.3.1**	连续函数将连通的紧集映射成闭区间.

**定理 11.3.6 (中间值定理)**




### 笔记

- 内部 $S^o$, 边界 $\partial S$, 聚点集 $S'$, 闭包 $\overline{S}$.

- 开集的所有点都是聚点.

- 所有内点组成的点集是开集.

- 闭包是闭集.

- 由 $ \dsum_{i=1}^n (a_i - tb_i)^2 \ge 0 $ 可推出:
  $$
  \sqrt{\sum_{i=1}^n (a_i+b_i)^2} \le \sqrt{\sum_{i=1}^n a_i^2} + \sqrt{\sum_{i=n}^n b_i^2}.
  $$

- 设 $f:\R^n \to \R^m$ 为连续映射, 则对于 $\R^n$ 中的任意子集 $A$ 成立
  $$
  f(\overline{A}) \subset \overline{f(A)}.
  $$

- 设 $f$ 是有界开区域 $D \subset \R^2$ 上的一致连续函数, 则可将 $f$ 连续延拓到 $D$ 的边界上, 且 $f$ 在 $D$ 上有界.



### 例题

1. 设二元函数 $f(x, y)$ 在开集 $D \subset \R^2$ 内对于变量 $x$ 是连续的, 对于变量 $y$ 满足 **Lipschitz 条件**:
   $$
   \vqty{f(x, y') - f(x, y'')} \le L \vqty{y' - y''},
   $$
   其中 $L$ 为 Lipschitz 常数, 则 $f(x, y)$ 在 $D$ 上连续.



## 第 12 章	多元函数的微分学

### 定理

**定理 12.1.1**	设 $D \subset \R^2$ 为开集, $(x_0, y_0) \in D$ 为一顶点. 如果函数 $z = f(x, y), (x, y) \in D$ 在 $(x_0, y_0)$ 可微, 那么对于任一方向 $ \bm v = (\cos\alpha, \sin\alpha) $, $f$ 在 $(x_0, y_0)$ 点沿方向 $\bm v$ 的方向导数存在, 且
$$
\pdv{f}{\bm v} (x_0, y_0) = \pdv{f}{x} (x_0, y_0) \cos\alpha + \pdv{f}{y} (x_0, y_0)\sin\alpha.
$$
**定理 12.1.2**	设函数 $z = f(x, y)$ 在 $(x_0, y_0)$ 点的某个邻域上存在偏导数, 并且偏导数在该点连续, 那么 $f$ 在该点可微.

---

方向导数的梯度表述
$$
\pdv{f}{\bm v} (x_0, y_0) = \grad f \cdot \bm v = \norm{\grad f(x_0, y_0)} \cdot \cos(\grad f, \bm v).
$$
**梯度的性质**

1. $ \grad c = 0 $.
2. $ \grad (\alpha f + \beta g) = \alpha\grad f + \beta \grad g $.
3. $ \grad (f\cdot g) = f \cdot \grad g + g \cdot \grad f $.
4. $ \grad \pqty{\dfrac{f}{g}} = \dfrac{g\cdot\grad f - f \cdot \grad g}{g^2} $.

**定理 12.1.3**	如果函数 $z = f(x, y)$ 的两个混合偏导数 $f_{xy}$ 和 $f_{yx}$ 在点 $(x_0, y_0)$ 连续, 那么 $ f_{xy}(x_0, y_0) = f_{yx}(x_0, y_0) $.

---

向量值函数 $\bm f$ 在 $\bm x^0$ 点的 **Jacobi 矩阵**: $\bm f'(\bm x^0) \equiv \mathrm{D} \bm f(\bm x^0) \equiv \bm J_\bm f(\bm x^0) = \pqty{\dpdv{f_i}{x_j}(\bm x^0)}_{m\cp n}$.

$ \dd{\bm x} = (\soneto{\dd{x}}{n})\trans $.

**定理12.1.4**	向量值函数 $\bm f$ 在 $\bm x^0$ 点可微的充要条件是它的坐标分量函数 $ f_i(\soneto{x}{n})\; (i = \oneto{m}) $ 都在 $\bm x^0$ 点可微. 此时成立微分公式
$$
\dd{\bm y} = \bm f'(\bm x^0) \dd{\bm x}.
$$

- 向量值函数连续、可导和可微，等价于它的每一个坐标分量函数连续、可导、可微.

---

**定理 12.2.1&2&3 (链式法则)**	设 $\bm{g}$ 在 $\bm x^0 \subset D_g$ 点可导, $f$ 在 $ \bm y^0 = \bm g(\bm x^0) $ 点可微, 则复合函数及其偏导数为
$$
\begin{align}
z &= f \circ \bm g = f[
	y_1(\soneto{x}{n}), y_2(\soneto{x}{n}), \cdots, y_m(\soneto{n})
]
\\ \\
\bm J_z(\bm x^0) &= \pqty{
	\pdv{z}{x_1}, \pdv{z}{x_2}, \cdots, \pdv{z}{x_n}
}_{\bm x = \bm x^0}
\\
&= \pqty{
	\pdv{z}{y_1}, \pdv{z}{y_2}, \cdots, \pdv{z}{y_m}
}_{\bm y = \bm y_0}
\begin{pmatrix}
	\dpdv{y_1}{x_1} & \dpdv{y_1}{x_2} & \cdots & \dpdv{y_1}{x_n} \\
	\dpdv{y_2}{x_1} & \dpdv{y_2}{x_2} & \cdots & \dpdv{y_2}{x_n} \\
	\vdots & \vdots && \vdots \\
	\dpdv{y_m}{x_1} & \dpdv{y_m}{x_2} & \cdots & \dpdv{y_m}{x_n} \\
\end{pmatrix}
\end{align}
$$

更一般地：
$$
(\bm f \circ \bm g)'(\bm x) = \bm f'(\bm g(\bm x)) \cdot \bm g'(\bm x).
$$

---

一阶全微分的形式不变性.

**凸区域**	$ \forall \bm x_0, \bm x_1 \in D, \forall \lambda \in [0, 1]: \bm x_0 + \lambda(\bm x_1 - \bm x_0) \in D $.

**定理 12.3.1 (中值定理)** :star:	若二元函数在凸区域可微, 则
$$
\exist \theta \in (0, 1): f(x_0 + \Delta x, y_0 + \Delta y) - f(x_0, y_0) = f_x(x_0+\theta\Delta x, y_0 + \theta\Delta y) \Delta x + f_y(x_0+\theta\Delta x, y_0 + \theta\Delta y) \Delta y.
$$
**推论 12.3.1**	如果二元函数在某区域 (无需凸区域) 的偏导恒为零, 则在此区域为常值函数.

**定理 12.3.2 (n 元函数的中值定理)**

**定理 12.3.3 (Taylor 公式)** :star:	设函数 $f(x, y)$ 在点 $(x_0, y_0)$ 的邻域 $ U = O((x_0, y_0), r) $ 上具有 $k+1$ 阶连续偏导, 则对于 $U$ 内每一点 $ (x_0 + \Delta x, y_0 + \Delta y) $ 都成立
$$
\begin{align}
	f(x_0 + \Delta x, y_0 + \Delta y) &= f(x_0, y_0) + \pqty{
		\Delta x \pdv{x} + \Delta y \pdv{y}
	} f(x_0, y_0) +
	\\
	&\eqs \dfrac{1}{2!} \pqty{
		\Delta x \pdv{x} + \Delta y \pdv{y}
	}^2 f(x_0, y_0) + \cdots +
	\\
	&\eqs \dfrac{1}{k!} \pqty{
		\Delta x \pdv{x} + \Delta y \pdv{y}
	}^k f(x_0, y_0) + R_k,
\end{align}
$$
其中 $ R_k = \dfrac{1}{(k+1)!} \pqty{
		\Delta x \dpdv{x} + \Delta y \dpdv{y}
	}^p f(x_0 + \theta\Delta x, y_0 + \theta\Delta y) $$ \quad (0<\theta<1) $ 称为 **Lagrange 余项**.

注: 构造辅助函数 $ \varphi(t) = f(x_0 + t\Delta x, y_0 + t \Delta y) $, 通过一元函数的泰勒公式推导.

**推论 12.3.2**	带 **Peano 余项**的 Taylor 公式, 即余项为 $ o\pqty{\pqty{\sqrt{\Delta x^2 + \Delta y^2}}^k} $.

---

**中心差商** :star:
$$
\begin{align}
\pdv{f}{x} (x, y) &\approx \dfrac{
	f\pqty{x + \dfrac{h}{2}, y} - f\pqty{x - \dfrac{h}{2}, y}
}{h}
\\ \\
\pdv[2]{f}{x}\ (x, y) &\approx \dfrac{1}{h} \bqty{
	\pdv{f}{x} \pqty{x + \dfrac{h}{2}, y} -
	\pdv{f}{x} \pqty{x - \dfrac{h}{2}, y}
}
\\
&\approx \dfrac{
	f(x+h, y) - 2f(x, y) + f(x-h, y)
}{h^2}
\end{align}
$$
**五点差分公式** :star:
$$
\begin{align}
&\eqs \pqty{
	\pdv[2]{x} + \pdv[2]{y}
} f(x, y)
\approx \Delta_h f(x, y)
\\
&\equiv \dfrac{
	f(x+h, y) + f(x, y+h) + f(x-h, y) + f(x, y-h) - 4f(x, y)
}{h^2}.
\end{align}
$$
其截断误差为 $ O(h^2) $.

**定理 12.3.4**	$n$ 元函数的 Taylor 公式.

---

**定理 12.4.1 (一元隐函数存在定理)**	若二元函数 $F(x, y)$ 满足条件:

1. $ F(x_0, y_0) = 0 $.
2. 在闭矩形 $ D = \Bqty{(x, y) \mid \vqty{x-x_0} \le a, \vqty{y-y_0} \le b} $ 上, $F(x, y)$ 连续, 且具有连续偏导.
3. $ F_y(x_0, y_0) \ne 0 $.

那么

1. 在点 $(x_0, y_0)$ 附近可从函数方程 $F(x, y)=0$ 中唯一确定隐函数 $y=f(x)$, 它满足 $ F(x, f(x)) = 0,\, y_0 = f(x_0) $.
2. 隐函数 $y=f(x)$ 在 $ x \in O(x_0, \rho) $ 上连续.
3. 隐函数 $y=f(x)$ 在 $ x \in O(x_0, \rho) $ 上具有连续的导数, 且

$$
\dv{y}{x} = - \dfrac{F_x(x, y)}{F_y(x, y)}.
$$

---

**定理 12.4.2 (多元隐函数存在定理)**

**定理 12.4.3 (多元向量值隐函数存在定理)**
$$
\begin{cases}
	F(x, y, u, v) = 0, \\
	G(x, y, u, v) = 0.
\end{cases}
\QRA
\dbinom{u}{v} = \dbinom{f(x, y)}{g(x, y)}
$$

$$
\begin{pmatrix}
	\dpdv{u}{x} & \dpdv{u}{y} \\
	\dpdv{v}{x} & \dpdv{v}{y} \\
\end{pmatrix}
= - \begin{pmatrix}
	F_u & F_v \\
	G_u & G_v \\
\end{pmatrix}\inv
\begin{pmatrix}
	F_x & F_y \\
	G_x & G_y \\
\end{pmatrix}
$$

**定理 12.4.4**	$m$ 个 $n+m$ 元函数确定的 $n$ 个隐函数的偏导公式.

---

**Jacobi 行列式**	$ \dpdv{(x, y)}{(u, v)} $.

**定理 12.4.5 (逆映射定理)**

**推论** :star:	一元函数反函数求导公式的推广.
$$
\pdv{(x, y)}{(u, v)} \cdot \pdv{(u, v)}{(x, y)} = 1.
$$
**定理 12.4.6** :star:	设 $D$ 为 $\R^2$ 中的开集, 且映射 $ \bm f: D \to \R^2 $ 在 $D$ 上具有连续导数. 如果 $\bm f$ 的 Jacobi 行列式在 $D$ 上恒不为零, 那么 $D$ 的像集 $\bm f(D)$ 是开集.

---

空间曲线的参数方程, 光滑曲线, 切向量, 法平面, 张成的平面

**定理 12.5.1**	曲线 $ \begin{cases} F(x, y, z) = 0, \\ G(x, y, z) = 0. \end{cases} $ 在 $P_0$ 点的法平面就是 $ \grad F(P_0) $ 和 $ \grad G(P_0) $ 张成的过 $P_0$ 的平面.

---

<h4>无条件极值</h4>

**定理 12.6.1 (必要条件)**	设 $\bm x_0$ 为函数 $f$ 的极值点, 且 $f$ 在 $\bm x_0$ 点可偏导, 则 $f$ 在 $\bm x_0$ 点的各个一阶偏导数都为零, 即
$$
f_{x_1}(\bm x_0) = f_{x_2}(\bm x_0) = \cdots f_{x_n}(\bm x_0) = 0.
$$
**定理 12.6.2 (极值点判别法)**	设 $(x_0, y_0)$ 为 $f$ 的驻点, $f$ 在 $(x_0, y_0)$ 附近具有二阶连续偏导数, 记
$$
A = f_{xx}(x_0, y_0),\, B = f_{xy}(x_0, y_0),\, C = f_{yy}(x_0, y_0),
\\
H = \begin{vmatrix}
	A & B \\
	B & C \\
\end{vmatrix}
= AC - B^2.
$$

1. 当 $H>0$ 时, $A>0$ 则取到极小值, $A<0$ 则取到极大值.
2. 当 $H<0$ 时, 非极值.

**定理 12.6.3 (多元函数极值点判别法)**	当二次型
$$
g(\zeta) = \sum_{i, j = 1}^n f_{x_ix_j} (\bm x_0) \zeta_i \zeta_j
$$

1. 正定时, $f(\bm x_0)$ 为极小值;
2. 负定时, $f(\bm x_0)$ 为极大值;
3. 不定时, $f(\bm x_0)$ 不是极值.

**推论 12.6.1**	记 $a_{ij} = f_{x_ix_j}(\bm x_0)$, 定义 $f$ 的 $k$ 阶 **Hessian 矩阵**
$$
A_k = \begin{pmatrix}
	a_{11} & a_{12} & \cdots & a_{1n} \\
	a_{21} & a_{22} & \cdots & a_{2n} \\
	\vdots & \vdots && \vdots \\
	a_{k1} & a_{k2} & \cdots & a_{kk} \\
\end{pmatrix}
$$

1. 若 $ \det \bm A_k > 0\; (k = \oneto{n}) $, 则二次型 $g(\xi)$ 是正定的, 此时为极小值;
2. 若 $ (-1)^k \det \bm A_k > 0\; (k = \oneton) $, 则二次型 $g(\xi)$ 是负定的, 此时为极大值.

---

最小二乘法, 拟合曲线 (经验公式), "牧童" 经济模型.

条件极值, 目标函数, 约束条件, Lagrange 函数与乘数, Lagrange 乘数法

**定理 12.7.1 (条件极值的必要条件)**	若点 $ \bm x_0 = (\soneto{x^0}{n}) $ 为函数 $f(\bm x)$ 满足约束条件的条件极值点, 则必存在 $m$ 个常数 $ \soneto{\lambda}{m} $, 使得在 $\bm x_0$ 点成立
$$
\grad f = \lambda_1 \grad g_1 + \lambda_2 \grad g_2 + \cdots + \lambda_m \grad g_m.
$$
构造 Lagrange 函数
$$
L(\soneto{x}{n}, \soneto{\lambda}{m}) = f(\soneto{x}{n}) - \sum_{i=1}^m \lambda_i g_i(\soneto{x}{n}).
$$
则条件极值点就在
$$
\begin{cases}
\d \pdv{L}{x_k} = \pdv{f}{x_k} - \sum_{i=1}^m \lambda_i \pdv{g_i}{x_k} = 0, \\
g_l = 0.
\end{cases}
$$
的所有解对应的点中.

**定理 12.7.2**	当且仅当下述方阵为正定 (负定) 矩阵时, $\bm x_0$ 为满足约束条件的条件极小 (大) 值点.
$$
\pqty{
	\pdv{L}{x_k}{x_l}\ (\bm x_0, \soneto{\lambda}{m})
}_{m \cp m}.
$$

---



### 笔记

<h4>注意事项</h4>

- 求导过程中可以不展开某些变量, 但要注意变量与其它变量==是否有关系==.

<h4>基本概念的相互关系</h4>

- 可微
  - 连续, 且可偏导.
  - 方向偶数存在.
  - 链式法则成立.
- 偏导连续
  - 可微.
- 混合偏导连续
  - 混合偏导相等.

---

<h4>计算思路</h4>

- **求曲线的切线与法平面**
  - 参数方程 $ (x, y, z) = (x(t), y(t), z(t)) $.
    - $ \vb*{s} = (x'(t), y'(t), z'(t)) $.
  - 平面交线 $ F(x, y, z) = G(x, y, z) = 0 $.
    - 利用 $ \vb*{s} \perp \grad F,\, \vb*{s} \perp \grad G $.
    - $ \vb*{s} = \pqty{\d\pdv{(F, G)}{(y, z)}, \pdv{(F, G)}{(z, x)}, \pdv{(F, G)}{(x, y)}} $. :star:
- **求曲面的法线与切平面**
  - 一般方程 $ F(x, y, z) = 0 $.
    - $ \vb*{s} = (F_x, F_y, F_z) $.
  - 参数方程 $ \begin{cases} x = x(u, v), \\ y = y(u, v), \\ z = z(u, v). \end{cases} $
    - 利用 $ z = z(u(x, y), v(x, y)) $.
    - $ \vb*{s} = \pqty{\d\pdv{(y, z)}{(u, v)}, \pdv{(z, x)}{(u, v)}, \pdv{(x, y)}{(u, v)}} $. :star:

<h4>特殊曲面</h4>

- **证明曲面为柱面**
  - 证明思路
    - 在任意一点的切平面平行于一条特定直线.
    - 在任意一点的法向量垂直于一个定向量. :star:
  - 例子
    - $ f(a_1x+b_1y+c_1z, a_2x+b_2y+c_2z) = 0 $.
    - 特别的, $ f(ax+by+cz) = 0 $ 退化为平面, 且与 $(a, b, c)$ 垂直.
- **曲面过顶点**
  - 若 $F$ 为 $k$ 次齐次方程, 即 $ F(tx, ty, tz) = t^k F(x, y, z) $, 则 $ F(x, y, z) = 0 $ 过原点.
  - 推论: $ G\pqty{\dfrac{y}{x}, \dfrac{z}{x}} = 0 $ 或 $ G^*\pqty{\dfrac{y}{x}, \dfrac{z}{y}, \dfrac{x}{z}} $ 过原点.

<h4>一些结论</h4>

- **相交椭圆面积**
  $$
  \begin{cases}
  	Ax + By + Cz = 0, \\
  	\dfrac{x^2}{a^2} + \dfrac{y^2}{b^2} + \dfrac{z^2}{c^2} = 1.
  \end{cases}
  \QRA S = \pi abc \sqrt{\dfrac{
  	A^2 + B^2 + C^2
  }{
  	A^2 a^2 + B^2 b^2 + C^2 c^2
  }}.
  $$

- **求极值**

  - 设 $ a>0,\, a_i>0\; (i = \oneton) $, 则 $ f(\soneto{x}{n}) = x_1^{a_1} x_2^{a_2} \cdots x_n^{a_n} $ 在约束条件 $ \splus{x}{n} = a $ 下的最大值为
    $$
    \prod_{i=1}^n \pqty{
    	\dfrac{aa_i}{\splus{a}{n}}
    }^{a_i}
    = \dfrac{
    	a_1^{a_1} a_2^{a_2} \cdots a_n^{a_n}
    }{
    	\pqty{
    		\frac{\splus{a}{n}}{a}
    	}^{\splus{a}{n}}
    }
    $$

---

 $k$ 次齐次方程 $ f(\soneto{ax}{s}) = a^n f(\soneto{x}{n}) $ 的欧拉公式为
$$
\sum_{\alpha}^s \pdv{f}{x_\alpha} \cdot x_\alpha = nf.
$$
且其逆命题成立.

推论: 每一项的偏导数都是 $n-1$ 次齐次函数, 即
$$
\sum_{\beta=1}^s \pdv{x_\beta} \pdv{f}{x_\alpha} \cdot x_\beta = (n-1) \pdv{f}{x_\alpha}.
$$

---

**Hadamard 公式**	设 $n$ 元函数 $f$ 具有连续偏导数, 则有
$$
f(\bm y) - f(\bm x) = \sum_{i=1}^n \int_0^1 (y_i - x_i) \pdv{f}{x_i} (\bm x + t(\bm y - \bm x)) \dd{t}.
$$
注: 利用 $ F(t) \equiv f(\bm x + t(\bm y - \bm x)),\, F(1) - F(0) = \int_0^1 F'(t)\dd{t} $.

---

变换变量
$$
\pdv[2]{f}{x} + \pdv[2]{f}{y} = \pdv[2]{f}{r} + \dfrac{1}{r^2} \pdv[2]{f}{\theta} + \dfrac{1}{r} \pdv{f}{r}.
$$

$$
A\pdv[2]{f}{x} + 2B\pdv{f}{x}{y} + C\pdv[2]{f}{y} = 0 \QRLA \pdv{f}{u}{v} = 0,
\quad \begin{cases}
	u = x + \lambda y, \\
	v = x + \mu y.
\end{cases}
$$

---



### 例题

1. $ \dd{^k f(ax+by+cz)} = f^{(k)}(ax+by+cz)(a\dd{x} + b\dd{y} + c\dd{z})^k $.

2. 设 $y = f(x, t)$, 其中 $t$ 是由 $F(x, y, t)=0$ 所确定的隐函数, 且 $f$ 和 $F$ 都具有连续偏导数, 则
   $$
   \dv{y}{x} = \dfrac{
   	\d \pdv{f}{x} \pdv{F}{t} - \pdv{f}{t} \pdv{F}{x}
   }{
   	\d \pdv{f}{t} \pdv{F}{y} + \pdv{F}{t}
   }.
   $$


