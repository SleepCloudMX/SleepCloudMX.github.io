<h1 align="center">数学分析笔记 (3)</h1>

$$
% 字符
\newcommand{\e}{\textup{e}}
\newcommand{\i}{\textup{i}}
\newcommand{\ve}{\varepsilon}
\newcommand{\inv}{^{-1}}
\newcommand{\trans}{^\mathrm{T}}
\newcommand{\D}{\mathbb{D}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\F}{\mathbb{F}}

\newcommand{\eqs}{\quad\;}



% 特定内容
\newcommand{\oneton}{1,2,\cdots,n}
\newcommand{\oneto}[1]{1,2,\cdots,#1}

\newcommand{\ssto}[3]{#1_1 #3 #1_2 #3 \cdots #3 #1_{#2}}
\newcommand{\ssup}[3]{#1^1 #3 #1^2 #3 \cdots #3 #1^{#2}}
\newcommand{\soneto}[2]{\ssto{#1}{#2}{,}}
\newcommand{\splus}[2]{\ssto{#1}{#2}{+}}

\newcommand{\aqty}[1]{\expval{#1}}
\newcommand{\pbqty}[1]{\left(#1\right]}
\newcommand{\bpqty}[1]{\left[#1\right)}

\newcommand{\ccdots}{\cdot\cdots\cdot}

% 下面几个只是为了方便一点点而已
\newcommand{\dx}{\dd{x}}
\newcommand{\dy}{\dd{y}}
\newcommand{\dz}{\dd{z}}
\newcommand{\dt}{\dd{t}}
\newcommand{\ds}{\dd{s}}
\newcommand{\dr}{\dd{r}}

% 如果只使用 \dd{x}\dd{y} 的话, 中间会有多余的间隔.
\newcommand{\df}{\dd}
\newcommand{\ddf}[2]{\,\mathrm{d}#1\mathrm{d}#2}	% 微分形式
\newcommand{\dddf}[3]{\,\mathrm{d}#1\mathrm{d}#2\mathrm{d}#3}

\newcommand{\dxdy}{\ddf{x}{y}}
\newcommand{\dydz}{\ddf{y}{z}}
\newcommand{\dzdx}{\ddf{z}{x}}
\newcommand{\dudv}{\ddf{u}{v}}
\newcommand{\drdt}{\ddf{r}{\theta}}
\newcommand{\dxdydz}{\dddf{x}{y}{z}}



% 函数名
\DeclareMathOperator{\diam}{diam}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\span}{span}



% 运算符
\newcommand{\dint}{\displaystyle\int}
\newcommand{\inti}{\dint_{-\infty}^{+\infty}}
\newcommand{\intoi}{\dint_0^{+\infty}}

\newcommand{\intl}{\displaystyle\int\limits}
\newcommand{\iintl}{\displaystyle\iint\limits}
\newcommand{\iiintl}{\displaystyle\iiint\limits}

\newcommand{\dsum}{\displaystyle\sum}
\newcommand{\nsum}{\dsum_{n=1}^\infty}
\newcommand{\nosum}{\dsum_{n=0}^\infty}
\newcommand{\insum}{\dsum_{i=1}^n}
\newcommand{\knsum}{\dsum_{k=1}^n}

\newcommand{\dprod}{\displaystyle\prod}
\newcommand{\nprod}{\displaystyle\prod_{n=1}^\infty}
\newcommand{\noprod}{\dprod_{n=0}^\infty}
\newcommand{\inprod}{\dprod_{i=1}^n}

\newcommand{\liml}{\lim\limits}
\newcommand{\xlim}{\lim\limits_{x\to x_0}}
\newcommand{\nlim}{\lim\limits_{n\to\infty}}
\newcommand{\clim}[1]{\lim\limits_{#1\to\infty}}
\newcommand{\ulim}{\overline\lim\limits_{n\to\infty}}
\newcommand{\dlim}{\underline\lim\limits_{n\to\infty}}



% 缩写
\newcommand{\bm}[1]{\boldsymbol{#1}}
\newcommand{\d}{\displaystyle}

\newcommand{\RLA}{\Leftrightarrow}
\newcommand{\LA}{\Leftarrow}
\newcommand{\RA}{\Rightarrow}

\newcommand{\QRLA}{\quad\RLA\quad}
\newcommand{\QRA}{\quad\RA\quad}
\newcommand{\QLA}{\quad\LA\quad}

\newcommand\ddv{\displaystyle\dv}
\newcommand\dpdv{\displaystyle\pdv}
$$

## 第 13 章	重积分

### 定理

划分, 零边界区域

**定理 13.1.1**	有界点集 $D$ 是可求面积的充要条件是它的边界 $\partial D$ 的面积为 $0$. 即零边界区域是可求面积的.

- Dirichlet 函数形成的平面点集 $ S = \Bqty{(x, y) \mid 0 \le x \le 1,\, 0 \le y \le D(x)} $ 的边界为 $ \partial S = [0, 1] \times [0, 1] $, 面积为 $1$, 故 $S$ 是不可求面积的.

**性质 1**	若在已有的划分上添加有限条曲线进一步划分, 则 Darboux 大和不增, Darboux 小和不减.

**性质 2**	任何一个 Darboux 小和都不大于任何一个 Darboux 大和. 因此, 若记
$$
\begin{align}
& M_i = \sup f(x, y),\quad m_i = \inf f(x, y),\quad (x, y) \in \Delta D_i.
\\
& S = \sum_{i=1}^n M_i \Delta \sigma_i,\quad s = \sum_{i=1}^n m_i \Delta \sigma_i
\\
& I^* = \inf\Bqty{S},\quad I_* = \sup\Bqty{s}
\end{align}
$$
则有
$$
s \le I_* \le I^* \le S
$$
**性质 3**	$f(x, y)$ 在 $D$ 上可积的充要条件是
$$
\lim_{\lambda \to 0} (S-s) = \lim_{\lambda \to 0} \sum_{i=1}^n \omega_i \Delta \sigma_i = 0.
$$
其中 $ \omega_i = M_i - m_i $ 是 $f(x, y)$ 在 $\Delta D_i$ 上的 **振幅**. 此时成立
$$
\lim_{\lambda \to 0} s = \lim_{\lambda \to 0} S = \iint\limits_D f(x, y) \dd{\sigma}.
$$
**定理 13.1.2**	若 $f(x, y)$ 在零边界区域 $D$ 上连续, 那么它在 $D$ 上可积.

- 条件可放宽至==有界==, 但至多在==有限条==面积为零的曲线上不连续.

---

质心坐标.

**Peano 曲线**.

---

**性质 1 (线性性)**	$ \dint_\Omega (\alpha f + \beta g) \dd{V} = \alpha \int_\Omega f\dd{V} + \beta \int_\Omega g\dd{V} $.

**性质 2 (区域可加性)**	$ \dint_\Omega f\dd{V} = \int_{\Omega_1} f\dd{V} + \int_{\Omega_2} f\dd{V} $.

**性质 3**	$ \dint_{\Omega} \dd{V} = \Omega $ 的体积.

**性质 4 (保序性)**	$ f \le g \RA \dint_\Omega f\dd{V} \le \int_\Omega g\dd{V} $.

**性质 5**	$ mV \le \dint_\Omega f\dd{V} \le MV $.

**性质 6 (绝对可积性)**	$ \vqty{\dint_\Omega f\dd{V}} \le \dint_\Omega \vqty{f} \dd{V} $.

**性质 7 (乘积可积性)**

**性质 8 (积分中值定理)**	$ \dint_\Omega f \cdot g\dd{V} = f(\xi) \dint_\Omega g\dd{V} $.

---

**定理 13.2.1**	设二元函数 $f(x, y)$ 在闭矩形 $ D = [a, b] \times [c, d] $ 上可积. 若积分
$$
h(x) = \int_c^d f(x, y) \dd{y}
$$
对于每个 $ x \in [a, b] $ 存在, 则 $h(x)$ 在 $[a, b]$ 上可积, 并有等式
$$
\iint_D f(x, y) \dxdy = \int_a^b h(x) \dx = \int_a^b \pqty{
	\int_c^d f(x, y) \dy
} \dx = \int_a^b \dx \int_c^d f(x, y) \dy.
$$
**定理 13.2.2**	多重积分的上述公式.

**n 维单纯形** :star:	$ T_n =  \Bqty{(\soneto{x}{n}) \mid \soneto{x}{n} \ge 0,\, \splus{x}{n} \le h} $.

- $ V_n(a) = \dfrac{a^n}{n!} $.

---

<h4>重积分的变量代换</h4>

**定理 13.3.1 (二重积分变量代换公式)**

**定义 13.3.1**	形如
$$
\begin{align}
&T_x: x = x(u, v) = u,\, y = (u, v),
\\
&T_y: x = x(u, v),\, y = y(u, v) = v.
\end{align}
$$
的映射称为 **本原映射**.

**引理 13.3.1**	设 $T$ 为本原映射, 则对于每个属于 $B_n$ 的小矩形 $R$, 等式
$$
mT(R) = \vqty{
	\dpdv{(x, y)}{(u, v)}
}_{(\tilde{u}, \tilde{v})} mR.
$$
成立, 其中 $(\tilde{u}, \tilde{v})$ 为 $R$ 上某一点, $mT(R)$ 为其面积.

**引理 13.3.2**
$$
\iint\limits_{T(D)} f(x, y) \dxdy = \iint\limits_D f(x(u, v), y(u, v)) \vqty{
	\dpdv{(x, y)}{(u, v)}
} \ddd{u}{v}.
$$
**引理 13.3.3**	若 $T$ 满足定理 13.3.1 的假设, 则对于 $ \forall Q_0 = (u_0, v_0) \in U $, $T$ 在 $Q_0$ 附近可以表成两个具有连续导数的、一对一的本原映射的复合.

**定理 13.3.2 (n 重积分的变量代换)**

---

<h4>反常重积分</h4>

记 $ d(\Gamma) = \inf\Bqty{\sqrt{x^2+y^2} \mid (x,y) \in \Gamma} $ 为 $\Gamma$ 到原点的距离.

**引理 13.4.1**	设 $f(x, y)$ 为无界区域 $D$ 上的非负函数.如果 $ \Bqty{\Gamma_n} $ 是一列曲线, 它们割出的 $D$ 的有界子区域 $ \Bqty{D_n} $ 满足
$$
D_1 \subset D_2 \subset \cdots \subset D_n \subset \cdots,\quad
\nlim d(\Gamma(\gamma_n)) = +\infty.
$$
则反常积分 $ \d \iint_D f(x, y) \dxdy $ 在 $D$ 上收敛的充要条件: 数列 $ \Bqty{\d\iint_{D_n} f(x, y) \dxdy} $ 收敛, 且在收敛时成立
$$
\iint_D f(x, y) \dxdy = \nlim \iint_{D_n} f(x, y) \dxdy.
$$
**定理 13.4.1 (比较判别法)**

**定理 13.4.2** :star:	设 $D$ 为 $\R^2$ 上具有分段光滑边界的无界区域, 则 $f(x, y)$ 在 $D$ 上可积的==充要条件==是: $ \vqty{f(x, y)} $ 在 $D$ 上可积.

**推论 13.4.1 (Cauchy 判别法)**	设 $D$ 为用极坐标表示的区域
$$
D = \Bqty{(r, \theta) \mid 0 < a \le r < +\infty,\, \alpha \le \theta \le \beta,\, \alpha, \beta \in [0, 2\pi]}.
$$
其中 $ r = \sqrt{x^2+y^2} $. $f(x, y)$ 为定义在 $D$ 上的函数. 则

1. 如果存在正常数 $M$, 使得在 $D$ 上成立 $ \vqty{f(x, y)} \le \dfrac{M}{r^p} $, 则当 $p>2$ 时, $ \iint_D f(x, y) \dxdy $ 收敛.
2. 如果存在正常数 $m$, 使得在 $D$ 上成立 $ \vqty{f(x, y)} \ge \dfrac{m}{r^p} $, 则当 $p \le 2$ 时, $ \iint_D f(x, y) \dxdy $ 发散.

**定理 13.4.2**	设 $f(x, y)$ 在 $ D = \bpqty{a, +\infty} \times \bpqty{c, +\infty} $ 上连续, 且 $ \d \int_a^{+\infty} \dd{x} \int_c^{+\infty} f(x, y) \dd{y} $ 和 $ \d \int_a^{+\infty} \dd{x} \int_c^{+\infty} \vqty{f(x, y)} \dd{y} $ 都存在, 则 $f(x, y)$ 在 $D$ 上可积, 且等于累次积分.

**定理 13.4.4**	变量代换公式亦然成立, 且可由此推出积分==收敛==.

---

<h4>微分形式</h4>

:star: 有向面积, **外积**:
$$
\bm a \and \bm b = \begin{vmatrix}
	a_1 & a_2 \\
	b_1 & b_2 \\
\end{vmatrix}.
$$
**外积的性质**

1. 反称性: $ \bm a \and \bm b = - \bm b \and \bm a $.

   推论: $ \bm a \and \bm a = 0 $.

2. 双线性 (分配律)

   1. $ \bm a \and (\bm b + \bm c) = \bm a \and \bm b + \bm a \and \bm c $.
   2. $ (\bm a + \bm b) \and \bm c = \bm a \and \bm c + \bm b \and \bm c $.
   3. $ (\lambda \bm a) \and \bm b = \bm a \and (\lambda \bm b) = \lambda (\bm a \and \bm b) $.

**变量代换的微元关系**
$$
\begin{align}
\dxdy &= \vqty{\pdv{(x, y)}{(u, v)}} \dudv
\\
\dd{x} \and \dd{y} &= \pdv{(x, y)}{(u, v)} \dd{u} \and \dd{v}
\end{align}
$$
**一次微分形式** (**1-形式**) 全体记为 $ \Lambda ^1(U) $.
$$
a_1(\bm x) \dd{x_1} + a_2(\bm x) \dd{x_2} + a_n(\bm x) \dd{x_n},\quad
a_i(\bm x) \in C^1(U).
$$
**二次微分形式** (**2-形式**) 全体记为 $ \Lambda^2(U) $. 下式为其标准形式.
$$
\sum_{1 \le i < j \le n} g_{ij}(\bm x) \dd{x_i} \and \dd{x_j}.
$$
$k-$形式的标准形式为
$$
\sum_{1 \le \ssto{i}{k}{\lt} \le n} g_{\soneto{i}{k}} (\bm x)
$$
**微分形式的外积** :star:
$$
\begin{align}
\omega &= a_1(\bm x) \dd{x_1} + a_2(\bm x) \dd{x_2} + \cdots + a_n(\bm x) \dd{x_n},
\\
\eta &= b_1(\bm x) \dd{x_1} + b_2(\bm x) \dd{x_2} + \cdots + b_n(\bm x) \dd{x_n},
\\
\omega \and \eta &= \sum_{i, j = 1}^n a_i(\bm x) b_j(\bm x) \dd{x_i} \and \dd{x_j}
\\
&= \sum_{1 \le i < j \le n} \pqty{
	a_i(\bm x) b_j(\bm x) - a_j(\bm x) b_i(\bm x)
} \dd{x_i} \and \dd{x_j}
\\
&= \sum_{1 \le i < j \le n} \begin{vmatrix}
	a_i(\bm x) & a_j(\bm x) \\
	b_i(\bm x) & b_j(\bm x) \\
\end{vmatrix} \dd{x_i} \and \dd{x_j}.
\end{align}
$$

记 $ \Lambda = \Lambda^0 + \Lambda^1 + \cdots + \Lambda^n $, 其中元素的一般形式为 $ \omega = \splus{\omega}{n} $, $ \omega_i \in \Lambda^i $.

对于 $ \dd{x_I} = \dd{x_{i1}} \and \dd{x_{i2}} \and \cdots \and \dd{x_{ip}} $ 和 $ \dd{x_{J}} = \dd{x_{j1}} \and \dd{x_{j2}} \and \cdots \and \dd{x_{jq}} $, 定义外积
$$
\dd{x_I} \and \dd{x_J} = \dd{x_{i1}} \and \dd{x_{i2}} \and \cdots \and \dd{x_{ip}} \and \dd{x_{j1}} \and \dd{x_{j2}} \and \cdots \and \dd{x_{jq}}.
$$
对于 $ \omega = \dsum_{I} g_I(\bm x) \dd{x_I} $ 和 $ \eta = \dsum_J h_J(\bm x) \dd{x_J} $, 定义外积
$$
\omega \and \eta = \sum_{I, J} g_I(\bm x) h_J(\bm x) \dd{x_I} \and \dd{x_J}.
$$
对于 $0-$形式 $f$, 补充定义
$$
f\omega = f \and \omega = \sum_I f(\bm x) g_I(\bm x) \dd{x_I},\quad \omega \in \Lambda^p.
$$
**外积的性质**

**性质 1**	设 $ \omega \in \Lambda^p,\, \eta = \Lambda^q $, 则当 $ p+q>n $ 时, $ \omega \and \eta = 0 $.

**性质 2**	设 $ \omega \in \Lambda^p,\, \eta = \Lambda^q $, 则 $ \omega \and \eta = (-1)^{pq} \eta \and \omega $.

**推论 13.5.1**	设 $ \omega \in \Lambda^p $, 则当 $p$ 为奇数时, $ \omega \and \omega = 0 $.

**性质 3**	$ \forall \omega, \eta, \sigma \in \Lambda $, 成立分配律和结合律:

1. $ (\omega + \eta) \and \sigma = \omega \and \sigma + \eta \and \sigma $.

   $ \sigma \and (\omega + \eta) = \sigma \and \omega + \sigma \and \eta $.

2. $ (\omega \and \eta) \and \sigma = \omega \and (\eta \and \sigma) $.

**变量代换公式**
$$
T: y_1 = y_1(\soneto{x}{n}),\, y_2 = y_2(\soneto{x}{n}),\, \cdots,\, y_n = y_n(\soneto{x}{n}).
\\
\dd{y_1} \and \dd{y_2} \and \cdots \and \dd{y_n} = \dpdv{(\soneto{y}{n})}{(\soneto{x}{n})} \dd{x_1} \and \dd{x_2} \and \cdots \and \dd{x_n}.
$$
实际上, 对于 1-形式 $ \omega_j = \insum a_{ij} \dd{x_i} $, 有
$$
\ssto{\omega}{n}{\and} = \det(a_{ij}) \ssto{\dd{x}}{n}{\and}.
$$



### 笔记

<h4>特殊积分</h4>

- **Poisson 积分**: $ \dint_0^{+\infty} \e^{-x^2} \dd{x} = \dfrac{\sqrt{\pi}}{2} $.

- $ \dint\limits_{\splus{x^2}{n} \le 1} \dfrac{\dd x_1 \dd x_2 \cdots \dd x_n}{\sqrt{1 - \ssto{x^2}{n}{-} }} = \begin{cases} \dfrac{\pi^{m+1}}{m!}, & n = 2m+1, \\ \dfrac{2^m}{(2m-1)!!}, & n = 2m. \end{cases} $.

  注: 累次积分一次后, 即高维球的体积.

<h4>函数转积分</h4>

- $ \dfrac{\arctan{x}}{x} = \dint_0^1 \dfrac{\dd{y}}{1 + x^2y^2} $.



### 例题







## 第 14 章	曲线积分、曲面积分与场论

### 定理

**性质 1 (线性性)**

**性质 2 (路径可加性)**

**定理 14.1.1**	设 $L$ 为光滑曲线, 函数 $f(x, y, z)$ 在 $L$ 上连续, 则 $f(x, y, z)$ 在 $L$ 上的第一类曲线积分存在, 且
$$
\int_L f(x, y, z) \ds = \int_\alpha^\beta f(x(t), y(t), z(t)) \sqrt{x'^2(t) + y'^2(t) + z'^2(t)} \dt.
$$
**简单曲面**: 具有分段光滑边界的有界闭区域.
$$
\bm r = x(u, v) \bm i + y(u, v) \bm j + z(u, v) \bm k.
\\
S = \iint_D \norm{
	\bm r_u(u, v) \cp \bm r_v(u, v)
} \dudv.
$$
**定理 14.1.2** :star:	记曲面的 **Gauss 系数** 为
$$
\begin{align}
E &= \bm r_u \cdot \bm r_u = x_u^2 + y_u^2 + z_u^2,
\\
F &= \bm r_u \cdot \bm r_v = x_u x_v + y_u y_v + z_u z_v,
\\
G &= \bm r_v \cdot \bm r_v = x_v^2 + h_v^2 + z_v^2.
\end{align}
$$
则曲面的面积为 $ S = \d\iint_D \sqrt{EG-F^2} \dudv $.

- 注意到 $\d EG - F^2 = \bqty{\pdv{(y, z)}{(u, v)}}^2 + \bqty{\pdv{(z, x)}{(u, v)}}^2 + \bqty{\pdv{(x, y)}{(u, v)}}^2 = \norm{\bm r_u \cp \bm r_v}^2$.

**Schwarz 的例子**	可以将光滑曲线的弧长定义为内接折线长度的极限, 但不能推广到光滑曲面的面积定义. (如圆柱)

---

**第二类曲线积分**	令单位切向量为 $ \bm \tau = (\cos\alpha, \cos\beta, \cos\gamma) $, 则 $ \dint_L \bm f \cdot \bm \tau \dd{s} = \int_L \bm f \cdot \dd{\bm s} $.
$$
\int_L P \dd{x} + Q \dd{y} + R \dd{z} = \int_L \pqty{
	P\cos\alpha + Q\cos\beta + R\cos\gamma
} \ds
$$
**性质 1 (方向性)**

**性质 2 (线性性)**

**性质 3 (路径可加性)**

---

双侧曲面, 定向曲面, Mobius 带, 单侧曲面

**第二类曲面积分**	令单位法向量为 $ \bm n = (\cos\alpha, \cos\beta, \cos\gamma) $, $ \d\iint_\sum \bm f \cdot \bm n \dd{S} $.

**性质 1 (方向性)**

**性质 2 (线性性)**

**性质 3 (曲面可加性)**
$$
\dxdy := \dd{x} \and \dd{y} = a\cos\alpha \dd{S}
$$
**参数方程的曲面积分**
$$
\begin{align}
\iint_\sum \bm f \cdot \dd{\bm S}
&= \iint_\sum P \dd{y} \and \dd{z} + Q \dd{z} \and \dd{x} + R \dd{x} \and \dd{y}
\\
&= \iint_\sum P \dydz + Q \dzdx + R \dxdy
\\
&= \iint_\sum \pqty{
	P \cos\alpha + Q\cos\beta + R\cos\gamma
} \dd{S}
\\
&= \pm \iint_D \bqty{
	P \pdv{(y, z)}{(u, v)} + Q \pdv{(z, x)}{(u, v)} + R \pdv{(x, y)}{(u, v)}
} \dudv
\end{align}
$$

$$
\iint_\sum R(x, y, z) \dxdy = \pm \iint_{D_{xy}} R(x, y, z(x, y)) \dxdy.
$$

---

**简单闭曲线** (**Jordan 曲线**)	$t_1 \ne t_2 \RA \bm r(t_1) \ne \bm r(t_2)$.

**单连通区域**, **复连通区域**. **标准区域**, 

**定理 14.3.1 (Green 公式)**	设 $D$ 为平面上由光滑或分段光滑的简单闭曲线所围成的==单连通闭区域==. 如果函数 $P(x, y)$ 和 $Q(x, y)$ 在 $D$ 上具有连续偏导数, 那么
$$
\int\limits_{\partial D} P\dd{x} + Q\dd{y}
= \iint\limits_D \pqty{
	\pdv{Q}{x} - \pdv{P}{y}
} \dxdy,
$$
其中 $\partial D$ 取正向, 即 **诱导定向**.

---

:star: 取单位切向量为 $\bm\tau$, 单位外法向量为 $\bm n$, 那么
$$
\begin{align}
\iint\limits_D \pqty{\pdv{F}{x} + \pdv{G}{y}}\dxdy
&= \int\limits_{\partial D} F\dy - G\dx
= \int\limits_{\partial D} \bqty{
	F \sin(\bm \tau, x) - G \cos(\bm \tau, x)
} \ds
\\
&= \int\limits_{\partial D} \bqty{
	F\cos(\bm n, x) + G\cos(\bm n, y)
} \ds.
\end{align}
$$

---

:star: 求平面图形面积
$$
S = \int\limits_{\partial D} x\dy
= - \int\limits_{\partial D} y\dx
= \dfrac{1}{2} \int\limits_{\partial D} x\dy - y\dx.
$$

---

**定理 14.3.2 (Green 定理)**	设 $D$ 为平面上的单连通区域, $P(x, y),\, Q(x, y)$ 在 $D$ 上具有连续的偏导, 则下面的四个面体等价:

1. 对于 $D$ 内任意一条分段光滑的闭曲线 $L$ 有 $ \dint\limits_{L} P\dx + Q\dy = 0 $.
2. 曲线积分 $\dint\limits_L P\dx + Q\dy$ 与路径无关.
3. $ \exist U(x, y) \in D: \dd{U} = P\dx + Q\dy $.
4. 在 $D$ 内成立等式 $ \dpdv{P}{y} = \dpdv{Q}{x} $.

**定理 14.3.3**	曲线积分 $\dint\limits_L P\dx + Q\dy$ 与路径无关的充要条件是, 存在原函数 $U(x, y)$ 使得
$$
\int\limits_{\stackrel\frown{AB}} P\dx + Q\dy = U(x_B, y_B) - U(x_A, y_A).
$$
**定理 13.4 (Gauss 公式)**	下式 $\partial \Omega$ 的定向为外侧, 称为其 **诱导定向**.
$$
\iiint\limits_\Omega \pqty{\pdv{P}{x} + \pdv{Q}{y} + \pdv{R}{z}} \dxdydz
= \iint\limits_{\partial \Omega} P\dydz + Q\dzdx + R\dxdy.
$$

---

:star: 计算体积
$$
V = \iiint\limits_\Omega \dxdydz
= \iint\limits_{\partial \Omega} x\dydz
= \iint\limits_{\partial \Omega} y\dzdx
= \iint\limits_{\partial \Omega} z\dxdy
= \dfrac{1}{3} \iint\limits_{\partial \Omega} x\dydz + y\dzdx + z\dxdy.
$$

---

**定理 14.3.5 (Stokes 公式)**
$$
\begin{align}
\int\limits_{\partial \sum} P\dx + Q\dy + R\dz
&= \iint\limits_\sum 
\pqty{\pdv{R}{y} - \pdv{Q}{z}} \dydz +
\pqty{\pdv{P}{z} - \pdv{R}{x}} \dzdx +
\pqty{\pdv{Q}{x} - \pdv{P}{y}} \dxdy
\\
&= \iint\limits_\sum \bqty{
	\pqty{\pdv{R}{y} - \pdv{Q}{z}} \cos\alpha +
	\pqty{\pdv{P}{z} - \pdv{R}{x}} \cos\beta + 
	\pqty{\pdv{Q}{x} - \pdv{P}{y}} \cos\gamma
} \dd{S}.
\end{align}
$$

- 上式可用三阶行列式的记号表示, 不再列出.

---

<h4>外微分</h4>

**外微分例子**
$$
\begin{align}
\omega &= P(x, y) \dx + Q(x, y) \dy
\\
\dd{\omega} &= \pqty{
	\pdv{P}{x} \dx + \pdv{P}{y} \dy
} \and \dx + \pqty{
	\pdv{Q}{x} \dx + \pdv{Q}{y} \dy
} \and \dy
\\
&= \pqty{
	\pdv{Q}{x} - \pdv{P}{y}
} \dx \and \dy
\end{align}
$$

$$
\begin{align}
\omega &= P(x, y, z) \dx + Q(x, y, z) \dy + R(x, y, z) \dz
\\
\dd{\omega} &=
\pqty{\pdv{R}{y} - \pdv{Q}{z}} \dy \and \dz +
\pqty{\pdv{P}{z} - \pdv{R}{x}} \dz \and \dx +
\pqty{\pdv{Q}{x} - \pdv{P}{y}} \dx \and \dy
\end{align}
$$

$$
\begin{align}
\omega &= P(x, y, z) \dy \and \dz + Q(x, y, z) \dz \and \dx + R(x, y, z) \dx \and \dy
\\
\dd{\omega} &= \pqty{\pdv{P}{x} + \pdv{Q}{y} + \pdv{R}{z}} \dxdydz
\end{align}
$$

**外微分性质**

**性质 1**	设 $\omega$ 为 $k-$形式, $\eta$ 为 $l-$形式, 则
$$
\dd(\omega \and \eta)
= \dd{\omega} \and \eta + \dd{\eta} \and \omega
= \dd{\omega} \and \eta + (-1)^k \omega \and \dd{\eta}.
$$

- 设 $f \in \Lambda^0$ 为 $0-$形式, 则 $ \dd{^2 f} = 0 $.

**性质 2**	$ \forall \omega \in \Lambda: \dd{^2 \omega} = 0 $.

**Stokes 公式** :star:	$ \dint\limits_{\partial M} \omega = \int\limits_{M} \dd{\omega} $.

---

<h4>场论初步</h4>

数量场, 向量场; 稳定场, 不稳定场.

**梯度**	$\grad f = f_x \bm i + f_y \bm j + f_z \bm k$.

**方向导数**	$\dpdv{f}{\bm l} = \grad f \cdot \bm l$.

**单位法向量上**	$\dpdv{f}{\bm n} = \norm{\grad f}$.

**梯度的另一种表示**	$\grad f = \dpdv{f}{\bm n} \cdot \bm n$.

由数量场 $f$ 产生的向量场 $\grad f$ 称为 **梯度场**.

---

**通量**	$ \varPhi = \d\iint\limits_\sum \bm a \cdot \dd{\bm S} $.

**散度**	$ \div \bm a = \dpdv{P}{x} + \dpdv{Q}{y} + \dpdv{R}{z} $.

**定理 14.5.1**	散度是通量关于体积的变化率, 即穿出单位体积边界的通量, 即
$$
\div \bm a(M) = \lim_{V \to M}
\d\iint\limits_{\sum} \dfrac{
	\bm a \cdot \dd{\bm S}
}{mV}.
$$
由向量场 $\bm a$ 产生的数量场 $\div \bm a$ 称为 **散度场**.

**Gauss 公式**	$ \d\iiint\limits_\Omega \div \bm a \dd{V} = \iint\limits_{\partial \Omega} \bm a \vdot \dd{\bm S} $.

**电场的高斯定理**	$ \iintl_\sum \bm E \cdot \dd{\bm S} = \dfrac{q}{\ve_0} $.

---

**向量线** (**流线**)
$$
\dfrac{\dx}{P(x, y, z)} = \dfrac{\dy}{Q(x, y, z)} = \dfrac{\dz}{R(x, y, z)}.
$$

---

**环量与旋度**

流体在旋涡中心附近的速度 $ \bm v = \bm v_0 + \bm \omega \cp \bm r $.

定义向量 $ \bm B = \pqty{
	\dpdv{v_z}{y} - \dpdv{v_y}{z}
} \bm i + \pqty{
	\dpdv{v_x}{z} - \dpdv{v_z}{x}
} \bm j + \pqty{
	\dpdv{v_y}{x} - \dpdv{v_x}{y}
} \bm k = 2 \bm \omega $.

则 $ \dint\limits_\Gamma \bm v \cdot \dd{\bm s} = \iint\limits_\sum \bm B \cdot \dd{\bm S} $.

**环量**	$ \dint\limits_\Gamma \bm a \cdot \dd{\bm s} $.

**旋度**	$\curl \bm a(M) = \begin{pmatrix}
	\bm i & \bm j & \bm k \\
	\dpdv x & \dpdv y & \dpdv z \\
	P & Q & R
\end{pmatrix}_M$.

由向量场 $\bm a$ 产生的向量场 $\curl a$ 称为 **旋度场**.

若 $ \curl \bm a \equiv \bm 0 $, 则称 $\bm a$ 为 **无旋场**.

**Stokes 公式**	$ \d\iint\limits_{\sum} \curl \bm a \cdot \dd{\bm S} = \int\limits_{\partial \sum} \bm a \cdot \dd{\bm s} $.

**环量面密度**	$ \lim\limits_{\sum \to M} \intl_{\partial \sum} \dfrac{\bm a \cdot \dd{\bm s}}{m\sum} = \curl \bm a \cdot \dfrac{\bm n}{\norm{\bm n}} $.

**定理 14.5.2**	$\bm a$ 在 $M$ 点处沿旋度方向的环量面密度最大, 且最大值为 $ \norm{\curl \bm a(M)} $.

- 流体速度场中, 在与 $\curl \bm a$ 垂直的平面上, 沿单位面积边缘的环量最大, 达到角速度的模的两倍.

**磁场的安培环路定律**	$ \intl_\Gamma \bm B \cdot \dd{\bm s} = \mu_0 I $.

---

<h4>Hamilton 算子</h4>

梯度、散度、旋度的 Hamilton 算子表示.

**注意**	$ \div \bm a \ne \bm a \cdot \grad = P\dpdv{x} + Q\dpdv{y} + R\dpdv{z} $.

**Laplace 算子**	$\Delta = \div\grad = \dpdv[2]{x} + \dpdv[2]{y} + \dpdv[2]{z}$, 具体有两种含义:

1. $ \Delta f = \dpdv[2]{f}{x} + \dpdv[2]{f}{y} + \dpdv[2]{f}{z} $.
2. $ \Delta \bm a = \Delta P \bm i + \Delta Q \bm j + \Delta R \bm k $. (注意并非直接对分量求二阶导 :star:)

满足 **Laplace 方程** $ \Delta u(x, y, z) = 0 $ 的函数叫做 **调和函数**.

**Gauss 公式**	$ \iintl_{\partial \Omega} \bm a \cdot \dd{\bm S} = \iiintl_\Omega \div \bm a \dd{V} $.

**Stokes 公式**	$ \intl_{\partial \sum} \bm a \cdot \dd{\bm s} = \iintl_{\sum} (\curl \bm a) \cdot \dd{\bm S} $.

**Green 第一公式** :star:	由 $ \div(g \grad f) = \grad g \cdot \grad f + g\Delta f $ 得:
$$
\iiintl_\Omega \pqty{
	\grad f \cdot \grad g + f \Delta g
} \dd{V} = \iintl_{\partial \Omega} f \pdv{g}{\bm n} \dd{S}
\\
\iiintl_\Omega \pqty{
	\grad g \cdot \grad f + g \Delta f
} \dd{V} = \iintl_{\partial \Omega} g \pdv{f}{\bm n} \dd{S}
$$
**Green 第二公式** :star:	由上两式相减即得:
$$
\iiintl_\Omega (f\Delta g - g\Delta f) \dd{V}
= \iintl_{\partial \Omega} \pqty{
	f\pdv{g}{\bm n} - g\pdv{f}{\bm n}
} \dd{S}
$$
**Hamilton 算子的性质** :star: :star:

以下 $f$ 为数量场函数, $\bm a$ 为向量场函数, $\bm c$ 为常向量.

​		梯度

1. $ \grad (\lambda f + \mu g) = \lambda\grad f + \mu \grad g $.

2. $ \grad (fg) = f\grad g + g\grad f $.

3. $ \grad (\bm a \cdot \bm b) = \bm a \times (\curl \bm b) + \bm b \times (\curl \bm a) + (\bm a \cdot \grad) \cdot \bm b + (\bm b \cdot \grad) \cdot \bm a $.

4. $ \grad (\div \bm a) = \Delta \bm a + \curl(\curl \bm a) $.

   ---

   散度

5. $ \div(\lambda \bm a + \mu \bm b) = \lambda(\div \bm a) + \mu(\div \bm b) $.

6. $ \div(f\bm a) = f\div \bm a + \grad f \cdot \bm a $.

7. $ \div (\bm a \cp \bm b) = (\curl \bm a) \cdot \bm b - \bm a \cdot (\curl \bm b) $.

8. $ \div (\grad f) = \Delta f $.

9. $ \div (\curl \bm a) = 0 $.

   ---

   旋度

10. $ \curl (\lambda \bm a + \mu \bm b) = \lambda (\curl \bm a) + \mu(\curl \bm b) $.

11. $ \curl(f\bm a) = f \curl a + \grad f \times \bm a $.

12. $ \curl (\bm a \times \bm b) = \bm a (\div \bm b) - \bm b (\div \bm a) - (\bm a \cdot \grad) \bm b + (\bm b \cdot \grad) \bm a $.

13. $ \curl (\grad f) = \bm 0 $.

14. $ \curl (\curl \bm a) = \grad(\div \bm a) - \Delta \bm a $.

    ---

    其它

15. $ \div(g \grad f) = \grad g \cdot \grad f + g\Delta f $.

16. $ \Delta \bm a = \grad (\div \bm a) - \curl (\curl \bm a) $.

    ---

    常值

17. $ \div (\bm c \cp \bm r) = 0 $.

18. $ \curl (\bm c \cp \bm r) = 2\bm c $.

19. $ \div (\bm r^2 \bm c) = 2\bm r \cdot \bm c $.

---

由性质 3, $ f\div \bm a = \div (f\bm a) - \grad f \cdot \bm a $, 积分即得 "分部" 积分公式
$$
\iiintl_\Omega f\div a \dd{V} = \iintl_{\partial \Omega} f\bm a \cdot \dd{\bm S} - \iiintl_\Omega \grad f \cdot \bm a \dd{V}.
$$

---

**定义 14.5.3**	若 $ \exist U(x,y,z): \bm a = \grad U $, 则称向量场 $\bm a$ 为 **有势场**, 并称函数 $V = -U$ 为 **势函数**.

- 有势场是梯度场, 一个场的势函数有无穷多个.

**定义 14.5.4**	**保守场**

**单连通区域**

- 空心球是单连通区域, 但不是二维单连通的.
- 环面内部是二维单连通的, 但不是单连通的.

**定理 14.5.3**	设 $\Omega \in \R^3$ 为单连通区域, 在 $\Omega$ 上定义了向量场
$$
\bm a(x, y, z) = P(x, y, z) \bm i + Q(x, y, z) \bm j + R(x, y, z) \bm k,\quad (x, y, z) \in \Omega,
$$
并且各分量具有连续偏导, 则以下四个命题等价:

1. 沿 $\Omega$ 内任意闭曲线的积分值为零.
2. $\bm a$ 是保守场.
3. $\bm a$ 是有势场.
4. $\bm a$ 是无旋场.

**定理 14.5.4**	原函数与三维的牛顿 - 莱布尼茨定理.

---

电力线, 等势线.

---

<h4>热传导模型</h4>

:star:
$$
\begin{align}
\dd{Q} &= -k\dt \iintl_{\partial \Omega} \pdv{U}{\bm n} \dd{S}
= -k\dt \iintl_{\partial \Omega} (\grad U) \cdot \bm n \dd{S}
= -k\dt \iintl_{\partial \Omega} \grad U \cdot \dd{\bm S}
\\
&= -k\dt \iiintl_{\Omega} \div\grad U \dd{V}
= -k\dt \iiintl_{\Omega} \grad^2 U\dd{V}
= -k\dt \iiintl_{\Omega} \Delta U \dd{V}
\\
\dd{Q} &= \iiintl_{\Omega} c\dd{U} \rho \dd{V}
= \dt \iiintl_\Omega c\rho \pdv{U}{t} \dd{V}
\end{align}
$$

$$
\pdv{U}{t} = \dfrac{k}{c\rho} \Delta U \equiv a^2 \Delta U.
$$

当温度场是稳定场时, 上述方程即 Laplace 方程 $ \Delta U = 0 $, 即 $U$ 是调和函数.

==无热源==的稳定温度场 $U$ 满足以下条件:
$$
\begin{cases}
	\Delta U = 0, & \text{在 } \Omega \text{ 中}, \\ \\
	\iintl_{\partial \Omega} \dpdv{U}{\bm n} = 0, & \text{在 } \partial \Omega \text{ 上}.
\end{cases}
$$

---




### 笔记

<h4>曲线长度</h4>

- $ \bm r = x(t) \bm i + y(t) \bm j + z(t) \bm k $.

  $\d \int_L f(x, y, z) \ds = \int_\alpha^\beta f(x, y, z) \sqrt{x'^2 + y'^2 + z'^2} \dt$.

<h4>曲面面积</h4>

- $\bm r = x(u, v) \bm i + y(u, v) \bm j + z(u, v) \bm k$.

  $ S = \d\iint_D \sqrt{EG-F^2} \dudv $.

  $ \d\iint_\sum f(x,y,z) \dd{S} = \d\iint_D f(x(u, v), y(u, v), z(u, v)) \sqrt{EG-F^2} \dudv $.

- $ z = f(x, y) $.	即 $ \bm r = x\bm i + y \bm j + f(x, y) \bm k $, 使用上述公式

  $  \d S = \iint_D \sqrt{1+f_x^2 + f_y^2} \dxdy $.

- $  H(x, y, z) = 0 $.	假设 $ z = f(x,y) $, 使用上述公式.

  $ S = \d\iint_D \dfrac{\norm{\grad H}}{H_z} \dxdy $.

<h4>Hamilton 算子的性质</h4>

见定理部分.

<h4>调和函数</h4>

- 等价条件

  - 二维: 对于任意光滑封闭曲线 $C$, 其中 $\bm n$ 为外法线方向单位向量,
    $$
    \Delta u \equiv 0 \QRLA \intl_{C} \dpdv{u}{\bm n} \ds \equiv 0.
    $$

  - 三维: 对于任意光滑封闭曲面 $\sum$, 其中 $\bm n$ 为外法线方向单位向量,
    $$
    \Delta u \equiv 0 \QRLA
    \iintl_{\sum} \dpdv{u}{\bm n} \dd{S} =
    \iintl_{\sum} \grad u \dd{S} \equiv 0.
    $$

- 性质

  - 对于二元的调和函数 $u, v$, $ \forall p \ge 2, F = \sqrt{u^2+v^2} \ne 0 $, 成立 $ \Delta (F^p) \ge 0 $.

    满足 $\Delta f \ge 0$ 的二元函数称为次调和函数.

  - 对于包含定点 $(x_0, y_0, z_0)$ 的任意分片光滑封闭曲面, 记 $ \bm r = (x-x_0, y-y_0, z-z_0) $, 则
    $$
    u(x_0, y_0, z_0) = \dfrac{1}{4\pi} \iintl_{\sum} \pqty{
    	u\dfrac{\cos(\bm r, \bm n)}{r^2} + \dfrac{1}{r} \pdv{u}{\bm n}
    } \dd{S}.
    $$

- 例子

  - 二维
    - $ u = \dfrac{1}{2} \ln(x^2+y^2) $.
    - $ u = \e^x \sin{y} $.
    - $ u = \dfrac{x}{x^2+y^2} $.

  - 三维. 定义 $r = \sqrt{x^2+y^2+z^2}$.
    - $ u = \dfrac{1}{r} $.
    - $ u = \dfrac{x}{r^3} $.
    - $ u = \ln(r+z) $.
    - $ u = \dfrac{x}{r(r+z)} $.

<h4>一些公式</h4>

- 由 Green 公式得:
  $$
  \intl_{\partial D} -u\pdv{u}{y}\dx + u\pdv{u}{x}\dy
  = \iintl_{D} \bqty{
  	\pqty{\dpdv{u}{x}}^2 + \pqty{\dpdv{u}{y}}^2 + u \pqty{
  		\dpdv[2]{u}{x} + \dpdv[2]{u}{y}
  	}
  } \dxdy.
  $$

- 



### 例题

1. 卫星电波覆盖地球的面积 $ S = 4\pi R^2 \sin^2\dfrac{\alpha}{2} = 4\pi R^2 \cdot \dfrac{h}{2(R+h)} $.

2. 设 $ \omega = \dsum_{i,j=1}^n a_{ij} \dx_i \and \dx_j\; (a_{ij} = -a_{ji},\, i, j = \oneton) $ 是 $\R^n$ 上的 $2-$形式, 则
   $$
   \d{\omega} = \dfrac{1}{3} \dsum_{i,j,k=1}^n \pqty{
   	\pdv{a_{ij}}{x_k} + \pdv{a_{jk}}{x_i} + \pdv{a_{ki}}{x_j}
   } \dx_i \and \dx_j \and \dx_k.
   $$

3. 

未做前三节习题.



## 第 15 章	含参变量积分

### 定理

<h4>含参变量的常义积分</h4>

**第二类完全椭圆积分** :star:
$$
E(k) = \int_0^{\tfrac{\pi}{2}} \sqrt{1-k^2\sin^2t} \dt.
$$
其中 $ k = \dfrac{\sqrt{b^2-a^2}}{b} $, 椭圆周长 $ C = \dint_L \ds = b\, E(k) $. 第二类椭圆积分满足微分方程
$$
E''(k) + \dfrac{1}{k} E'(k) + \dfrac{E(k)}{1-k^2}=0.
$$
**定理 15.1.1 (连续性定理)**	设 $f(x, y)$ 在闭矩形 $ D = [a, b] \times [c, d] $ 上连续, 则函数
$$
I(y) = \int_a^b f(x, y) \dx
$$
在 $[c, d]$ 上连续.

- 极限运算与积分运算可交换: $ \liml_{y\to y_0} \dint_a^b f(x, y) \dx = \dint_a^b \liml_{y\to y_0} f(x,y)\dx $.

**定理 15.1.2 (积分次序交换定理)**	设 $f(x, y)$ 在闭矩形 $[a, b] \times [c, d]$ 上连续, 则
$$
\int_c^d \dy \int_a^b f(x, y) \dx = \int_a^b \dx \int_c^d f(x, y) \dy.
$$
**定理 15.1.3 (积分号下求导定理)**	设 $f(x, y),\, f_y(x, y)$ 都在闭矩形 $[a, b] \times [c, d]$ 上连续, 则
$$
\dv{I(y)}{y} = \int_a^b \pdv{y} f(x, y) \dx =\int_a^b f_y(x, y) \dx.
$$
**定理 15.1.4 (变上下限求导公式)**	对于 $ F(y) = \dint_{a(y)}^{b(y)} f(x, y) \dx $, 有
$$
F'(y) = \int_{a(y)}^{b(y)} \pdv{y} f(x, y) \dx + f(b(y), y) b'(y) - f(a(y, y)) a'(y).
$$

- 对于类似 $ I(\theta) = \dint_0^\pi \ln(1+\theta\cos{x}) \dx\; (\vqty{\theta} < 1) $ 的积分, 可以采用费曼积分法, 即先求出 $I'(\theta)$ 再做积分.

---

<h4>含参变量的反常积分</h4>

**定理 15.2.1 (Cauchy 收敛原理)**	含参变量反常积分 $\dint_a^{+\infty} f(x, y) \dx$ 在 $[c, d]$ 上一致收敛的充要条件是: 对于任意给定的 $\ve > 0$, 存在与 $y$ 无关的正数 $A_0$, 使得对于任意的 $ A', A > A_0 $, 成立
$$
\vqty{
	\int_A^{A'} f(x, y) \dx
} < \ve,\quad y \in [c, d].
$$
**推论 15.2.1**	若存在 $\ve_0>0$, 使得对于任意大的正数 $A_0$, 总存在 $A', A > A_0$ 及 $y_{A_0} \in [c, d]$, 使得
$$
\vqty{
	\int_A^{A'} f(x, y_{A_0}) \dx
} \ge \ve_0,
$$
那么含参变量反常积分 $\dint_a^{_\infty} f(x, y) \dx$ 在 $[c, d]$ 上非一致收敛.

**定理 (Weierstrass 判别法)**	如果存在函数 $F(x)$ 使得

1. $ \vqty{f(x, y)} \le F(x),\quad a \le x < +\infty,\, c \le y \le d $.
1. 反常积分 $\dint_a^{+\infty} F(x)\dx$ 收敛.

那么含参变量的反常积分 $\dint_a^{+\infty} f(x, y) \dx$ 在 $[c, d]$ 上一致收敛.

**定理 15.2.3**	设函数 $f(x, y)$ 和 $g(x, y)$ 满足以下两组条件之一, 则含参变量的反常积分
$$
\dint_a^{+\infty} f(x, y) g(x, y) \dx
$$
关于 $y$ 在 $[c, d]$ 上一致收敛.

1. **Abel 判别法** (一致收敛 + 单调有界)

   1. $ \dint_a^{+\infty} f(x, y) \dx $ 关于 $y$ 在 $[c, d]$ 上一致收敛.

   2. $g(x, y)$ 关于 $x$ 单调.

   3. $g(x, y)$ 一致有界, 即存在正数 $L$, 使得
      $$
      \vqty{g(x, y)} \le L, \quad a \le x < +\infty,\, c \le y \le d.
      $$

2. **Dirichlet 判别法** (一致有界 + 单调趋零)

   1. $\dint_a^A f(x, y)\dx$ 一致有界, 即存在正数 $L$, 使得
      $$
      \vqty{\int_a^A f(x, y) \dx} \le L,\quad a < A < +\infty,\, y \in [c, d].
      $$

   2. $g(x, y)$ 关于 $x$ 单调.

   3. 当 $x\to+\infty$ 时, $g(x, y)$ 关于 $y$ 在 $[c, d]$ 上一致趋于零, 即
      $$
      \forall \ve>0, \exist A_0, \forall x \ge A_0, \forall y \in [c,d]: \vqty{g(x, y)} < \ve.
      $$

**定理 15.2.4 (Dini 定理)**	设 $f(x, y)$ 在 $\bpqty{a, +\infty} \cp [c, d]$ 上连续且保持==定号==, 如果含参变量积分
$$
I(y) = \int_a^{+\infty} f(x, y) \dx
$$
在 $[c, d]$ 上连续, 那么含参变量积分 $ \dint_a^{+\infty} f(x, y) \dx $ 关于 $y$ 在 $[c, d]$ 上一致收敛.

---

<h4>一致收敛积分的分析性质</h4>

采用如下记号:
$$
\begin{align}
I(y) &= \int_a^{+\infty} f(x, y) \dx, \quad y \in [c, d]
\\
a_0 &= a,\quad a_{n+1}>a_n, \quad \nlim a_n = +\infty
\\
u_n(y) &= \int_{a_{n+1}}^{a_n} f(x, y) \dx,\quad n = 1, 2 \cdots
\\
\int_{a}^{+\infty} & f(x, y) \dx = \nsum u_n(y)
\end{align}
$$
**引理 15.2.1**	若含参变量反常积分 $ \dint_a^{+\infty} f(x, y) \dx $ 关于 $y$ 在 $[c, d]$ 上一致收敛, 则函数项级数 $ \nsum u_n(y) $ 在 $[c, d]$ 上一致收敛.

**定理 15.2.5 (连续性定理)**	设 $f(x, y)$ 在 $\bpqty{a, +\infty} \cp [c, d]$ 上连续, $\dint_a^{+\infty} f(x, y) \dx$ 关于 $y$ 在 $[c, d]$ 上一致收敛, 则函数
$$
I(y) = \int_a^{+\infty} f(x, y) \dx
$$
在 $[c, d]$ 上连续, 极限运算与积分运算可以交换, 即
$$
\liml_{y\to y_0} \int_a^{+\infty} f(x, y) \dx = \int_a^{+\infty} \liml_{y\to y_0} f(x, y) \dx, \quad y_0 \in [c, d].
$$
**定理 15.2.6 (积分次序交换定理)**	设 $f(x, y)$ 在 $\bpqty{a, +\infty} \cp [c, d]$ 上连续, $ \dint_a^{+\infty} f(x, y) \dx $ 关于 $y$ 在 $[c, d]$ 上一致收敛, 则积分次序可交换, 即
$$
\int_c^d \dy \int_a^{+\infty} f(x, y) \dx = \int_a^{+\infty} \dx \int_c^d f(x, y) \dy.
$$
**定理 15.2.6'**	设 $f(x, y)$ 在 $\bpqty{a, +\infty} \cp [c, d]$ 上连续, $ \dint_a^{+\infty} f(x, y) \dx $ 关于 $y$ 在 $[c, C]$ 上一致收敛, $ \dint_a^{+\infty} f(x, y) \dx $ 关于 $x$ 在 $[a, A]$ 上一致收敛, 且 $ \dint_a^{+\infty} \dx \dint_c^{+\infty} \vqty{f(x, y)} \dy $ 和 $ \dint_c^{+\infty} \dy \dint_a^{+\infty} \vqty{f(x, y)} \dx $ 中有一个存在, 那么
$$
\int_c^{+\infty} \dy \int_a^{+\infty} f(x, y) \dx = \int_a^{+\infty} \dx \int_c^{+\infty} f(x, y) \dy.
$$
**定理 15.2.7 (积分号下求导定理)**	设 $f(x, y), f_y(x, y)$ 都在 $\bpqty{a, +\infty} \cp [c, d]$ 上连续, $ \dint_a^{+\infty} f(x, y) \dx $ 对于每个 $y \in [c, d]$ 收敛, 且 $\dint_a^{+\infty} f_y(x, y) \dx$ 关于 $y$ 在 $[c, d]$ 上一致收敛, 则 $ I(y) = \dint_a^{+\infty} f(x, y) \dx $ 在 $[c, d]$ 上可导, 并且在 $[c, d]$ 上成立
$$
\dv{y} \int_a^{+\infty} f(x, y) \dx = \int_a^{+\infty} \pdv{y} f(x, y) \dx.
$$

---

<h4>Beta 函数 (第一类 Euler 积分)</h4>

$$
B(p, q) = \int_0^1 x^{p-1} (1-x)^{q-1} \dx, \quad p, q \in (0, +\infty).
$$

**性质**

1. 连续性.

2. 对称性 $ B(p, q) = B(q, p) $.

3. 递推公式
   $$
   \begin{align}
   B(p, q) &= \dfrac{q-1}{p+q-1}B(p, q-1)
   \\
   &= \dfrac{(p-1)(q-1)}{(p+q-1)(p+q-2)} B(p-1, q-1)
   \end{align}
   $$

4. 其它表示
   $$
   \begin{align}
   B(p, q) &=
   \int_0^1 x^{p-1} (1-x)^{q-1} \dx
   \\
   &= 2\int_0^{\tfrac{\pi}{2}} \cos^{2p-1}\varphi \sin^{2q-1}\varphi \dd{\varphi}
   & (x = \cos^2\varphi)
   \\
   &= \int_0^1 \dfrac{t^{q-1} + t^{q-1}}{(1+t)^{p+q}} \dt
   & (x = \dfrac{1}{1+t};\; t = \dfrac{1}{u})
   \end{align}
   $$

5. 特殊值
   $$
   \begin{align}
   & B\pqty{\dfrac{1}{2}, \dfrac{1}{2}} = \pi
   \\
   & B(s, s) = \int_0^1 \bqty{
   	\dfrac{1}{4} - \pqty{\dfrac{1}{2} - x}^2
   }^{s-1} \dx
   = \dfrac{B\pqty{\cfrac{1}{2}, s}}{2^{2n-1}}
   \end{align}
   $$

<h4>Gamma 函数 (第二类 Euler 积分)</h4>

$$
\Gamma (s) = \intoi x^{s-1} \e^{-x} \dx,\quad s \in (0, +\infty).
$$

**性质**

1. 连续性与可导性.

2. 递推公式: $ \Gamma(s+1) = s\Gamma(s) $.

3. 其它表示
   $$
   \begin{align}
   \Gamma(s) &= \intoi x^{s-1} \e^{-x} \dx
   \\
   &= 2\intoi t^{2s-1} \e^{-t^2} \dt
   \\
   &= \alpha^s \intoi t^{s-1} \e^{-\alpha t} \dt
   \end{align}
   $$

4. 定义域的延拓.

<h4>Beta 函数与 Gamma 函数的关系</h4>

**定理 15.3.1**
$$
B(p, q) = \dfrac{\Gamma(p)\Gamma(q)}{\Gamma(p+q)}.
$$
**证明**
$$
\begin{align}
\Gamma(p) \Gamma(q) &=
4 \intoi s^{2p-1} \e^{-s^2} \ds
\intoi t^{2q-1} \e^{-t^2} \dt
\\
&= 4 \iintl_{D'} r^{2(p+q)-1} \e^{-r^2} \cos^{2p-1}\theta \sin^{2q-1}\theta \drdt
\\
&= B(p, q) \Gamma(p+q).
\end{align}
$$
**定理 15.3.2 (Legendre 公式)**
$$
\Gamma(s) \Gamma\pqty{s+\frac{1}{2}}
= \dfrac{\sqrt{\pi}}{2^{2n-1}} \Gamma(2s), \quad s>0.
$$
**定理 15.3.3 (余元公式)**
$$
B(s, 1-s) = \Gamma(s) \Gamma(1-s) = \dfrac{\pi}{\sin\pi s},\quad 0<s<1.
$$
**引理 15.3.1**	设连续可积函数序列 $\Bqty{u_n(x)}$ 在区间 $\bpqty{a, b}$ 上收敛于 $u(x)$, 函数 $\varphi(x)$ 在 $\bpqty{a, b}$ 上可积, 进一步设

1. $ 0 \le u_n(x) \le \varphi(x),\quad a \le x < b,\, n = 1, 2, \cdots $.
2. 对于任意 $\ve>0$, $\Bqty{u_n(x)}$ 在 $[a, b-\ve]$ 上一致收敛.

那么极限运算与积分运算可交换, 即
$$
\nlim \int_a^b u_n(x) \dx = \int_a^b u(x) \dx.
$$

- 进一步, 将 $[a, b)$ 换成 $(a, b]$ 或 $(a, b)$ 也成立.

**引理 15.3.2**
$$
\dfrac{\pi}{\sin\pi x} = \dfrac{1}{x} + \nsum (-1)^n \pqty{
	\dfrac{1}{x+n} + \dfrac{1}{x-n}
}, \quad x \in (0, 1).
$$
**定理 15.3.4 (Stirling 公式)**	Gamma 函数有如下的渐进估计, 其中 $0<\theta<1$.
$$
\Gamma(s+1) = \sqrt{2\pi s} \pqty{\dfrac{s}{\e}}^s \e^{\tfrac{\theta}{12s}}, \quad s > 0.
$$




### 笔记

<h4>含参反常积分的例子</h4>

- **Dirichlet 积分** :star:	$ I = \dint_0^{+\infty} \dfrac{\sin{x}}{x} \dx = \dfrac{\pi}{2} $.

  - 由费曼积分法得: $ I(\alpha) = \dint_0^{+\infty} \e^{-\alpha x} \dfrac{\sin{x}}{x} \dx = \dfrac{\pi}{2} - \arctan\alpha $.
  - 由此可得: $ \sgn(x) = \dfrac{2}{\pi} \dint_0^{+\infty} \dfrac{\sin{xt}}{t} \dt $.

- $ I(x) = \intoi \e^{-t^2} \cos2xt\dt = \dfrac{\sqrt{\pi}}{2} \e^{-x^2} $. :star:

- $ I = \iintl_{\R^2} \dfrac{\dxdy}{1+x^\alpha + x^\beta} = \alpha\inv\beta\inv \Gamma(\alpha\inv)\Gamma(\beta\inv) \Gamma(1-\alpha\inv-\beta\inv) $. :star: $%例 15.3.7$

- $ I = \iiintl_{\R^3} \dfrac{\dxdydz}{1 + x^\alpha + y^\beta + z^\gamma} = \alpha\inv \beta\inv \gamma\inv \Gamma(\alpha\inv) \Gamma(\beta\inv) \Gamma(\gamma\inv) $. :star: 

- $ I = \iintl_{D} x^{m-1}y^{n-1}(1-x-y)^{p-1} \dxdy = \dfrac{\Gamma(m)\Gamma(n)\Gamma(p)}{\Gamma(m+n+p)} $. :star: :star: :star: 

  其中积分域为 $x=0,\, y=0,\, x+y=1$ 围成的区域.

  更一般的, 考虑 $ x_1^{n_1-1} \ccdots x_m^{n_m-1} $ 在 $ x_i = 0,\, \sum x_i = 1 $ 的积分.

- $ \dint_0^{\tfrac{\pi}{2}} \tan^\alpha x\dx = \dfrac{\pi}{2\cos\cfrac{\alpha\pi}{2}} $. (由贝塔函数直接得)

<h4>n 维球</h4>

- 体积
  $$
  \begin{align}
  V_n &= \int_0^R r^{n-1} \dr \prod_{i=1}^{n-1} \int_0^\pi \sin^{n-1-i} \varphi_i \dd{\varphi_i}
  = \dfrac{(\sqrt{\pi}R)^n}{\Gamma\pqty{\cfrac{n}{2} + 1}}.
  \end{align}
  $$

- 表面积
  $$
  S_n = \dv{V_n}{R} = \dfrac{
  	n\pi^{\tfrac{n}{2}} R^{n-1}
  }{
  	\Gamma\pqty{\cfrac{n}{2}+1}
  }.
  $$

<h4>积分技巧</h4>

- $ \dint_0^{\tfrac{\pi}{2}} f(\sin{x}) \dx = \dint_0^{\tfrac{\pi}{2}} f(\cos{x}) \dx = \dint_0^{\tfrac{\pi}{2}} f(\sin{2x}) \dx $.
  - $ \dint_0^{\tfrac{\pi}{2}} \ln(\sin{x}) \dx = -\dfrac{\pi\ln2}{2} $.
  - $ \int_0^1 \ln\Gamma(x)\dx = \ln\sqrt{2\pi} $.
- 交换积分次序.
  - $ \dint_0^{\tfrac{\pi}{2}} \ln\dfrac{1+a\sin{x}}{1-a\sin{x}} \dfrac{\dx}{\sin{x}} $. (转为先对 a 积分后对 x 积分, 再改变次序.)
- 分部积分.
  - $ \dint_0^1 x^y \sin\pqty{\ln\dfrac{1}{x}} \dx $. (两次分部积分)

- 费曼积分法.
- 利用相似的函数.
  - $ \dint \dfrac{\sin^2x\dx}{a^2\sin^2x+b^2\cos^2} $. 利用 $ \dint \dfrac{\cos^2x\dx}{a^2\sin^2x+b^2\cos^2} $.



### 例题

1. $ I(\alpha) = \intoi x\sin x^4 \cos \alpha x \dx $ 在 $[a, b]$ 上一致收敛.
2. 设 $f(t)$ 在 $t>0$ 上连续, 反常积分 $ \intoi t^\lambda f(t) \dt $ 在 $\lambda = a$ 和 $\lambda = b$ 时都收敛, 则 $ \intoi t^\lambda f(t) \dt $ 关于 $\lambda$ 在 $[a, b]$ 上一致收敛. :star: 
3. 设 $\intoi f(x) \dx$ 存在, 则 $f(x)$ 的 **Laplace 变换** $ F(s) = \intoi \e^{-sx} f(x) \dx $ 在 $\bpqty{0, +\infty}$ 上连续.
4. $ \nlim \intoi \e^{-x^n} \dx = 1 $.

15.2 的 9 - 15 道习题. :star: :star: :star:







## 第 16 章	Fourier 级数

### 定理

<h4>函数的 Fourier 级数展开</h4>

**Euler-Fourier 公式**	$ f(x) \sim \dfrac{a_0}{2} + \nsum (a_n\cos{nx} + b_n\sin{nx}) $.
$$
\begin{align}
a_n &= \int_{-\pi}^\pi f(x) \cos{nx} \dx, \\
b_n &= \int_{-\pi}^\pi f(x) \sin{nx} \dx.
\end{align}
$$
**Fourier 级数**, **Fourier 系数**.

**正弦级数** (奇延拓, 奇函数), **余弦级数** (偶延拓, 偶函数).

---

**任意周期的函数的 Fourier 展开**	对于周期为 $2T$ 的函数 $f(x)$, 作变换 $ x = \dfrac{T}{\pi} t $, 则有
$$
\begin{align}
f(x) &\sim \dfrac{a_0}{2} + \nsum \pqty{
	a_n \cos\dfrac{n\pi}{T} x + b_n \sin\dfrac{n\pi}{T} x
}
\\
a_n &= \dfrac{1}{T} \int_{-\pi}^\pi f(x) \cos\dfrac{n\pi}{T} x \dx
\\
b_n &= \dfrac{1}{T} \int_{-\pi}^\pi f(x) \sin\dfrac{n\pi}{T} x \dx
\end{align}
$$

---

<h4>Fourier 级数的收敛判别法</h4>

**Dirichlet 积分**	Fourier 级数的部分和为
$$
\begin{align}
S_m(x) &= \dfrac{1}{\pi} \int_{-\pi}^{\pi} f(x+u) \dfrac{
	\sin\dfrac{2m+1}{2}u
}{
	2\sin\dfrac{u}{2}
} \dd{u}
\\
&= \dfrac{1}{\pi} \int_0^\pi \bqty{
	f(x+u) + f(x-u)
} \dfrac{
	\sin\dfrac{2m+1}{2}u
}{
	2\sin\dfrac{u}{2}
} \dd{u}
\\

\end{align}
$$

记 $ \varphi_\sigma(u, x) = f(x+u) + f(x-u) - 2\sigma(x) $, 则
$$
S_m(x) - \sigma(x) = \dfrac{1}{\pi}
\int_0^\pi \varphi_\sigma(u, x) \dfrac{
	\sin\dfrac{2m+1}{2} u
}{
	2\sin\dfrac{u}{2}
} \dd{u}
$$
左式收敛于 0 等价于右式收敛于 0.

---

**定理 16.2.1 (Riemann 引理)** :star:	设函数 $\psi(x)$ 在 $[a, b]$ 上可积或绝对可积, 则成立
$$
\lim_{p \to +\infty} \int_a^b \psi(x) \sin{px} \dx
= \lim_{p \to +\infty} \int_a^b \psi(x) \cos{px} \dx = 0.
$$

- 回顾反常积分的 Cauchy 收敛原理.

**推论 16.2.1 (局部性原理)**	可积或绝对可积函数 $f(x)$ 的 Fourier 级数在 $x$ 点是否收敛只与 $f(x)$ 在 $(x-\delta, x+\delta)$ 的性质有关, 其中 $\delta$ 是任意小的正常数.

**推论 16.2.2** :star:	设函数 $\psi(u)$ 在 $[0, \delta]$ 上可积或绝对可积, 则成立
$$
\clim{m} \int_0^\delta \psi(u) \dfrac{
	\sin\dfrac{2m+1}{2} u
}{
	2\sin\dfrac{u}{2}
} \dd{u} = \clim{m} \int_0^\delta
\psi(u) \dfrac{
	\sin\dfrac{2m+1}{2} u
}{
	u
} \dd{u}.
$$

---

**Dini 条件**	$ \exist \delta > 0 $, 使得 $ \dfrac{\varphi_\sigma(u, x)}{u} = \dfrac{f(x+u) + f(x-u) - 2\sigma(x)}{u} $ 关于 $u$ 在 $[0, \delta]$ 上可积或绝对可积.

- 必要条件为 $ \sigma(x) = \dfrac{f(x+) + f(x-)}{2} $.

**定理 16.2.2** :star:	设函数 $f(x)$ 在 $[-\pi, \pi]$ 上可积或绝对可积, 且满足下列两个条件之一, 则 $f(x)$ 的 Fourier 级数在点 $x$ 处收敛于 $ \dfrac{f(x+) + f(x-)}{2} $.

1. (**Dirichlet - Jordan 判别法**)	$f(x)$ 在点 $x$ 的某个邻域 $O(x, \delta)$ 上是==分段单调有界==函数.
2. (**Dini - Lipschitz 判别法**)	$f(x)$ 在点 $x$ 处满足指数为 $\alpha \in (0, 1]$ 的 **Holder 条件**.

- 这两个条件互不包含, 即并不必要.

**定义 16.2.2 (Holder 条件)**	设点 $x$ 是函数 $f(x)$ 的连续点或第一类不连续点, 若对于充分小的正数 $\delta$, 存在常数 $L>0$ 和 $\alpha \in (0, 1]$, 使得
$$
\vqty{f(x\pm u) - f(x\pm)} < Lu^\alpha \quad (0 < u < \delta),
$$
则称 $f(x)$ 在点 $x$ 处满足指数为 $\alpha \in (0, 1]$ 的 **Holeder 条件** (当 $\alpha = 1$ 时也称为 **Lipschitz 条件**).

**定理 16.2.3 (Dirichlet 引理)** :star:	设函数 $\psi(u)$ 在 $[0, \delta]$ 上单调, 则成立
$$
\lim_{p \to +\infty} \int_0^\delta \dfrac{
	\psi(u) - \psi(0+)
}{u} \sin pu \dd{u} = 0.
\\
\lim_{p \to +\infty} \int_0^\delta \psi(u) \dfrac{\sin{pu}}{u} \dd{u} = \dfrac{\pi}{2} \psi(0+).
$$

- 第二个等价的式子是由 Dirichlet 积分得来的.

**推论 16.2.3** :star:	若 $f(x)$ 在 $[-\pi, \pi]$ 上可积或绝对可积, 在点 $x$ 处两个单侧导数 $ f'_+(x) $ 和 $f'_-(x)$ 都存在, 或更进一步, 只要两个 **拟单侧导数**
$$
\lim_{h\to0+} \dfrac{
	f(x \pm h) - f(x \pm)
}{h}
$$
存在, 则 $f(x)$ 的 Fourier 级数在 $x$ 点处收敛于 $ \dfrac{f(x+) + f(x-)}{2} $.

- 由可导条件强于 Lipschitz 条件即得.

---

<h4>Fourier 级数的分析性质</h4>

假定 $f(x)$ 的周期为 $2\pi$.

**定理 16.3.1** :star:	设 $f(x)$ 在 $[-\pi, \pi]$ 上可积或绝对可积, 则对于 $f(x)$ 的 Fourier 系数 $a_n$ 和 $b_n$, 有
$$
\nlim a_n = \nlim b_n = 0.
$$

- 由 Riemann 引理即得.

**定理 16.3.2 (Fourier 级数的逐项积分定理)** :star:	设 $f(x)$ 在 $[-\pi, \pi]$ 上可积或绝对可积, 则
$$
f(x) \sim \dfrac{a_0}{2} + \nsum \pqty{
	a_n \cos{nx} + b_n \sin{nx}
},
$$
则 $f(x)$ 的 Fourier 级数可以逐项积分, 即对于任意的 $ c, x, \in [-\pi, \pi] $,
$$
\int_c^x f(t) \dt = \int_c^x \dfrac{a_0}{2} \dt + \nsum \int_c^x \pqty{
	a_n \cos{nt} + b_n\sin{nt}
}\dt.
$$

- 可以有无穷个第一类间断点.
- 即使 $f(x)$ 的 Fourier 级数不表示 $f(x)$, 甚至不收敛, 也可以使用这个定理. :crescent_moon: 

**推论** :star:	$ \dfrac{a_0}{2} + \nsum (a_n\cos{nx} + b_n\sin{nx}) $ 是某个在 $[-\pi, \pi]$ 上可积或绝对可积函数的 Fourier 级数的必要条件是 $\nsum \dfrac{b_n}{n}$ 收敛.

- $\dsum_{n=2}^\infty \dfrac{\sin{nx}}{\ln{n}}$ 是点点收敛的, 但是 $\dsum_{n=2}^\infty \dfrac{1}{n\ln{n}}$ 发散, 故它不可能是某个可积或绝对可积函数的 Fourier 级数. :crescent_moon:

**定理 16.3.3 (Fourier 级数的逐项微分定理)**	设 $f(x)$ 在 $[-\pi, \pi]$ 上连续,
$$
f(x) \sim \dfrac{a_0}{2} + \nsum \pqty{
	a_n \cos{nx} + b_n \sin{nx}
},
$$
$ f(-\pi) = f(\pi) $, 且除了有限个点外 $f(x)$ 可导. 进一步假设 $f'(x)$ 在 $[-\pi, \pi]$ 上可积或绝对可积 (可以在有限个点无定义). 则
$$
f'(x) \sim
%\dv{x} \pqty{\dfrac{a_0}{2}} + \nsum \dv{x} \pqty{a_n \cos nx + b_n \sin nx} =
\nsum (-a_n n\sin nx + b_n n \cos nx).
$$

---

<h4>Fourier 级数的逼近性质</h4>

**定义 16.3.1**	设 $S$ 是一个定义了内积运算 $(\cdot, \cdot)$ 的线性空间, 取 $S$ 中的范数为
$$
\norm{\cdot} = \sqrt{(\cdot, \cdot)},
$$
$T$ 是 $S$ 的一个 $n$ 维子空间, 记 $T$ 的一组正交基为 $\soneto{\varphi}{n}$, 即
$$
T = \span \Bqty{\soneto{\varphi}{n}},
$$
若对于 $x \in S$, 有 $x_{_T} = c_1 \varphi_1 + c_2 \varphi_2 + \cdots + c_n \varphi_n \in T$, 使得
$$
\norm{{x - x_{_T}}} = \min_{y \in T} \norm{x-y}.
$$
则称 $x_{_T}$ 是 $x$ 在 $T$ 中的 **最佳平方逼近元**.

**引理 16.3.1** :star:	在上述假定下

1. $\forall x \in S$, $x$ 在 $T$ 中的最佳平方逼近元素 $x_{_T}$ 存在且唯一.

2. $x_{_T} \in T$ 是 $x$ 在 $T$ 中的最佳平方逼近元素的充要条件是 $ (x - x_{_T}) \perp T $, 即 $ (x-x_{_T}, \varphi_k) = 0,\, k = \oneton $, 或者等价地, $x_{_T}$ 的组合系数为
   $$
   c_k = \dfrac{(x, \varphi_k)}{(\varphi_k, \varphi_k)},\quad k = \oneton.
   $$

3. 最佳平方逼近的余项满足估计式
   $$
   \norm{x-x_{_T}}^2 = \norm{x}^2 - \norm{x_{_T}}^2
   = \norm{x}^2 - \sum_{k=1}^n c_k^2 \norm{\varphi_k}^2.
   $$

---

取 $S$ 为 $[-\pi, \pi]$ 上可积或平方可积的函数全体, 定义
$$
(f, g) := \dfrac{1}{\pi} \int_{-\pi}^{\pi} f(x) g(x) \dx,
\\
\norm{f} = \sqrt{(f, f)}.
$$
记 $T$ 为 **n 阶三角多项式** $ \dfrac{A_0}{2} + \dsum_{k=1}^n (A_k \cos{kx} + B_k \sin{kx}) $ 的全体, 则
$$
T = \span\Bqty{
	1, \cos x, \sin x, \cos 2x, \sin 2x, \cdots, \cos nx, \sin nx
}.
$$
于是有
$$
\norm{1}^2 = 2,\quad \norm{\cos kx} = \norm{\sin kx} = 1.
$$

$$
\begin{align}
(f, \cos kx) &= \dfrac{1}{\pi} \int_{-\pi}^\pi f(x) \cos{kx} \dx = a_k,
\\
(f, \sin kx) &= \dfrac{1}{\pi} \int_{-\pi}^\pi f(x) \sin{kx} \dx = b_k.
\end{align}
$$

****

**定理 16.3.4 (Fourier 级数的平方逼近性质)**	设 $f(x)$ 在 $[-\pi, \pi]$ 上可积或平方可积, 则 $f(x)$ 在 $T$ 中的最佳平方逼近元素恰为 $f(x)$ 的 Fourier 级数的部分和函数
$$
S_n(x) = \dfrac{a_0}{2} + \sum_{k=1}^n \pqty{
	a_k \cos kx + b_k \sin kx
},
$$
逼近的余项为
$$
\norm{f - S_n}^2 = \dfrac{1}{\pi} \int_{-\pi}^\pi f^2(x) \dx - \bqty{
	\dfrac{a_0^2}{2} + \knsum (a_k^2 + b_k^2)
}.
$$

- 在余项中令 $n \to \infty$, 即得到

**推论 16.3.2 (Bessel 不等式)**	设 $f(x)$ 在 $[-\pi, \pi]$ 上可积或平方可积, 则 $f(x)$ 的 Fourier 系数满足不等式
$$
\dfrac{a_0^2}{2} + \sum_{k=1}^\infty (a_k^2 + b_k^2)
\le \dfrac{1}{\pi} \int_{-\pi}^{\pi} f^2(x) \dx.
$$
**定理 16.3.5 (Parseval 等式)** :star:	设 $f(x)$ 在 $[-\pi, \pi]$ 上可积或平方可积, 则成立等式
$$
\dfrac{a_0^2}{2} + \sum_{k=1}^\infty (a_k^2 + b_k^2)
=\dfrac{1}{\pi} \int_{-\pi}^{\pi} f^2(x) \dx.
$$
**定义 16.3.2**	若函数序列 $\Bqty{\psi_n(x)}$ 满足
$$
\nlim \norm{f(x) - \psi_n(x)}^2 = 0,
$$
这里 $f(x)$ 是某一个固定函数, 则称 $\Bqty{\psi_n(x)}$ 按范数 $\norm{\cdot}$ **平方收敛于** $f(x)$.

**推论 16.3.3 (Fourier 级数的平方收敛性质)** :star:	设 $f(x)$ 在 $[-\pi, \pi]$ 上可积或平方可积, 则 $f(x)$ 的 Fourier 级数的部分和函数序列平方收敛于 $f(x)$.

**定理 16.3.6 (Weierstrass 第二逼近定理)** :star:	对周期为 $2\pi$ 的任意一个连续函数 $f(x)$, 都存在三角多项式序列
$$
\Bqty{
	\psi_n(x) = \dfrac{A_0}{2} + \knsum (A_k \cos kx + B_k \sin kx)
},
$$
使得 $\Bqty{\psi_n(x)}$ ==一致收敛==于 $f(x)$.

---

<h4>等周问题</h4>

**定理 16.3.7**	平面上具有定长的所有简单闭曲线中, 圆周所围的面积最大,. 换言之, 若 $L$ 是平面上简单闭曲线 $C$ 的长度, $A$ 是曲线 $C$ 的面积, 则
$$
A \le \dfrac{L^2}{4\pi},
$$
且当且仅当 $C$ 为圆周时取等.

**引理 16.3.2 (Wirtinger)**	设 $f(x)$ 在 $[-\pi, \pi]$ 上连续, $f(-\pi) = f(\pi)$, $ \dint_{-\pi}^\pi f(x) \dx = 0 $, 且除了有限个点外 $f(x)$ 可导, 但在不可导点的单侧导数存在.进一步假设 $f'(x)$ 在 $[-\pi, \pi]$ 上可积或平方可积, 则
$$
\dint_{-\pi}^\pi f^2(x) \dx \le \int_{-\pi}^\pi f'^2(x) \dx,
$$
等号成立当且仅当 $f(x) = a\cos x + b\sin x$.

---

<h4>Fourier 变换和 Fourier 积分</h4>

$$
\begin{align}
f_{_T}(x) &\sim \dfrac{a_0}{2} + \nsum (a_n \cos\omega_n x + b_n \sin\omega_n x)
\\
&= \dfrac{a_0}{2} + \nsum \pqty{
	\dfrac{a_n - \i b_n}{2} \e^{\i\omega_n x} +
	\dfrac{a_n + \i b_n}{2} \e^{-\i\omega_n x}
} \\
c_n &= a_n - \i b_n = \dfrac{1}{T} \dint_{-T}^T f_{_T}(t) \e^{-\i\omega_n t} \dt
\\
c_{-n} &= a_n + \i b_n = \overline{c}_n
\\
f_{_T}(x) &\sim \dfrac{c_0}{2} + \dfrac{1}{2} \nsum (c_n \e^{\i\omega_n x} + c_{-n} \e^{-\i\omega_nx})
\\
&\sim \dfrac{1}{2} \sum_{n=-\infty}^{+\infty} c_n \e^{\i\omega_n x}
\quad (\textbf{Fourier 级数的复数形式})
\\
&\sim \dfrac{1}{2T} \sum_{n=-\infty}^{+\infty} \bqty{
	\dint_{-T}^T f_{_T}(t) \e^{-\i\omega_n t} \dt
} \e^{\i\omega_n x}
\\
\Delta\omega &:= \omega_n - \omega_{n-1} = \dfrac{\pi}{T}
\\
\varphi_{_T} &:= \dfrac{\e^{\i\omega x}}{2\pi} \int_{-T}^T f(t) \e^{-\i\omega t} \dt
\\
f(x) &= \lim_{T\to +\infty} f_{_T}(x)
\sim \lim_{\Delta\omega \to 0} \sum_{n=-\infty}^{+\infty} \varphi_{_T}(\omega_n) \Delta\omega
\\
&\sim \dfrac{1}{2\pi} \inti \bqty{
	\inti f(t) \e^{-\i\omega t} \dt
} \e^{\i\omega x} \dd{\omega}
\\
&\sim \dfrac{1}{2\pi} \inti \dd{\omega} \inti f(t) \e^{\i\omega(x-t)} \dt
\quad (f\ 的\textbf{ Fourier 积分})
\\
F[f](\omega) &:= \hat{f}(\omega)
:= \inti f(x) \e^{-\i\omega x} \dx
\quad (f\ 的\textbf{ Fourier 变换 }(或 \textbf{像函数}))
\\
F\inv[\hat{f}\,](x) &:= \dfrac{1}{2\pi} \inti \hat{f}(\omega) \e^{\i\omega x} \dd{\omega}
\quad (\hat{f}\ 的\textbf{ Fourier 逆变换 }(或 \textbf{像原函数}))
\end{align}
$$

**定理 16.4.1** :star:	设函数 $f$ 在 $(-\infty, +\infty)$ 上==绝对可积==, 且在 $(-\infty, +\infty)$ 中的任何闭区间上==分段可导==, 则 $f$ 的 Fourier 积分满足: 对于任意 $ x \in (-\infty, +\infty) $ 成立
$$
\dfrac{1}{2\pi} \inti \dd{\omega} \inti f(t) \e^{\i\omega(x-t)} \dt
= \dfrac{f(x+) + f(x-)}{2}.
$$
**Fourier 积分的三角形式** (**实形式**)
$$
f(x) = \dfrac{1}{\pi} \intoi \dd{\omega} \inti f(t) \cos \omega(x-t) \dt
\quad (\text{注意积分限})
$$
偶函数可以看成 **Fourier 余弦变换** 及其逆变换复合而成
$$
\begin{align}
& F_c[f] = \hat{f}_c (\omega) = \intoi f(x) \cos\omega x \dx
\\
& F_c\inv [\hat{f}_c] = \dfrac{2}{\pi} \intoi \hat{f}_c (\omega) \cos\omega x \dd{\omega}
\end{align}
$$
<span style='background-color: #eeeeee; color: #777777'>Fourier 余弦变换为什么没有系数 2, 而是移至其逆变换?</span> :confused:

奇函数可以看成 **Fourier 正弦变换** 及其逆变换复合而成
$$
\begin{align}
& F_s[f] = \hat{f}_s (\omega) = \intoi f(x) \sin\omega x \dx
\\
& F_s\inv [\hat{f}_s] = \dfrac{2}{\pi} \intoi \hat{f}_s (\omega) \sin\omega x \dd{\omega}
\end{align}
$$

---

<h4>Fourier 变换的性质</h4>

1. **线性性质**

   若 $f,\, g$ 的 Fourier 变换及其逆变换存在, 则
   $$
   F[c_1 f + c_2 g] = c_1 F[f] + c_2 F[g]
   \\
   F\inv[c_1 \hat{f} + c_2 \hat g] = c_1 F\inv[\hat f] + c_2 F\inv[\hat g]
   $$

2. **位移性质**

   若 $f$ 的 Fourier 变换及其逆变换存在, 则
   $$
   \begin{array}{l|l}
   F[f(x\pm x_0)](\omega) = F[f](\omega) \e^{\pm \i\omega x_0}
   & F[f(x\pm x_0)] = F[f] \e^{\pm \i\omega x_0}
   \\
   F\inv [\hat f (\omega \pm \omega_0)](x) = F\inv [\hat f](x) \e^{\mp \i\omega x}
   \quad\space
   & F\inv [\hat f (\omega \pm \omega_0)] = F\inv [\hat f] \e^{\mp \i\omega x}
   \end{array}
   $$

3. **时间尺度性** $F[f(ax)] = \dfrac{1}{\vqty{a}} \hat f\pqty{\dfrac{\omega}{a}}$.

4. **频率尺度性** $ F\bqty{\dfrac{1}{a} f\pqty{\dfrac{x}{a}}} = \hat f(a\omega) $ $(a>0)$.

5. **微分性质**

   1. 若 $f(x)$ 在 $(-\infty, +\infty)$ 上有==连续的导数==, 且 $f(x)$ 和 $f'(x)$ 在 $(-\infty, +\infty)$ 上==绝对可积==, 若 $\clim{x} f(x) = 0$, 则由分部积分得
      $$
      F[f'] = \i\omega \cdot F[f].
      $$

   2. 若 $f(x)$ 和 $xf(x)$ 在 $(-\infty, +\infty)$ 上==绝对可积==, 则
      $$
      F[-\i x \cdot f] = (F[f])'.
      $$

6. **积分性质**

   若 $f(x)$ 和 $\dint_{-\infty}^x f(x)\dt$ 在 $(-\infty, +\infty)$ 上==绝对可积==, 则由微分性质得
   $$
   F\bqty{
   	\int_{-\infty}^x f(t) \dt
   } = \dfrac{F[f]}{\i\omega}.
   $$

---

<h4>卷积</h4>

**定义 16.4.2**	设函数 $f$ 和 $g$ 在 $\R$ 上有定义, 且积分
$$
(f*g)(x) = \inti f(t) g(x-t) \dt
$$
存在, 则称函数 $f*g$ 为 $f$ 和 $g$ 的卷积.

- 卷积具有==对称性==, 即 $ f*g = g*f $.

**定理 16.4.2 (卷积的 Fourier 变换)** :star:	设函数 $f$ 和 $g$ 在 $(-\infty, +\infty)$ 上绝对可积, 则有
$$
F[f*g] = F[f] \cdot F[g].
\\
F\inv[F[f] \cdot F[g]] = f * g.
$$
**定理 16.4.3 (Parseval 等式)** :star:	设函数 $f$ 在 $(-\infty, +\infty)$ 上绝对可积, 且 $ \inti [f(x)]^2 \dx $ 收敛. 记 $f$ 的 Fourier 变换为 $\hat f$, 则
$$
\inti [f(x)]^2 \dx = \dfrac{1}{2\pi} \inti \vqty{\hat f(\omega)}^2 \dd{\omega}.
$$

---

<h4>Fourier 变换的解释</h4>

$$
f(x) \sim \dfrac{a_0}{2} + \nsum (a_n \cos n\omega x + b_n \sin x\omega x)
= \dfrac{1}{2} \sum_{n=-\infty}^{+\infty} c_n \e^{\i n\omega x}
$$

Fourier 级数说明 $f(x)$ 可以通过频率为 $\omega$ (**基频**) 的正弦波 $\sin\omega x$ 和 $\cos\omega x$ (基波) 及其 $n$ 次**谐波** $\sin n\omega x, \, \cos x\omega x$ 叠加而得. **谐频** 为 $n\omega$ 的谐波的振幅为
$$
\sqrt{a_n^2 + b_n^2} = \vqty{c_n} = \dfrac{1}{T} \vqty{
	\int_{-T}^T f(x) \e^{-\i n\omega x} \dx
}
$$

---

<h4>离散 Fourier 变换</h4>

:star: 
$$
\begin{align}
& X(j) = \sum_{n=0}^{N-1} x(n) \e^{-2\pi\i \tfrac{nj}{N}}
\\
& \dfrac{1}{N} \sum_{n=0}^{N-1} \e^{-2\pi\i\tfrac{nj}{N}} \e^{2\pi\i\tfrac{nk}{N}} = \delta_{j, k} = \begin{cases}
	1, & j=k, \\
	0, & j \ne k.
\end{cases}
\\
& x(k) = \dfrac{1}{N} \sum_{j=0}^{N-1} X(j) \e^{2\pi\i\tfrac{jk}{N}}
\end{align}
$$

解释

1. 变换后的每个 $X(j)$ 都包含了原序列中所有信号的信息, 因此即使丢失了部分 $X(j)$, 仍可能从其它数据大致还原初始数据.
2. 可以剔除模较小的数据, 从而使需传输的序列大为缩短. 即易于作高校的压缩处理.

<h4>快速 Fourier 变换 (FFT)</h4>

**单位根**

1. 消去引理: $ \omega_{dn}^{dk} = \omega_n^k $.
2. 折半引理: $ (\omega_n^{k+\tfrac{n}{2}})^2 = \omega_{\frac{n}{2}}^k $.
3. 求和引理: $ \dsum_{i=0}^{n-1} (\omega_n^k)^i = 0 $.

**多项式**

- 次数界: 即任何一个大于多项式次数的整数.

- 系数表示 $ \bm a = [a_0, \soneto{a}{n}]\trans $.

  - 加法 $O(n)$: $c_i = a_i + b_i$.

  - 乘法 $O(n^2)$: $\bm c = \bm a \otimes \bm b$.

  - 求值  $O(n)$: 霍纳法则 (秦九韶算法)
    $$
    A(x) = (\cdots((a_nx + a_{n-1})x + a_{n-2})x + \cdots a_1)x + a_0.
    $$

- 点值表示 $ \Bqty{(x_0, A(x_0)), (x_1, A(x_1)), \cdots, (x_n, A(x_n))} $.

  - 加法 $O(n)$: $C(x_i) = A(x_i) + B(x_i)$.
  - 乘法 $O(n)$: $C(x_i) = A(x_i) B(x_i)$.
  - 插值 $O(n^2)$: $ A(x) = \dsum_{i=0}^n A(x_i) \dfrac{\prod_{j \ne i} (x-x_j)}{\prod_{j \ne i}(x_i-x_j)} $.

**离散傅里叶变换 (DFT, Discret Fourier Transform)**
$$
\begin{align}
& A(x) = \sum_{i=0}^{n-1} a_i x^i
\\
& y_i = A(\omega_n^i) = \sum_{j=0}^{n-1} \omega_n^{ij} a_j
\\
& \bm y = \mathrm{DFT}_n (\bm a) = \mathcal{F} \bm a
\quad (O(n^2))
\end{align}
$$
**快速傅里叶变换 (FFT, Fast Fourier Transform)**
$$
\begin{align}
A(x) &= a_0 + a_1 x + a_2 x^2 + \cdots + a_{n-1} x^{n-1}
\\
A^{[0]}(x^2) &= a_0 + a_2 x^2 + a_4 x^4 + \cdots + a_{n-2} x^{n-2}
\\
A^{[1]}(x^2) &= a_1 + a_3 x^2 + a_5 x^4 + \cdots + a_{n-1} x^{n-2}
\\
A(x) &= A^{[0]}(x^2) + x A^{[1]}(x^2)
\end{align}
$$

$$
\begin{cases}
	A(\omega_n^k) = A^{[0]}(\omega_{\frac{n}{2}}^k) + \omega_n^k A^{[1]} (\omega_{\frac{n}{2}}^k)
	\\
	A(\omega_n^{k + \frac{n}{2}}) = A^{[0]}(\omega_{\frac{n}{2}}^k) - \omega_n^k A^{[1]} (\omega_{\frac{n}{2}}^k)
\end{cases}
$$

$$
\mathrm{DFT}_n(\bm a) \to \begin{cases}
	\mathrm{DFT}_{\frac{n}{2}} (\bm a^{[0]}) \\
	\mathrm{DFT}_{\frac{n}{2}} (\bm a^{[1]})
\end{cases} \to \cdots
\\
T(n) = 2 T\pqty{\dfrac{n}{2}} + O(n) = O(n\log{n}) < O(n^2)
$$

**递归时下标的规律**
$$
\begin{array}{cccccccc}
	0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 \\
	000 & 100 & 010 & 110 & 001 & 101 & 011 & 111
\end{array}
$$

1. 位逆序置换.
2. 偶数位的首位为 0, 奇数位的首位为 1.
3. 每两个数除首位外均相同.
4. 每两个数除首位外是上一级子问题的解.
5. 前一半数除末位外是上一级子问题的解.

**快速傅里叶逆变换 (IFFT, Inverse Fast Fourier Transform)**

离散傅里叶变换 $ y_i = \dsum_{j=0}^{n-1} \omega_n^{ij} a_j $ 的系数矩阵为范德蒙德矩阵 $ (\bm V_n)_{ij} = \omega_n^{ij} $, 逆矩阵为 $ (\bm V_n)_{ij} = \dfrac{\omega_n^{-ij}}{n} $, 故
$$
a_i = \dfrac{1}{n} \sum_{j=0}^{n-1} \omega_n^{-ij} y_j
$$
**FFT 求卷积 $ \bm a \otimes \bm b $**

1. 求傅里叶变换 (将系数表示转化为点值表示) $O(n\log n)$.

   即求出 $ \mathrm{DFT}_{2n}(\bm a),\, \mathrm{DFT}_{2n}(\bm b) $.

2. 计算普通乘法 $O(n)$.

   $ \mathrm{DFT}_{2n}(\bm a) \circ \mathrm{DFT}_{2n}(\bm b) $.

3. 求逆傅里叶变换 (将点值表示转化为系数表示) $O(n\log n)$.
   $$
   \bm a \otimes \bm b = \mathrm{IDFT}_{2n} \pqty{
   	\mathrm{DFT}_{2n} (\bm a) \circ
   	\mathrm{DFT}_{2n} (\bm b)
   }.
   $$

- 长度应扩大的 2 的幂次, 且输入的长度应扩大 1 倍.

<h6>递归的方式</h6>

```cpp
// 基本思路, 仅作演示, 具体可见下一部分
void FFT(Complex *a, int lim) {
    if (lim == 1) return;
    Complex a0[lim >> 1], a1[lim >> 1];
    for (int i = 0; i < lim; i += 2)
        a0[i >> 1] = a[i], a1[i >> 2] = a[i + 1];
    FFT(a0, lim >> 1);
    FFT(a1, lim >> 1);
    Complex wn = Complex(cos(2.0 * PI / lim), sin(2.0 * PI / lim));
    Complex w = Complex(1, 0);
    for (int k = 0; k < (lim >> 1); ++k) {
        a[k] = a0[k] + w * a1[k];
        a[k + (lim >> 1)] = a0[k] - w * a1[k];
        w = w * wn;
    } // 合并
} // 递归的方式
```

<h6>迭代的方式</h6>

```cpp
#include <bits/stdc++.h>			// "万能" 头文件
using namespace std;

int maxn = 2000010;					// 能够处理的向量的最大长度
const double PI = acos(-1);
int rev[maxn], len = 0, lim = 1;	// rev 为 BitReverse 的次序 (通用)
									// lim 为傅里叶变换的向量长度 (2 的幂次)
									// len 为长度的维数

// 定义复数及其运算, 也可以使用 class
typedef struct Complex {
    double r, i;
    Complex { r = 0, i = 0; }
    Complex(double real, double imag): r(real), i(imag) {}
}Complex;
Complex operator + (Complex a, Complex b) {
    return Complex(a.r + b.r, a.i + b.i);
}
Complex operator - (Complex a, Complex b) {
    return Complex(a.r - b.r, a.i - b.i);
}
Complex operator * (Complex a, Complex b) {
    return Complex(a.r * b.r - a.i * b.i, a.r * b.i + a.i * b.r);
}

// 快速傅里叶变换 FFT 及其逆变换 IFFT
// opt 为 1 则进行傅里叶变换, 为 -1 则进行逆变换
void FFT(Complex *a, int opt) {
    for (int i = 0; i < lim; ++i)
        if (i < rev[i]) swap(a[i], a[rev[i]]);	// 按 rev 数组排序 (BitReverse), 判断大小是为了只交换一次
    int maxDep = log2(lim);		// 也就是 len, 这一步可以修改为不需要全局变量 lim, 直接传入参数 int len = 0
    for (int dep = 1; dep <= maxDep; ++dep) {
        int m = 1 << dep;
        Complex wn = Complex(cos(2.0 * PI / m), opt * sin(2.0 * PI / m));	// m 次单位根
        for (int k = 0; k < lim; k += m) {
            Complex w = Complex(1, 0);		// 旋转因子, 初始为 1
            for (int j = 0; j < m / 2; ++j) {
                Complex t = w * a[k + j + m / 2];	// 蝴蝶操作, 简化运算
                Complex u = a[k + j];
                a[k + j] = u + t;			// FFT 的具体算法
                a[k + j + m / 2] = u - t;
                w = w * wn;		// 更新旋转因子
            }
        }
    }
    if (opt == -1)		// 即离散傅里叶逆变换
        for (int i = 0; i < lim; ++i)
            a[i].r /= lim;		// 逆变换由系数 n, 即 lim. 虚部为零, 故只需对实部操作, 且结果应为整数
} // FFT(Complex *a, int opt)

// 求卷积的实例, 对多项式系数向量 F 和 G 求卷积并保存至 F (算完之后 G 也进行了傅里叶变换)
int main() {
    int n, m; scanf("%d %d", &n, &m);	// 待求卷积的多项式次数
    Complex F[nmax], G[nmax];	// 待求卷积的两向量 (多项式)
    for (int i = 0; i <= n; ++i) scanf("%d", &F[i].r);
    for (int i = 0; i <= m; ++i) scanf("%d", &G[i].r);
	while (lim <= n+m) lim <<= 1, ++len;	// 长度扩大到 2 的幂次
    for (int i = 0; i < lim; ++i) rev[i] = rev[i >> 1] | ((i & 1) << (len - 1));	// 重新排列 BitReverse
    FFT(F, 1); FFT(G, 1);	// 对两向量进行离散傅里叶变换
    for (int i = 0; i <= m; ++i) F[i] *= G[i];	// 向量点乘后存储至 F 数组
    FFT(F, -1);		// 对上式结果进行离散傅里叶逆变换
    for (int i = 0; i <= n + m; ++i)
        printf("%d", (int)(F[i].r + 0.5));	// 离散傅里叶变换处理的对象时整数, 这里是消除误差后输出
    return 0;
}
```

**注意**

- 快速傅里叶变换的部分参考了[鹤翔万里的视频](https://www.bilibili.com/video/BV1Y7411W73U/?spm_id_from=333.1007.top_right_bar_window_history.content.click&vd_source=cc171ffacaec079f01b2a965fd3825f7). 源代码网页现已打不开, 不过从视频中看, len 未赋初值, 现已加上.
- 在离散傅里叶变换的公式中, 有些资料中自然对数的指数是正的, 有些却是负的, 实际上我的笔记中两种兼有. 两种写法都是对的, 只要与逆变换中的相反就星, 原因在于虚数单位的定义: $ \i^2 = -1 $, 或者形式上的 $\i = \pm \sqrt{-1}$. 符号是正是负, 只不过影响了虚轴的朝向, 算法的正确性由范德蒙德矩阵求逆所保证.




### 笔记

<h4>Fourier 展开</h4>

**方波**
$$
\begin{align}
f(x) &= \begin{cases}
	1, & x \in [-\pi, 0), \\
	0, & x \in[0, \pi).
\end{cases}
\\
&\sim \dfrac{1}{2} - \dfrac{2}{\pi} \pqty{
	\sin{x} + \dfrac{\sin3x}{3} + \dfrac{\sin5x}{5} + \cdots + \dfrac{\sin(2k+1)x}{2k+1} + \cdots
}.
\end{align}
$$
**锯齿波**
$$
\begin{align}
f(x) &= \begin{cases}
	-x, & -\pi \le x < 0, \\
	x, & 0 \le x < \pi.
\end{cases}
\\
&= \dfrac{\pi}{2} - \dfrac{4}{\pi} \pqty{
	\cos{x} + \dfrac{\cos3x}{3^2} + \dfrac{\cos5x}{5^2} + \cdots + \dfrac{\cos(2k+1)x}{(2k+1)^2} + \cdots
}.
\end{align}
$$
**三角波**
$$
\begin{align}
f(x) &= x \quad (-\pi < x \le \pi)
\\
&= 2 \pqty{
	\sin x - \dfrac{\sin2x}{2} + \dfrac{\sin3x}{3} - \cdots + (-1))^{n+1} \dfrac{\sin{nx}}{n} + \cdots
}.
\end{align}
$$
**半波整流**
$$
\begin{align}
f(t) &= \dfrac{A}{2} (\sin t + \vqty{\sin t})
\\
&= \dfrac{A}{\pi} + \dfrac{A}{2} \sin{x} - \dfrac{2A}{\pi} \sum_{k=1}^\infty \dfrac{\cos{2kx}}{4k^2-1}.
\end{align}
$$
**全波整流**
$$
\begin{align}
f(t) &= A\vqty{\sin t}
\\
&= \dfrac{2A}{\pi} - \dfrac{4A}{\pi} \sum_{k=1}^\infty \dfrac{\cos{2kx}}{4k^2-1}.
\end{align}
$$

---

<h4>三角函数求和公式</h4>

推了无数遍, 却总也记不住 (下次一定).
$$
\begin{align}
\sum_{k=1}^n \cos(ak+b) &= \dfrac{
	\sin\pqty{an + \dfrac{a}{2} + b} - \sin\pqty{\dfrac{a}{2} + b}
}{2\sin\dfrac{a}{2}}
\\
\sum_{k=1}^n \sin(ak+b) &= \dfrac{
	\cos\pqty{an + \dfrac{a}{2} + b} - \cos\pqty{\dfrac{a}{2} + b}
}{2\sin\dfrac{a}{2}}
\end{align}
$$

- $\cos{x}$ 全部零点的倒数平方和恰为 $1$.

<h4>求解微分方程</h4>

利用 $F[u''] = \i\omega F[u'] = -\omega^2 F[u]$,

对于 $ u''(x) - a^2 u(x) + 2a f(x) = 0\quad (a>0) $,

两边作 Fourier 变换, 得 $ F[u] = \dfrac{2a}{a^2 + \omega^2} F[f] $,

而 $ F\bqty{\e^{-a\vqty{x}}} = \dfrac{2a}{a^2+\omega^2}\; (a>0) $, 故
$$
\begin{align}
u(x) &= F\inv \bqty{
	\dfrac{2a}{a^2+\omega^2} \cdot F[f]
} = f * \e^{-a\vqty{x}}
= \inti f(t) \e^{-a\vqty{x-t}} \dt.
\end{align}
$$

