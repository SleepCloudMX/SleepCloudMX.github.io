**充分性** $ \RA $	下证 Poisson 过程 $ \Bqty{N(t), t \ge 0} $ 满足 $ \Bqty{X_n, n \ge 1} $ 独立同分布 $ E(\lambda) $.

---

**a.1**	求 $ (\soneto{S}{n}) $ 的联合概率密度.

令 $ t_1 < t_2 < \cdots < t_n $ 并取充分小的 $ h > 0 $ 使得
$$
% 设置
\newcommand{\aneg}[1]{\hspace{-0.75em}&#1&\hspace{-0.75em}}
\newcommand{\aneq}{\aneg{=}}
% 上述指令用于在使用 array 环境时调整等号左右间距
\newcommand{\eqs}{\quad\;}
% 上述指令用于 align 环境中, &= 的换行对齐时调整第二行位置
\renewcommand{\d}{\displaystyle}

% 字符
\renewcommand{\i}{\mathrm{i}}
\renewcommand{\j}{\mathrm{j}}
\renewcommand{\k}{\mathrm{k}}
\newcommand{\e}{\textup{e}}
\newcommand{\ve}{\varepsilon}
\newcommand{\Beta}{\mathit{B}}
\newcommand{\omicron}{\mathit{o}}
\newcommand{\Omicron}{\mathit{O}}

% 原本的定义为:
% \newcommand{\cal}[1]{\mathcal{#1}}
\newcommand{\bm}[1]{\boldsymbol{#1}}
\renewcommand{\cal}[1]{\mathcal#1}
\renewcommand{\scr}[1]{\mathscr#1}
\renewcommand{\frak}[1]{\mathfrak#1}
\newcommand{\bb}[1]{\mathbb#1}

% 数集
\newcommand{\D}{\mathbb{D}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\J}{\mathbb{J}}
\newcommand{\K}{\mathbb{K}}
\renewcommand{\L}{\mathbb{L}}

% 上下标
\newcommand{\trans}{^\mathrm{T}}
\newcommand{\inv}{^{-1}}
\newcommand{\madj}[1]{^{\pqty{#1^*}}}	% m 重伴随矩阵
\newcommand{\adj}{^*}
\newcommand{\vector}[1]{\overrightarrow{#1}}
\newcommand{\wavy}[1]{\overset\sim#1}	% \tilde 或 \widetilde 不明显, 容易与 \bar 或 \overline 混淆

% 序列
\newcommand{\ccdots}{\cdot\cdots\cdot}
\newcommand{\oneton}{1,2,\cdots,n}
\newcommand{\oneto}[1]{1,2,\cdots,#1}

\newcommand{\ssto}[3]{#1_1 #3 #1_2 #3 \cdots #3 #1_{#2}}
\newcommand{\ssup}[3]{#1^1 #3 #1^2 #3 \cdots #3 #1^{#2}}
\newcommand{\soneto}[2]{\ssto{#1}{#2}{,}}
\newcommand{\splus}[2]{\ssto{#1}{#2}{+}}

% 括号
\newcommand{\aqty}[1]{\expval{#1}}
\newcommand{\pbqty}[1]{\left(#1\right]}
\newcommand{\bpqty}[1]{\left[#1\right)}
\newcommand{\floor}[1]{\left\lfloor#1\right\rfloor}
\newcommand{\ceil}[1]{\left\lceil#1\right\rceil}

% 矩阵宏简写
\newcommand{\bmatrix}[1]{\begin{bmatrix}#1\end{bmatrix}}
\newcommand{\Bmatrix}[1]{\begin{Bmatrix}#1\end{Bmatrix}}
\newcommand{\vmatrix}[1]{\begin{vmatrix}#1\end{vmatrix}}
\newcommand{\Vmatrix}[1]{\begin{Vmatrix}#1\end{Vmatrix}}

% 常用微分
\newcommand{\dx}{\dd{x}}
\newcommand{\dy}{\dd{y}}
\newcommand{\dz}{\dd{z}}
\newcommand{\dt}{\dd{t}}
\newcommand{\ds}{\dd{s}}
\newcommand{\dr}{\dd{r}}

% 一般的微分
% 如果只使用 \dd{x}\dd{y} 的话, 中间会有多余的间隔.
\newcommand{\df}{\dd}
\newcommand{\ddf}[2]{\,\mathrm{d}#1\mathrm{d}#2}	% 微分形式 differential form
\newcommand{\dddf}[3]{\,\mathrm{d}#1\mathrm{d}#2\mathrm{d}#3}

% 高阶微分
\newcommand{\dxdy}{\ddf{x}{y}}
\newcommand{\dydz}{\ddf{y}{z}}
\newcommand{\dzdx}{\ddf{z}{x}}
\newcommand{\dudv}{\ddf{u}{v}}
\newcommand{\drdt}{\ddf{r}{\theta}}
\newcommand{\dxdydz}{\dddf{x}{y}{z}}

% 矩阵的宏指令
\newcommand{\pmcmn}[3]{\begin{pmatrix}
	#1_{11} & #1_{12} & \cdots & #1_{1#3} \\
	#1_{21} & #1_{22} & \cdots & #1_{n#3} \\
	\vdots & \vdots && \vdots \\
	#1_{#2 1} & #1_{#2 2} & \cdots & #2_{n#3} \\
\end{pmatrix}}

\newcommand{\pmc}[1]{\pmcmn{#1}{n}{n}}
\newcommand{\pvcn}[2]{\begin{pmatrix}
	#1_1 \\ #1_2 \\ \vdots \\ #1_{#2}
\end{pmatrix}}

\newcommand{\pvc}[1]{\pvcn{#1}{n}}
\newcommand{\pto}{\overset{P}{\to}}

% 函数名
\renewcommand{\char}{\operatorname{char}}	% 由于已存在此命令, 不可使用 DeclareMathOperator
\renewcommand{\r}{\operatorname{r}}
\DeclareMathOperator{\st}{s.t.\,}	% 虽然不是函数名, 但用了这个指令就放这儿了.
\DeclareMathOperator{\diag}{diag}	% 不需要定义太多, 一个文件里用到什么定义什么,
\DeclareMathOperator{\Ker}{Ker}		% 毕竟特殊的函数名太多太多了.
\DeclareMathOperator{\Aut}{Aut}		% 便捷与效率的权衡.
\DeclareMathOperator{\Inn}{Inn}
\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\SL}{SL}
\DeclareMathOperator{\stab}{stab}
\DeclareMathOperator{\orb}{orb}
\DeclareMathOperator{\lcm}{lcm}
\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator{\Cov}{Cov}
\DeclareMathOperator{\Corr}{Corr}
\DeclareMathOperator{\rot}{rot}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\Outer}{Outer}
\DeclareMathOperator{\Even}{Even}
\DeclareMathOperator{\Scalar}{Scalar}
\DeclareMathOperator{\Vector}{Vector}
\DeclareMathOperator{\arsh}{arsh}
\DeclareMathOperator{\arch}{arch}
\DeclareMathOperator{\arth}{arth}
\renewcommand{\Re}{\operatorname{Re}}	% 自带 \Re 的效果是 \mathrm{Re}, 前后无空格, 故重写
\renewcommand{\Im}{\operatorname{Im}}

% 运算符
% 可以用 \bigcap, \bigcup, \bigoplus, \bigotimes 替代
\newcommand{\capop}{\displaystyle\mathop\cap\limits}
\newcommand{\cupop}{\displaystyle\mathop\cup\limits}
\newcommand{\oplusop}{\mathop\oplus\limits}
\newcommand{\otimesop}{\mathop\otimes\limits}
\newcommand{\bigoplusop}{\mathop\bigoplus\limits}
\newcommand{\bigotimesop}{\mathop\bigotimes\limits}

% 积分
\newcommand{\dint}{\displaystyle\int}
\newcommand{\inti}{\dint_{-\infty}^{+\infty}}
\newcommand{\intoi}{\dint_0^{+\infty}}

\newcommand{\intl}{\displaystyle\int\limits}
\newcommand{\iintl}{\displaystyle\iint\limits}
\newcommand{\iiintl}{\displaystyle\iiint\limits}

% 求和
\newcommand{\dsum}{\displaystyle\sum}
\newcommand{\csum}[1]{\dsum_{#1=1}^\infty}
\newcommand{\nsum}{\csum{n}}
\newcommand{\ksum}{\csum{k}}
\newcommand{\nosum}{\dsum_{n=0}^\infty}
\newcommand{\insum}{\dsum_{i=1}^n}
\newcommand{\knsum}{\dsum_{k=1}^n}

% 求积
\newcommand{\dprod}{\displaystyle\prod}
\newcommand{\nprod}{\dprod_{n=1}^\infty}
\newcommand{\noprod}{\dprod_{n=0}^\infty}
\newcommand{\inprod}{\dprod_{i=1}^n}

% 极限
\newcommand{\liml}{\lim\limits}
\newcommand{\ulim}{\overline\lim\limits_{n\to\infty}}
\newcommand{\dlim}{\underline\lim\limits_{n\to\infty}}
% 注意这里的 d 是 down, 而不是 displaystyle

\newcommand{\xlim}{\lim\limits_{x\to x_0}}
\newcommand{\nlim}{\lim\limits_{n\to\infty}}
\newcommand{\clim}[1]{\lim\limits_{#1\to\infty}}

% 并集
\newcommand{\incup}{\bigcup_{i=1}^n}
\newcommand{\nocup}{\bigcup_{n=1}^\infty}
\newcommand{\iocup}{\bigcup_{i=1}^\infty}

% 交集
\newcommand{\incap}{\bigcap_{i=1}^n}
\newcommand{\nocap}{\bigcap_{n=1}^\infty}
\newcommand{\iocap}{\bigcap_{i=1}^\infty}

% 差分
\newcommand{\DD}{\Delta}
\newcommand{\DV}[2]{\dfrac{\DD#1}{\DD#2}}
\newcommand{\nDV}[3]{\dfrac{\DD^{#1}#2}{\DD#3^{#1}}}

% 求导
\newcommand{\ddv}{\displaystyle\dv}
\newcommand{\dpdv}{\displaystyle\pdv}

% 缩写
\newcommand{\LRA}{\Leftrightarrow}
\newcommand{\RLA}{\Leftrightarrow}
\newcommand{\LA}{\Leftarrow}
\newcommand{\RA}{\Rightarrow}

\newcommand{\lra}{\leftrightarrow}
\newcommand{\rla}{\leftrightarrow}
\newcommand{\la}{\leftarrow}
\newcommand{\ra}{\rightarrow}

\newcommand{\QRLA}{\quad\RLA\quad}
\newcommand{\QRA}{\quad\RA\quad}
\newcommand{\LLRA}{\Longleftrightarrow}

\newcommand{\QNRA}{\quad\nRightarrow\quad}
\newcommand{\qnra}{\quad\nrightarrow\quad}

\newcommand{\wt}{\widetilde}

% 图形符号
\newcommand{\qed}{\quad\square}
\renewcommand{\parallel}{\mathrel{/\mskip-2.5mu/}}
\newcommand{\paralleleq}{\hspace{0.5em}{^{^{\parallel}}}\hspace{-1.04em}=}
\newcommand{\rt}{\matrm{Rt}\triangle}

% 分块矩阵
\newenvironment{mat}[1]{
	\begin{array}{#1}
}{
	\end{array}
}

\newenvironment{pmat}[1]{
	\left( \begin{array}{#1}
}{
	\end{array} \right)
}

\newenvironment{bmat}[1]{
	\left[ \begin{array}{#1}
}{
	\end{array} \right]
}

\newenvironment{Bmat}[1]{
	\left\{ \begin{array}{#1}
}{
	\end{array} \right\}
}

\newenvironment{vmat}[1]{
	\left\lvert \begin{array}{#1}
}{
	\end{array} \right\rvert
}

\newenvironment{Vmat}[1]{
	\left\lVert \begin{array}{#1}
}{
	\end{array} \right\rVert
}



t_1 - \dfrac{h}{2} < t_1 < t_1 + \dfrac{h}{2} < t_2 - \dfrac{h}{2} < t_2 < t_2 + \dfrac{h}{2} < \cdots < t_{n} - \dfrac{h}{2} < t_n < t_n + \dfrac{h}{2}.
$$
利用 Poisson 过程的微分性质, 得
$$
\begin{align}
h^n g(t_1, \cdots, t_n)
&= P \left\{
	t_1 - \dfrac{h}{2} < S_1 < t_1 + \dfrac{h}{2} <
\right. \\
	&\hspace{3em}
	t_2 - \dfrac{h}{2} < S_2 < t_2 + \dfrac{h}{2} < \cdots <
	\\
	&\hspace{3em} \left.
	t_{n} - \dfrac{h}{2} < S_n < t_n + \dfrac{h}{2}.
\right\} \\
&= P\Bqty{N\pqty{t_1 - \dfrac{h}{2}} = 0}
P\Bqty{N\pqty{t_1 + \dfrac{h}{2}} - N\pqty{t_1 - \dfrac{h}{2}} = 1}
\\
&\hspace{1.3em}
P\Bqty{N\pqty{t_2 - \dfrac{h}{2}} - N\pqty{t_1 + \dfrac{h}{2}} = 0} \cdots
\\
&\hspace{1.3em}
P\Bqty{N\pqty{t_n + \dfrac{h}{2}} - N\pqty{t_{n} - \dfrac{h}{2}} = 1} + 0
\\
&= (\lambda h)^n \e^{-\lambda (t_n - \frac{2n-1}{2} h)} + \omicron(h^n)
\end{align}
$$
令 $ h \to 0+ $, 于是有
$$
g(\soneto{t}{n}) = \begin{cases}
	\lambda^n \e^{-\lambda t_n}, & 0 < t_1 < t_2 < \cdots < t_n,
	\\
	0, & 其它.
\end{cases}
$$

---

**a.2**	求 $ (\soneto{X}{n}) $ 的联合概率密度.

注意到 $ X_n = S_n - S_{n-1} $, 令 $ x_n = t_n - t_{n-1} $, 则
$$
J = \pdv{(\soneto{t}{n})}{(\soneto{x}{n})} = \begin{vmatrix}
	1 & 0 & 0 & \cdots & 0 \\
	1 & 1 & 0 & \cdots & 0 \\
	1 & 1 & 1 & \cdots & 0 \\
	\vdots & \vdots & \vdots & \ddots & \vdots \\
	1 & 1 & 1 & \cdots & 1 \\
\end{vmatrix} = 1.
$$
于是 $ (\soneto{X}{n}) $ 的联合概率密度为
$$
f(\soneto{x}{n}) = \begin{cases}
	\lambda^n \e^{-\lambda(\splus{x}{n})}, & x_i \ge 0, 1 \le i \le n, \\
	0, & 其它.
\end{cases}
$$

---

**a.3**	证明 $ X_n \sim E(\lambda) $ 且相互独立.

于是可得 $X_k$ 的概率密度为
$$
f_{X_k}(x_k) = \lambda \e^{-\lambda x_k} I_\Bqty{x_k \ge 0}.
$$
即 $ X_k \sim E(\lambda) $. 又有
$$
f(\soneto{x}{n}) = \prod_{k=1}^n f_{X_k}(x_k).
$$
于是 $X_k$ 相互独立.

---

**必要性** $ \LA $	若 $ \Bqty{X_k, k \ge 1} $ 独立同指数分布, 如下定义计数过程
$$
\begin{align}
% S_n &= \begin{cases}
% 	0, & n = 0, \\
% 	\knsum X_k, & n > 1.
% \end{cases}
S_n &= I_{\Bqty{n > 0}} \knsum X_k, \\
N(t) &= \sup\Bqty{n \mid S_n \le t, n \in \N}.
\end{align}
$$
则下证计数过程 $ \Bqty{N(t), t \ge 0} $ 是 Poisson 过程.

---

**b.1**	求 $ (\soneto{S}{n}) $ 的联合概率密度与 $N(t)$ 的分布.

由充分性第二步的逆过程, 由 $ \soneto{X}{n} $ 的联合概率密度
$$
f(\soneto{x}{n}) = \prod_{k = 1}^n \lambda \e^{-\lambda x_k},\quad x_k \ge 0, 1 \le k \le n.
$$
可得 $ \soneto{S}{n} $ 的联合概率密度为
$$
g(\soneto{t}{n}) = \begin{cases}
	\lambda^n \e^{-\lambda t_n}, & 0 \le t_1 \le t_2 \le \cdots \le t_n, \\
	0, & 其它.
\end{cases}
$$
于是可得 $S_n$ 的分布为
$$
P(S_n \le t) = 1 - \e^{-\lambda t} \pqty{
	1 + \lambda t + \cdots + \dfrac{
		(\lambda t)^{n - 1}
	}{(n - 1)!}
}.
$$
从而得到
$$
\begin{align}
P\Bqty{N(t) = n} &= P\Bqty{S_n \le t < S_{n+1}}
\\
&= P\Bqty{S_n \le t} - P\Bqty{S_{n+1} \le t}
\\
&= \dfrac{(\lambda t)^n}{n!} \e^{-\lambda t} I_\Bqty{t \ge 0}.
\end{align}
$$

---

**b.2**	证明增量平稳性.

注意到 $ N(s + t) $ 和 $ N(s) $ 并不相互独立, 所以要转换为 $ S_k $ 研究.

**b.2.1**	当 $ n = 0 $ 时,
$$
\begin{align}
P\Bqty{N(s + t) - N(s) = 0}
&= \sum_{k = 0}^\infty P\Bqty{N(s + t) = N(s) = k}
\\
% &= \sum_{k = 0}^\infty \dfrac{[\lambda(s + t)]^k}{k!} \e^{-\lambda( s + t)}
% \dfrac{(\lambda s)^k}{k!} \e^{-\lambda s}
% 二者不独立, 所以不能这样去算.
% \\
&= \sum_{k=0}^\infty P\Bqty{S_k \le s < s + t < S_{k + 1}}
\\
&= P\Bqty{s + t < X_1} + \sum_{k = 1}^\infty \int_0^s
\\
&\hspace{1.3em} P\Bqty{s + t < S_k + X_{k+1} \mid S_k = u} \dd{P\Bqty{S_k \le u}}
\\
&= \e^{-\lambda (s + t)} +
\sum_{k = 1}^\infty \int_0^s \e^{-\lambda (s + t - u)} \pqty{
	\lambda \e^{-\lambda u} \dfrac{(\lambda u)^{k-1}}{(k-1)!} \dd{u}
}
\\
&= \e^{-\lambda (s + t)} + \int_0^s \e^{-\lambda (s + t - u)} \lambda \dd{u}
\\
&= \e^{-\lambda t} = P\Bqty{N(t) = 0}.
\end{align}
$$
从而增量平稳. 注意这里的 $ \dsum_{k = 1}^\infty \dd{P\Bqty{S_k \le u}} = \lambda \dd{u} $.

---

**b.2.2**	当 $ n \ge 1 $ 时,
$$
\begin{align}
P\Bqty{N(s + t) - N(s) = n}
&= \sum_{k = 0}^\infty P\Bqty{N(s) = k, N(s + t) = k + n}
\\
&= \sum_{k = 0}^\infty P\Bqty{S_k \le s < S_{k + 1} \le S_{k + n} \le s + t < S_{k + n + 1}}
\\
&= P\Bqty{s < S_1 \le S_n \le s + t < S_{n + 1}} +
\sum_{k = 1}^\infty \left. \int_0^s P \right\{
	S_k \le s < S_k + X_{k + 1},
\\
&\hspace{1.3em} \left.\left.
	S_k + \insum X_{k + i} \le s + t < S_k + \sum_{i = 1}^{n + 1} X_{k + i} \ \right|\ S_k = u
\right\} \dd{P\Bqty{S_k \le u}}.
\end{align}
$$
对于上式第一项,
$$
\begin{align}
P\Bqty{s < S_1 \le S_n \le s + t < S_{n+1}}
&= \int_s^{s + t} P\Bqty{ \left.
	\sum_{i = 2}^n X_i \le s + t -v < \sum_{i = 2}^{n + 1} X_i
	\ \right|\ X_1 = v
} \lambda \e^{-\lambda v} \dd{v}
\\
&= \int_s^{s + t} P\Bqty{
	S_{n - 1} \le s + t - v < S_n
} \lambda \e^{-\lambda v} \dd{v}
\\
&= \int_s^{s + t} \dfrac{
	[\lambda (s + t - v)]^{n - 1}
}{(n - 1)!} \e^{-\lambda (s + t - v)}
\lambda \e^{-\lambda v} \dd{v}
\\
&= \dfrac{(\lambda t)^n}{n!} \e^{-\lambda (s + t)}.
\end{align}
$$
第二项是类似的, 于是有
$$
\begin{align}
P\Bqty{N(s + t) - N(s) = n}
&= \dfrac{(\lambda t)^n}{n!} \e^{-\lambda (s + t)} +
\int_0^s \dfrac{(\lambda t)^n}{n!} \e^{-\lambda (s + t - u)}
\lambda \dd{u}
\\
&= \dfrac{(\lambda t)^n}{n!} \e^{-\lambda (s + t)} +
\dfrac{(\lambda t)^n}{n!} \e^{-\lambda (s + t)} (\e^{\lambda s} - 1)
\\
&= \dfrac{(\lambda t)^n}{n!} \e^{-\lambda t}
= P\Bqty{N(t) = n}.
\end{align}
$$

---

**b.3**	证明增量独立性.

这里仅证 $ \forall s, t > 0: N(s) $ 与 $ N(s + t) - N(s) $ 独立, 其它情况是类似的.

仅证 $ m \ge 1 $, $ n \ge 1 $ 时的独立性, 其它情况是类似的.

由增量平稳性以及 b.2.2 的第二式,
$$
\begin{align}
&\hspace{1.3em}
P\Bqty{N(s) = m, N(s + t) - N(s) = n}
\\
&= P\Bqty{
	S_m \le s < S_{m + 1} \le S_{m + n} \le s + t < S_{m + n + 1}
} \\
&= \int_0^s P\Bqty{ \left.
	s - u < X_{m + 1} \le
	\insum X_{m + i} \le s + t - u \le
	\sum_{i = 1}^{n + 1}
	\ \right|\ S_m = u
} \dd{P\Bqty{S_m \le u}}.
\\
&= \int_0^s P\Bqty{
	s - u \le S_1 \le S_n \le s - u + t < S_{n + 1}
} \dd{P\Bqty{S_m \le u}}
\\
&= \int_0^s \dfrac{(\lambda t)^n}{n!} \e^{-\lambda (s - u + t)}
\pqty{
	\lambda \e^{-\lambda u} \dfrac{(\lambda u)^{k-1}}{(k-1)!} \dd{u}
} \\
&= \dfrac{(\lambda t)^n}{n!} \cdot
\dfrac{(\lambda s)^m}{m!} \cdot \e^{-\lambda (s + t)}
\\
&= P\Bqty{N(s) = m} P\Bqty{N(s + t) - N(s) = n}.
\end{align}
$$
从而得证.